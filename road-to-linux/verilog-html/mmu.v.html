<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head>
<title>src/mmu.v</title>
<link rel="Stylesheet" title="v2html stylesheet" media="Screen" href="v2html.css">
</head>
<script language="JavaScript" type="text/javascript"><!--
var agt=navigator.userAgent.toLowerCase(); 
var is_nav  = ((agt.indexOf('mozilla')!=-1) &&
(agt.indexOf('spoofer')==-1) &&
(agt.indexOf('compatible') == -1) &&
(agt.indexOf('opera')==-1) &&
(agt.indexOf('webtv')==-1)); 
var is_major = parseInt(navigator.appVersion); 
var is_nav4up = (is_nav && (is_major >= 4)); 
var is_ie     = (agt.indexOf("msie") != -1); 
var is_ie4up  = (is_ie  && (is_major >= 4)); 
var is_nav5up = (is_nav && (is_major >= 5));
var dirSep = (window.location.pathname.indexOf('\\') != -1) ? '\\' : '/' ;
function setbuttons (wndw) {
var i;
var sl=wndw.loc[ wndw.document.forms[0].elements[0].selectedIndex ];
for (i=0;i<sl.length;i++) {
if(sl[i]) wndw.document.images[i].src='v2html-b1.gif';
else      wndw.document.images[i].src='v2html-b2.gif';
}
if ( wndw.document.forms[0].elements[0].options[ 
wndw.document.forms[0].elements[0].selectedIndex ].text != '-') {
wndw.document.images[i  ].src='v2html-b1.gif';
wndw.document.images[i+1].src='v2html-b1.gif';
}
else {
wndw.document.images[i  ].src='v2html-b2.gif';
wndw.document.images[i+1].src='v2html-b2.gif';
}
}
// Unindented and uncommented to save spave - look in v2html for a prettier version
var disabled=1;
if (!is_nav4up) {
var event=false; 
}
var last_link=0;     
var last_class=null; 
function qs(e,t,extra_info_index) {
var inc=0,bnum=0,i,j;
if (disabled) return false;
var sig_buttons = [ "Definition" , "Local Driver" , 
"Up to Input Driver" , "Find Source" , "Index"];
if (is_nav4up || is_ie4up) {
if (((e.which==2) && (!(e.modifiers&Event.SHIFT_MASK))) ||
((e.which==1) &&  (e.modifiers&Event.CONTROL_MASK)))   inc = 1;
else if (((e.which==2) && (e.modifiers&Event.SHIFT_MASK)) ||
((e.which==1) && (e.modifiers&Event.SHIFT_MASK))) inc = -1;
if (inc == 0 && extra_info_index == 0) { 
return true;  
}
var linkText = is_nav4up ? t.text : t.innerText;
var linkY    = is_nav4up && ! is_nav5up ? t.y    : t.offsetTop;
window.status="Searching...";
if ((last_link==-1) || (document.links[last_link]!=t)) 
for (last_link=0;last_link<document.links.length;last_link++) 
if (document.links[last_link] == t)  
break;
if (inc != 0) { 
return search(linkText,linkY,last_link,inc,1);
}
else { 
window.status="";
extra_info_index--; 
if (extra_info[extra_info_index][0] != 'S') { 
return true;
}
var w = window.open('','SignalPopUp','width=200,height=235');
if (null != w.document.forms[0]) {
if ((window.location.pathname.substring(0,window.location.pathname.lastIndexOf(dirSep)))!=
(w.pn.substring(0,w.pn.lastIndexOf(dirSep)))) {
w.close();
w = window.open('','SignalPopUp','width=200,height=235');
}
}
w.focus(); 
if (null == w.document.forms[0]) { 
var Text = '<html><head></head>';
if (is_nav4up) { 
w.loc = new Array(10);
w.sel = null;
w.pn  = window.location.pathname;
}
else {     
Text += '<script>var loc = new Array(10);<\/script>\n';
Text += '<script>var sel;<\/script>\n';
Text += '<script>var pn = opener.location.pathname;<\/script>\n';
}
Text += '<body bgcolor="white">\n';
Text += '<form>';
Text += '  <select onchange="opener.setbuttons(window);">\n';
Text += '  <option>---------------------------</option>\n';
for (j=0;j<9;j++) Text += '  <option>-</option>\n';
Text += '  </select>\n';
Text += '</form>';
Text += '<table cellspacing=0 cellpadding=0>\n';
for (var i=0;i<(extra_info[extra_info_index].length-1);i++) {
Text += hbutton(sig_buttons[i], 
'opener.location=loc[sel.selectedIndex]['+i+'];',
bnum++);
}
Text += hbutton("Search Backwards", 
'opener.search(sel.options[ sel.selectedIndex ].text,' +
'0,opener.last_link,-1,0);',bnum++);
Text += hbutton("Search Forwards",
'opener.search(sel.options[ sel.selectedIndex ].text,' +
'0,opener.last_link, 1,0);',bnum++);
Text += hbutton("Close","window.close();",bnum++);
Text += '</table>\n';
Text += '</body></html>\n';
w.document.open();
w.document.write(Text);
w.document.close();
w.document.forms[0].elements[0].options[0].text  = linkText;
w.sel = w.document.forms[0].elements[0]; 
for (j=0;j<10;j++) w.loc[j] = new Array(sig_buttons.length);  
copy_into_loc0(w,extra_info_index);
}
else {
var opts = w.document.forms[0].elements[0].options;
if ( opts.length<10 ) { 
w.loc[opts.length] = new Array;
opts.length++; 
}
for (i=opts.length-2;i>=0;i--) {
opts[i+1].text=opts[i].text;
for (var j=0;j<w.loc[i].length;j++) w.loc[i+1][j] = w.loc[i][j];
}
opts[0].text  = linkText;
copy_into_loc0(w,extra_info_index);
}
return false; 
}
}
return true;
}
function hbutton (text,action,bnum) {
return '  <tr><td><a href="" '+
'onmousedown="'+
'if (images['+bnum+'].src.match(/v2html-b2.gif/)) return false; ' +
'images['+bnum+'].src=\'v2html-b3.gif\';" '+
'onmouseup="'+
'if (images['+bnum+'].src.match(/v2html-b2.gif/)) return false; ' +
'images['+bnum+'].src=\'v2html-b1.gif\';" '+
'onclick="'+
'if (images['+bnum+'].src.match(/v2html-b2.gif/)) return false; ' +
action + 
' return false;">'+
'<img border=0 src="v2html-b1.gif"></a></td>' +
'<td style="font-family:sans-serif; font-weight:bold; font-size:14px;"> '+text+'</td></tr>\n';
}
function copy_into_loc0 (w,extra_info_index) {
for (var i=1;i<extra_info[extra_info_index].length;i++) {
w.loc[0][i-1] = extra_info[extra_info_index][i];
}
w.document.forms[0].elements[0].selectedIndex=1;
w.document.forms[0].elements[0].selectedIndex=0;
setbuttons(w);
}
function search(text,y,i,inc,relative) {
var nextpage,wrappage,linkText,linkY;
window.status="Searching...";
if (last_class) document.links[i].className=last_class;
while (1) {
for (i+=inc;i<document.links.length && i>=0;i+=inc) {
linkText = is_nav4up ? document.links[i].text : document.links[i].innerText;
linkY    = is_nav4up && ! is_nav5up ? document.links[i].y    : document.links[i].offsetTop;
if ((linkText == text) && (linkY != y)) {
window.status="";
if (is_nav4up) 
if (relative) window.scrollBy(0,linkY - y);
else          window.scrollTo(0,linkY); 
else if (is_ie4up)
document.links[i].scrollIntoView(true); 
last_link=i;
last_class=document.links[i].className;
document.links[i].className='HI';
return false;
}
}
nextpage = (inc==1) ? next_page() : prev_page();
wrappage = (inc==1) ? first_page() : last_page();
if (nextpage!="" || wrappage!="") {
if (nextpage=="") { 
if (!confirm(text + " not found. Search again from "+((inc==1)?"first":"last")+" page?"))
return false;
nextpage=wrappage;
}
location=nextpage+ "?" + escape(text) + "&" + ( y - window.pageYOffset ) + "&" + inc;
return false;
}
if (confirm(text + " not found. Search again from "+((inc==1)?"start":"end")+"?")) {
if (inc==1) i=-1;
else i=document.links.length;
} else return false;
}
return true;
}
function loadqs() {
var opt=location.search, text="", s="", y=0, si=0, inc=1;
if (opt.length==0) return true;  
for (var i=1;i<opt.length;i++) { 
if (opt.charAt(i) != "&") 
s += opt.charAt(i);
else {
if (text=="") text=unescape(s);
else             y=s;
s="";
}
}
if (text=="") return true;
if (s == "-1") { si=document.links.length-1; inc=-1; }
window.scrollTo(0,0);
search(text,y,si,inc);
return true;
}
// -->
</script>
<body onload='loadqs();'>
<script language="JavaScript"type="text/javascript"><!--
function prev_page() { return ""; }
function last_page() { return "mmu.v.p2.html"; }
// -->
</script>
<center><table class=NB cols=7 ><tr><td align="center" width="14%" onmousedown="this.style.border='inset';" onmouseup="this.style.border='outset';"  onclick="location='hierarchy.html';"><a target="_top" href="hierarchy.html">Hierarchy</a></td><td align="center" width="14%" onmousedown="this.style.border='inset';" onmouseup="this.style.border='outset';"  onclick="location='hierarchy-f.html';"><a target="_top" href="hierarchy-f.html">Files</a></td><td align="center" width="14%" onmousedown="this.style.border='inset';" onmouseup="this.style.border='outset';"  onclick="location='hierarchy-m.html';"><a target="_top" href="hierarchy-m.html">Modules</a></td><td align="center" width="14%" onmousedown="this.style.border='inset';" onmouseup="this.style.border='outset';"  onclick="location='hierarchy-s.html';"><a target="_top" href="hierarchy-s.html">Signals</a></td><td align="center" width="14%" onmousedown="this.style.border='inset';" onmouseup="this.style.border='outset';"  onclick="location='hierarchy-t.html';"><a target="_top" href="hierarchy-t.html">Tasks</a></td><td align="center" width="14%" onmousedown="this.style.border='inset';" onmouseup="this.style.border='outset';"  onclick="location='hierarchy-fn.html';"><a target="_top" href="hierarchy-fn.html">Functions</a></td><td align="center" width="14%" onmousedown="this.style.border='inset';" onmouseup="this.style.border='outset';"  onclick="location='http://www.burbleland.com/v2html/help_7_30.html?';"><a target="_top" href="http://www.burbleland.com/v2html/help_7_30.html?">Help</a></td></tr></table></center>
<center><table class=NB cols=2 ><tr><td align="center" width="50%" onmousedown="this.style.border='inset';" onmouseup="this.style.border='outset';" ><font color="#808080">1</font></td><td align="center" width="50%" onmousedown="this.style.border='inset';" onmouseup="this.style.border='outset';"  onclick="location='mmu.v.p2.html';"><a target="_top" href="mmu.v.p2.html">2</a></td></tr></table></center>
<pre>
<span class=C>/* Modified by Laurentiu-Cristian Duca, 2021-12-20
 * - LAUR_MEM_RB memory read-back flag after BBL write
 * - SIM_MAIN flag for simulation in XSIM
 * - read_file module instantiation for interactive shell in SIM_MODE
 * - debug mc_mode code under the flag LAUR_SHOW_MC_MODE
 */</span>
<span class=C>/**************************************************************************************************/</span>
<span class=C>/**** RVSoC (Mini Kuroda/RISC-V)                       since 2018-08-07   ArchLab. TokyoTech   ****/</span>
<span class=C>/**** Memory Controller v0.01                                                                  ****/</span>
<span class=C>/**************************************************************************************************/</span>
<span class=M>`default_nettype</span> none
<span class=C>/**************************************************************************************************/</span>
<span class=M>`include</span> <a  onClick="return qs(event,this,0)"  class=S href="define.vh.html">&quot;define.vh&quot;</a>

<span class=C>/**************************************************************************************************/</span>
<a name="m_mmu"></a><a  href="main.v.html#m_main_c"><img alt="[Up: m_main c]" align=bottom border=0 src="v2html-up.gif"></a><a  href="top.v.html#m_topsim_mmu"><img alt="[Up: m_topsim mmu]" align=bottom border=0 src="v2html-up.gif"></a>
<span class=K>module</span> <span class=MM>m_mmu</span><a  href="hierarchy-m.html#m_mmu"><img align=top border=0 alt="Index" src="v2html-i.gif"></a>(
<a name="17"></a>    <span class=K>input</span>  <span class=K>wire</span>         <a  onClick="return qs(event,this,1)"  class=SI href="main.v.html#315">CLK</a>, <a  onClick="return qs(event,this,2)"  class=SI href="main.v.html#316">RST_X</a>,
<a name="18"></a>    <span class=K>input</span>  <span class=K>wire</span> [31:0]  <a  onClick="return qs(event,this,3)"  class=SI href="main.v.html#317">w_insn_addr</a>, <a  onClick="return qs(event,this,4)"  class=SI href="main.v.html#318">w_data_addr</a>,
<a name="19"></a>    <span class=K>input</span>  <span class=K>wire</span> [31:0]  <a  onClick="return qs(event,this,5)"  class=SI href="main.v.html#319">w_data_wdata</a>,
<a name="20"></a>    <span class=K>input</span>  <span class=K>wire</span>         <a  onClick="return qs(event,this,6)"  class=SI href="main.v.html#320">w_data_we</a>,
<a name="21"></a>    <span class=K>input</span>  <span class=K>wire</span>  [2:0]  <a  onClick="return qs(event,this,7)"  class=SI href="main.v.html#321">w_data_ctrl</a>,
<a name="22"></a>    <span class=K>output</span> <span class=K>wire</span> [31:0]  <a  onClick="return qs(event,this,8)"  class=SO href="mmu.v.html#366">w_insn_data</a>, <a  onClick="return qs(event,this,9)"  class=SO href="mmu.v.html#420">w_data_data</a>,
<a name="23"></a>    <span class=K>output</span> <span class=K>reg</span>          <a  onClick="return qs(event,this,10)"  class=SOR href="mmu.v.html#86">r_finish</a>,
<a name="24"></a>    <span class=K>input</span>  <span class=K>wire</span> [31:0]  <a  onClick="return qs(event,this,11)"  class=SI href="main.v.html#325">w_priv</a>, <a  onClick="return qs(event,this,12)"  class=SI href="main.v.html#326">w_satp</a>, <a  onClick="return qs(event,this,13)"  class=SI href="main.v.html#327">w_mstatus</a>,
<a name="25"></a>    <span class=K>input</span>  <span class=K>wire</span> [63:0]  <a  onClick="return qs(event,this,14)"  class=SI href="main.v.html#328">w_mtime</a>, <a  onClick="return qs(event,this,15)"  class=SI href="main.v.html#329">w_mtimecmp</a>,
<a name="26"></a>    <span class=K>output</span> <span class=K>wire</span> [63:0]  <a  onClick="return qs(event,this,16)"  class=SO href="mmu.v.html#636">w_wmtimecmp</a>,
<a name="27"></a>    <span class=K>output</span> <span class=K>wire</span>         <a  onClick="return qs(event,this,17)"  class=SO href="mmu.v.html#640">w_clint_we</a>,
<a name="28"></a>    <span class=K>input</span>  <span class=K>wire</span> [31:0]  <a  onClick="return qs(event,this,18)"  class=SI href="main.v.html#332">w_mip</a>,
<a name="29"></a>    <span class=K>output</span> <span class=K>wire</span> [31:0]  <a  onClick="return qs(event,this,19)"  class=SO href="mmu.v.html#628">w_wmip</a>,
<a name="30"></a>    <span class=K>output</span> <span class=K>wire</span>         <a  onClick="return qs(event,this,20)"  class=SO href="mmu.v.html#627">w_plic_we</a>,
<a name="31"></a>    <span class=K>output</span> <span class=K>wire</span>         <a  onClick="return qs(event,this,21)"  class=SO href="mmu.v.html#657">w_proc_busy</a>,
<a name="32"></a>    <span class=K>output</span> <span class=K>wire</span> [31:0]  <a  onClick="return qs(event,this,22)"  class=SO href="mmu.v.html#215">w_pagefault</a>,
<a name="33"></a>    <span class=K>input</span>  <span class=K>wire</span>  [1:0]  <a  onClick="return qs(event,this,23)"  class=SI href="main.v.html#337">w_tlb_req</a>,
<a name="34"></a>    <span class=K>input</span>  <span class=K>wire</span>         <a  onClick="return qs(event,this,24)"  class=SI href="main.v.html#338">w_tlb_flush</a>,
<a name="35"></a>    <span class=K>output</span> <span class=K>wire</span>         <a  onClick="return qs(event,this,25)"  class=SO href="mmu.v.html#758">w_txd</a>,
<a name="36"></a>    <span class=K>input</span>  <span class=K>wire</span>         <a  onClick="return qs(event,this,26)"  class=SI href="main.v.html#340">w_rxd</a>,
<a name="37"></a>    <span class=K>output</span> <span class=K>wire</span>         <a  onClick="return qs(event,this,27)"  class=SO href="mmu.v.html#800">w_init_done</a>,
<a name="38"></a>    <span class=K>input</span>  <span class=K>wire</span>         <a  onClick="return qs(event,this,28)"  class=SI href="main.v.html#343">mig_clk</a>,
<a name="39"></a>    <span class=K>input</span>  <span class=K>wire</span>         <a  onClick="return qs(event,this,29)"  class=SI href="main.v.html#344">mig_rst_x</a>,
<span class=M>`ifndef</span> <span class=D>ARTYA7</span>
<a name="41"></a>    <span class=K>inout</span>  <span class=K>wire</span> [15:0]  <a  onClick="return qs(event,this,30)"  class=SIO href="mmu.v.html#41">ddr2_dq</a>,
<a name="42"></a>    <span class=K>inout</span>  <span class=K>wire</span>  [1:0]  <a  onClick="return qs(event,this,31)"  class=SIO href="mmu.v.html#42">ddr2_dqs_n</a>,
<a name="43"></a>    <span class=K>inout</span>  <span class=K>wire</span>  [1:0]  <a  onClick="return qs(event,this,32)"  class=SIO href="mmu.v.html#43">ddr2_dqs_p</a>,
<a name="44"></a>    <span class=K>output</span> <span class=K>wire</span> [12:0]  <a  onClick="return qs(event,this,33)"  class=SO href="mmu.v.html#977">ddr2_addr</a>,
<a name="45"></a>    <span class=K>output</span> <span class=K>wire</span>  [2:0]  <a  onClick="return qs(event,this,34)"  class=SO href="mmu.v.html#978">ddr2_ba</a>,
<a name="46"></a>    <span class=K>output</span> <span class=K>wire</span>         <a  onClick="return qs(event,this,35)"  class=SO href="mmu.v.html#979">ddr2_ras_n</a>,
<a name="47"></a>    <span class=K>output</span> <span class=K>wire</span>         <a  onClick="return qs(event,this,36)"  class=SO href="mmu.v.html#980">ddr2_cas_n</a>,
<a name="48"></a>    <span class=K>output</span> <span class=K>wire</span>         <a  onClick="return qs(event,this,37)"  class=SO href="mmu.v.html#981">ddr2_we_n</a>,
<a name="49"></a>    <span class=K>output</span> <span class=K>wire</span>         <a  onClick="return qs(event,this,38)"  class=SO href="mmu.v.html#982">ddr2_ck_p</a>,
<a name="50"></a>    <span class=K>output</span> <span class=K>wire</span>         <a  onClick="return qs(event,this,39)"  class=SO href="mmu.v.html#983">ddr2_ck_n</a>,
<a name="51"></a>    <span class=K>output</span> <span class=K>wire</span>         <a  onClick="return qs(event,this,40)"  class=SO href="mmu.v.html#984">ddr2_cke</a>,
<a name="52"></a>    <span class=K>output</span> <span class=K>wire</span>         <a  onClick="return qs(event,this,41)"  class=SO href="mmu.v.html#985">ddr2_cs_n</a>,
<a name="53"></a>    <span class=K>output</span> <span class=K>wire</span>  [1:0]  <a  onClick="return qs(event,this,42)"  class=SO href="mmu.v.html#986">ddr2_dm</a>,
<a name="54"></a>    <span class=K>output</span> <span class=K>wire</span>         <a  onClick="return qs(event,this,43)"  class=SO href="mmu.v.html#987">ddr2_odt</a>,
<span class=P>`else
</span><span class=P>    input  wire         ref_clk,
</span><span class=P>    inout  wire [15:0]  ddr3_dq,
</span><span class=P>    inout  wire  [1:0]  ddr3_dqs_n,
</span><span class=P>    inout  wire  [1:0]  ddr3_dqs_p,
</span><span class=P>    output wire [13:0]  ddr3_addr,
</span><span class=P>    output wire  [2:0]  ddr3_ba,
</span><span class=P>    output wire         ddr3_ras_n,
</span><span class=P>    output wire         ddr3_cas_n,
</span><span class=P>    output wire         ddr3_we_n,
</span><span class=P>    output wire         ddr3_ck_p,
</span><span class=P>    output wire         ddr3_ck_n,
</span><span class=P>    output wire         ddr3_reset_n,
</span><span class=P>    output wire         ddr3_cke,
</span><span class=P>    output wire         ddr3_cs_n,
</span><span class=P>    output wire  [1:0]  ddr3_dm,
</span><span class=P>    output wire         ddr3_odt,
</span><span class=M>`endif</span>
<a name="73"></a>    <span class=K>output</span> <span class=K>wire</span>         <a  onClick="return qs(event,this,44)"  class=SO href="mmu.v.p2.html#1006">o_clk</a>,
<a name="74"></a>    <span class=K>output</span> <span class=K>wire</span>         <a  onClick="return qs(event,this,45)"  class=SO href="mmu.v.p2.html#1007">o_rst_x</a>,
<a name="75"></a>    <span class=K>output</span> <span class=K>wire</span>  [7:0]  <a  onClick="return qs(event,this,46)"  class=SO href="mmu.v.html#718">w_uart_data</a>,
<a name="76"></a>    <span class=K>output</span> <span class=K>wire</span>         <a  onClick="return qs(event,this,47)"  class=SO href="mmu.v.html#719">w_uart_we</a>,
<a name="77"></a>    <span class=K>output</span> <span class=K>wire</span> [15:0]  <a  onClick="return qs(event,this,48)"  class=SO href="mmu.v.p2.html#1015">w_led</a>,
<a name="78"></a>    <span class=K>input</span>  <span class=K>wire</span>         <a  onClick="return qs(event,this,49)"  class=SI href="main.v.html#387">w_init_stage</a>,
<a name="79"></a>    <span class=K>output</span> <span class=K>wire</span> [31:0]  <a  onClick="return qs(event,this,50)"  class=SO href="mmu.v.html#750">w_checksum</a>,
<span class=M>`ifdef</span> <a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#202">LAUR_MEM_RB</a>
<a name="81"></a>    <span class=K>output</span> <span class=K>wire</span> [31:0]  <a  onClick="return qs(event,this,51)"  class=SO href="mmu.v.html#819">w_verify_checksum</a>,
<span class=M>`endif</span>
<a name="83"></a>    <span class=K>input</span>  <span class=K>wire</span>         <a  onClick="return qs(event,this,52)"  class=SI href="main.v.html#392">w_debug_btnd</a>,
<a name="84"></a>    <span class=K>output</span> <span class=K>wire</span>  [2:0]  <a  onClick="return qs(event,this,53)"  class=SO href="mmu.v.html#798">w_init_state</a>,
<a name="85"></a>    <span class=K>output</span> <span class=K>wire</span> <a  onClick="return qs(event,this,54)"  class=SO href="mmu.v.html#725">w_pl_init_we</a>);
<a name="86"></a>    <span class=K>initial</span> <a  onClick="return qs(event,this,10)"  class=SOR href="mmu.v.html#23">r_finish</a> = 0;

    <span class=C>/***** Address translation ********************************************************************/</span>
<a name="89"></a>    <span class=K>reg</span>  [31:0] <a  onClick="return qs(event,this,55)"  class=SR href="mmu.v.html#265">physical_addr</a>       = 0;
<a name="90"></a>    <span class=K>reg</span>         <a  onClick="return qs(event,this,56)"  class=SR href="mmu.v.html#266">page_walk_fail</a>      = 0;

    <span class=C>// Page walk state
</span><a name="93"></a>    <span class=K>reg</span>  [2:0]  <a  onClick="return qs(event,this,57)"  class=SR href="mmu.v.html#235">r_pw_state</a>          = 0;

    <span class=C>// Page table entry
</span><a name="96"></a>    <span class=K>reg</span>  [31:0] <a  onClick="return qs(event,this,58)"  class=SR href="mmu.v.html#251">L1_pte</a>              = 0;
<a name="97"></a>    <span class=K>reg</span>  [31:0] <a  onClick="return qs(event,this,59)"  class=SR href="mmu.v.html#259">L0_pte</a>              = 0;

    <span class=C>/***** Other Registers ************************************************************************/</span>
    <span class=C>// Device checker
</span><a name="101"></a>    <span class=K>reg</span>   [3:0] <a  onClick="return qs(event,this,60)"  class=SR href="mmu.v.html#668">r_dev</a>               = 0;
<a name="102"></a>    <span class=K>reg</span>   [3:0] <a  onClick="return qs(event,this,61)"  class=SR href="mmu.v.html#669">r_virt</a>              = 0;

    <span class=C>// TO HOST
</span><a name="105"></a>    <span class=K>reg</span>  [31:0] <a  onClick="return qs(event,this,62)"  class=SR href="mmu.v.html#689">r_tohost</a>            = 0;

    <span class=C>// PLIC
</span><a name="108"></a>    <span class=K>reg</span>  [31:0] <a  onClick="return qs(event,this,63)"  class=SR href="mmu.v.html#700">plic_served_irq</a>     = 0;
<a name="109"></a>    <span class=K>reg</span>  [31:0] <a  onClick="return qs(event,this,64)"  class=SR href="mmu.v.html#704">plic_pending_irq</a>    = 0;
<a name="110"></a>    <span class=K>reg</span>  [31:0] <a  onClick="return qs(event,this,65)"  class=SR href="mmu.v.html#699">r_plic_odata</a>        = 0;

    <span class=C>// CLINT
</span><a name="113"></a>    <span class=K>reg</span>  [31:0] <a  onClick="return qs(event,this,66)"  class=SR href="mmu.v.html#708">r_clint_odata</a>       = 0;

    <span class=C>/***** Micro Controller ***********************************************************************/</span>
<a name="116"></a>    <span class=K>reg</span>   [1:0] <a  onClick="return qs(event,this,67)"  class=SR href="mmu.v.html#445">r_mc_mode</a>           = 0;
<a name="117"></a>    <span class=K>reg</span>  [31:0] <a  onClick="return qs(event,this,68)"  class=SR href="mmu.v.html#483">r_mc_qnum</a>           = 0;
<a name="118"></a>    <span class=K>reg</span>  [31:0] <a  onClick="return qs(event,this,69)"  class=SR href="mmu.v.html#484">r_mc_qsel</a>           = 0;

<a name="120"></a>    <span class=K>reg</span>  [31:0] <a  onClick="return qs(event,this,70)"  class=SR href="mmu.v.html#446">r_mc_done</a>           = 0;

    <span class=C>/***** Keyboard Input *************************************************************************/</span>
<a name="123"></a>    <span class=K>reg</span>   [3:0] <a  onClick="return qs(event,this,71)"  class=SR href="mmu.v.html#453">r_consf_head</a>        = 0;  <span class=C>// Note!!
</span><a name="124"></a>    <span class=K>reg</span>   [3:0] <a  onClick="return qs(event,this,72)"  class=SR href="mmu.v.html#473">r_consf_tail</a>        = 0;  <span class=C>// Note!!
</span><a name="125"></a>    <span class=K>reg</span>   [4:0] <a  onClick="return qs(event,this,73)"  class=SR href="mmu.v.html#454">r_consf_cnts</a>        = 0;  <span class=C>// Note!!
</span><a name="126"></a>    <span class=K>reg</span>         <a  onClick="return qs(event,this,74)"  class=SR href="mmu.v.html#452">r_consf_en</a>          = 0;
<a name="127"></a>    <span class=K>reg</span>   [7:0] <a  onClick="return qs(event,this,75)"  class=SR href="mmu.v.html#472">cons_fifo</a> [0:15];
<span class=P>`ifdef SIM_MODE
</span><span class=P>    wire w_file_we;
</span><span class=P>    read_file rf(.clk(CLK), .r_consf_en(r_consf_en), .we(w_file_we), .w_mtime(w_mtime), .min_time(`ENABLE_TIMER + 64'd10000000));
</span><span class=M>`endif</span>

<span class=P>`ifdef SIM_MODE
</span><span class=P>`define LAUR_EN_CONSOLE_INPUT
</span><span class=P>`ifdef LAUR_EN_CONSOLE_INPUT
</span><span class=P>    initial begin
</span><span class=P>        r_consf_en = 1;
</span><span class=P>        cons_fifo[0] = 8'h72;  </span><span class=P>// &quot;r&quot;
</span><span class=P>        cons_fifo[1] = 8'h6f;  </span><span class=P>// &quot;o&quot;
</span><span class=P>        cons_fifo[2] = 8'h6f;  </span><span class=P>// &quot;o&quot;
</span><span class=P>        cons_fifo[3] = 8'h74;  </span><span class=P>// &quot;t&quot;
</span><span class=P>        cons_fifo[4] = 8'hd;   </span><span class=P>// &quot;(CR)&quot;
</span><span class=P>        cons_fifo[5] = 8'hd;   </span><span class=P>// &quot;(CR)&quot;
</span><span class=P>`ifdef laur0
</span><span class=P>        cons_fifo[6] = 8'h74;  </span><span class=P>// &quot;t&quot;
</span><span class=P>        cons_fifo[7] = 8'h6f;  </span><span class=P>// &quot;o&quot;
</span><span class=P>        cons_fifo[8] = 8'h70;  </span><span class=P>// &quot;p&quot;
</span><span class=P>        cons_fifo[9] = 8'hd;   </span><span class=P>// &quot;(CR)&quot;
</span><span class=P>        r_consf_tail = 10;
</span><span class=P>        r_consf_cnts = 10;
</span><span class=P>`else
</span><span class=P>        r_consf_tail = 6;
</span><span class=P>        r_consf_cnts = 6;
</span><span class=P>`endif
</span>	
<span class=P>    end
</span><span class=P>`endif
</span><span class=M>`endif</span>

    <span class=C>/**********************************************************************************************/</span>
    <span class=C>// dram data
</span><a name="162"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,76)"  class=SW href="mmu.v.html#963">w_dram_odata</a>;

<a name="164"></a>    <span class=K>wire</span>        <a  onClick="return qs(event,this,77)"  class=SW href="mmu.v.html#643">w_tlb_busy</a>;
<a name="165"></a>    <span class=K>wire</span>        <a  onClick="return qs(event,this,78)"  class=SW href="mmu.v.html#964">w_dram_busy</a>;

<a name="167"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,79)"  class=SW href="mmu.v.html#585">w_mc_addr</a>;
<a name="168"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,80)"  class=SW href="mmu.v.html#585">w_mc_wdata</a>;
<a name="169"></a>    <span class=K>wire</span>        <a  onClick="return qs(event,this,81)"  class=SW href="mmu.v.html#586">w_mc_we</a>;
<a name="170"></a>    <span class=K>wire</span>  [2:0] <a  onClick="return qs(event,this,82)"  class=SW href="mmu.v.html#586">w_mc_ctrl</a>;
<a name="171"></a>    <span class=K>wire</span>  [1:0] <a  onClick="return qs(event,this,83)"  class=SW href="mmu.v.html#586">w_mc_aces</a>;

<a name="173"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,84)"  class=SW href="mmu.v.html#173">w_mem_wdata</a> = (<a  onClick="return qs(event,this,67)"  class=SR href="mmu.v.html#445">r_mc_mode</a>!=0) ? <a  onClick="return qs(event,this,80)"  class=SW href="mmu.v.html#585">w_mc_wdata</a>  : <a  onClick="return qs(event,this,5)"  class=SI href="mmu.v.html#19">w_data_wdata</a>;
<a name="174"></a>    <span class=K>wire</span>        <a  onClick="return qs(event,this,85)"  class=SW href="mmu.v.html#174">w_mem_we</a>    = (<a  onClick="return qs(event,this,67)"  class=SR href="mmu.v.html#445">r_mc_mode</a>!=0) ? <a  onClick="return qs(event,this,81)"  class=SW href="mmu.v.html#586">w_mc_we</a>     : <a  onClick="return qs(event,this,6)"  class=SI href="mmu.v.html#20">w_data_we</a>;


    <span class=C>/***********************************        Page walk       ***********************************/</span>
<a name="178"></a>    <span class=K>wire</span>        <a  onClick="return qs(event,this,86)"  class=SW href="mmu.v.html#178">w_iscode</a>        = (<a  onClick="return qs(event,this,23)"  class=SI href="mmu.v.html#33">w_tlb_req</a> == <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#306">ACCESS_CODE</a>);
<a name="179"></a>    <span class=K>wire</span>        <a  onClick="return qs(event,this,87)"  class=SW href="mmu.v.html#179">w_isread</a>        = (<a  onClick="return qs(event,this,23)"  class=SI href="mmu.v.html#33">w_tlb_req</a> == <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#304">ACCESS_READ</a>);
<a name="180"></a>    <span class=K>wire</span>        <a  onClick="return qs(event,this,88)"  class=SW href="mmu.v.html#180">w_iswrite</a>       = (<a  onClick="return qs(event,this,23)"  class=SI href="mmu.v.html#33">w_tlb_req</a> == <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#305">ACCESS_WRITE</a>);
<a name="181"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,89)"  class=SW href="mmu.v.html#181">v_addr</a>          = <a  onClick="return qs(event,this,86)"  class=SW href="mmu.v.html#178">w_iscode</a> ? <a  onClick="return qs(event,this,3)"  class=SI href="mmu.v.html#18">w_insn_addr</a> : <a  onClick="return qs(event,this,4)"  class=SI href="mmu.v.html#18">w_data_addr</a>;

    <span class=C>// Level 1
</span><a name="184"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,90)"  class=SW href="mmu.v.html#184">vpn1</a>            = {22'b0, <a  onClick="return qs(event,this,89)"  class=SW href="mmu.v.html#181">v_addr</a>[31:22]};
<a name="185"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,91)"  class=SW href="mmu.v.html#185">L1_pte_addr</a>     = {<a  onClick="return qs(event,this,12)"  class=SI href="mmu.v.html#24">w_satp</a>[19:0], 12'b0} + {<a  onClick="return qs(event,this,90)"  class=SW href="mmu.v.html#184">vpn1</a>, 2'b0};
<a name="186"></a>    <span class=K>wire</span>  [2:0] <a  onClick="return qs(event,this,92)"  class=SW href="mmu.v.html#186">L1_xwr</a>          = <a  onClick="return qs(event,this,13)"  class=SI href="mmu.v.html#24">w_mstatus</a>[19] ? (<a  onClick="return qs(event,this,58)"  class=SR href="mmu.v.html#251">L1_pte</a>[3:1] | <a  onClick="return qs(event,this,58)"  class=SR href="mmu.v.html#251">L1_pte</a>[5:3]) : <a  onClick="return qs(event,this,58)"  class=SR href="mmu.v.html#251">L1_pte</a>[3:1];
<a name="187"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,93)"  class=SW href="mmu.v.html#187">L1_paddr</a>        = {<a  onClick="return qs(event,this,58)"  class=SR href="mmu.v.html#251">L1_pte</a>[29:10], 12'h0};
<a name="188"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,94)"  class=SW href="mmu.v.html#188">L1_p_addr</a>       = {<a  onClick="return qs(event,this,93)"  class=SW href="mmu.v.html#187">L1_paddr</a>[31:22], <a  onClick="return qs(event,this,89)"  class=SW href="mmu.v.html#181">v_addr</a>[21:0]};
<a name="189"></a>    <span class=K>wire</span>        <a  onClick="return qs(event,this,95)"  class=SW href="mmu.v.html#189">L1_write</a>        = !<a  onClick="return qs(event,this,58)"  class=SR href="mmu.v.html#251">L1_pte</a>[6] || (!<a  onClick="return qs(event,this,58)"  class=SR href="mmu.v.html#251">L1_pte</a>[7] &amp;&amp; <a  onClick="return qs(event,this,88)"  class=SW href="mmu.v.html#180">w_iswrite</a>);
<a name="190"></a>    <span class=K>wire</span>        <a  onClick="return qs(event,this,96)"  class=SW href="mmu.v.html#190">L1_success</a>      = !(<a  onClick="return qs(event,this,92)"  class=SW href="mmu.v.html#186">L1_xwr</a> ==2 || <a  onClick="return qs(event,this,92)"  class=SW href="mmu.v.html#186">L1_xwr</a> == 6 ||
                                    (<a  onClick="return qs(event,this,11)"  class=SI href="mmu.v.html#24">w_priv</a> == <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#400">PRIV_S</a> &amp;&amp; (<a  onClick="return qs(event,this,58)"  class=SR href="mmu.v.html#251">L1_pte</a>[4] &amp;&amp; !<a  onClick="return qs(event,this,13)"  class=SI href="mmu.v.html#24">w_mstatus</a>[18])) ||
                                    (<a  onClick="return qs(event,this,11)"  class=SI href="mmu.v.html#24">w_priv</a> == <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#399">PRIV_U</a> &amp;&amp; !<a  onClick="return qs(event,this,58)"  class=SR href="mmu.v.html#251">L1_pte</a>[4]) ||
                                    (<a  onClick="return qs(event,this,92)"  class=SW href="mmu.v.html#186">L1_xwr</a>[<a  onClick="return qs(event,this,23)"  class=SI href="mmu.v.html#33">w_tlb_req</a>] == 0));

    <span class=C>// Level 0
</span><a name="196"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,97)"  class=SW href="mmu.v.html#196">vpn0</a>            = {22'b0, <a  onClick="return qs(event,this,89)"  class=SW href="mmu.v.html#181">v_addr</a>[21:12]};
<a name="197"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,98)"  class=SW href="mmu.v.html#197">L0_pte_addr</a>     = {<a  onClick="return qs(event,this,58)"  class=SR href="mmu.v.html#251">L1_pte</a>[29:10], 12'b0} + {<a  onClick="return qs(event,this,97)"  class=SW href="mmu.v.html#196">vpn0</a>, 2'b0};
<a name="198"></a>    <span class=K>wire</span>  [2:0] <a  onClick="return qs(event,this,99)"  class=SW href="mmu.v.html#198">L0_xwr</a>          = <a  onClick="return qs(event,this,13)"  class=SI href="mmu.v.html#24">w_mstatus</a>[19] ? (<a  onClick="return qs(event,this,59)"  class=SR href="mmu.v.html#259">L0_pte</a>[3:1] | <a  onClick="return qs(event,this,59)"  class=SR href="mmu.v.html#259">L0_pte</a>[5:3]) : <a  onClick="return qs(event,this,59)"  class=SR href="mmu.v.html#259">L0_pte</a>[3:1];
<a name="199"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,100)"  class=SW href="mmu.v.html#199">L0_paddr</a>        = {<a  onClick="return qs(event,this,59)"  class=SR href="mmu.v.html#259">L0_pte</a>[29:10], 12'h0};
<a name="200"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,101)"  class=SW href="mmu.v.html#200">L0_p_addr</a>       = {<a  onClick="return qs(event,this,100)"  class=SW href="mmu.v.html#199">L0_paddr</a>[31:12], <a  onClick="return qs(event,this,89)"  class=SW href="mmu.v.html#181">v_addr</a>[11:0]};
<a name="201"></a>    <span class=K>wire</span>        <a  onClick="return qs(event,this,102)"  class=SW href="mmu.v.html#201">L0_write</a>        = !<a  onClick="return qs(event,this,59)"  class=SR href="mmu.v.html#259">L0_pte</a>[6] || (!<a  onClick="return qs(event,this,59)"  class=SR href="mmu.v.html#259">L0_pte</a>[7] &amp;&amp; <a  onClick="return qs(event,this,88)"  class=SW href="mmu.v.html#180">w_iswrite</a>);
<a name="202"></a>    <span class=K>wire</span>        <a  onClick="return qs(event,this,103)"  class=SW href="mmu.v.html#202">L0_success</a>      = !(<a  onClick="return qs(event,this,99)"  class=SW href="mmu.v.html#198">L0_xwr</a> ==2 || <a  onClick="return qs(event,this,99)"  class=SW href="mmu.v.html#198">L0_xwr</a> == 6 ||
                                    (<a  onClick="return qs(event,this,11)"  class=SI href="mmu.v.html#24">w_priv</a> == <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#400">PRIV_S</a> &amp;&amp; (<a  onClick="return qs(event,this,59)"  class=SR href="mmu.v.html#259">L0_pte</a>[4] &amp;&amp; !<a  onClick="return qs(event,this,13)"  class=SI href="mmu.v.html#24">w_mstatus</a>[18])) ||
                                    (<a  onClick="return qs(event,this,11)"  class=SI href="mmu.v.html#24">w_priv</a> == <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#399">PRIV_U</a> &amp;&amp; !<a  onClick="return qs(event,this,59)"  class=SR href="mmu.v.html#259">L0_pte</a>[4]) ||
                                    (<a  onClick="return qs(event,this,99)"  class=SW href="mmu.v.html#198">L0_xwr</a>[<a  onClick="return qs(event,this,23)"  class=SI href="mmu.v.html#33">w_tlb_req</a>] == 0));

    <span class=C>// update pte
</span><a name="208"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,104)"  class=SW href="mmu.v.html#208">L1_pte_write</a>    = <a  onClick="return qs(event,this,58)"  class=SR href="mmu.v.html#251">L1_pte</a> | <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#301">PTE_A_MASK</a> | (<a  onClick="return qs(event,this,88)"  class=SW href="mmu.v.html#180">w_iswrite</a> ? <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#302">PTE_D_MASK</a> : 0);
<a name="209"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,105)"  class=SW href="mmu.v.html#209">L0_pte_write</a>    = <a  onClick="return qs(event,this,59)"  class=SR href="mmu.v.html#259">L0_pte</a> | <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#301">PTE_A_MASK</a> | (<a  onClick="return qs(event,this,88)"  class=SW href="mmu.v.html#180">w_iswrite</a> ? <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#302">PTE_D_MASK</a> : 0);
<a name="210"></a>    <span class=K>wire</span>        <a  onClick="return qs(event,this,106)"  class=SW href="mmu.v.html#210">w_pte_we</a>        = (<a  onClick="return qs(event,this,57)"  class=SR href="mmu.v.html#235">r_pw_state</a>==5) &amp;&amp; (((<a  onClick="return qs(event,this,92)"  class=SW href="mmu.v.html#186">L1_xwr</a> != 0 &amp;&amp; <a  onClick="return qs(event,this,96)"  class=SW href="mmu.v.html#190">L1_success</a>) &amp;&amp; <a  onClick="return qs(event,this,95)"  class=SW href="mmu.v.html#189">L1_write</a>) ||
                                        ((<a  onClick="return qs(event,this,99)"  class=SW href="mmu.v.html#198">L0_xwr</a> != 0 &amp;&amp; <a  onClick="return qs(event,this,103)"  class=SW href="mmu.v.html#202">L0_success</a>) &amp;&amp; <a  onClick="return qs(event,this,102)"  class=SW href="mmu.v.html#201">L0_write</a>));
<a name="212"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,107)"  class=SW href="mmu.v.html#212">w_pte_waddr</a>     = (<a  onClick="return qs(event,this,92)"  class=SW href="mmu.v.html#186">L1_xwr</a> != 0 &amp;&amp; <a  onClick="return qs(event,this,96)"  class=SW href="mmu.v.html#190">L1_success</a>) ? <a  onClick="return qs(event,this,91)"  class=SW href="mmu.v.html#185">L1_pte_addr</a> : <a  onClick="return qs(event,this,98)"  class=SW href="mmu.v.html#197">L0_pte_addr</a>;
<a name="213"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,108)"  class=SW href="mmu.v.html#213">w_pte_wdata</a>     = (<a  onClick="return qs(event,this,92)"  class=SW href="mmu.v.html#186">L1_xwr</a> != 0 &amp;&amp; <a  onClick="return qs(event,this,96)"  class=SW href="mmu.v.html#190">L1_success</a>) ? <a  onClick="return qs(event,this,104)"  class=SW href="mmu.v.html#208">L1_pte_write</a> : <a  onClick="return qs(event,this,105)"  class=SW href="mmu.v.html#209">L0_pte_write</a>;

<a name="215"></a>    <span class=K>assign</span> <a  onClick="return qs(event,this,22)"  class=SO href="mmu.v.html#32">w_pagefault</a>          = !<a  onClick="return qs(event,this,56)"  class=SR href="mmu.v.html#266">page_walk_fail</a> ? ~32'h0 : (<a  onClick="return qs(event,this,86)"  class=SW href="mmu.v.html#178">w_iscode</a>) ? <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#330">CAUSE_FETCH_PAGE_FAULT</a> :
                                    (<a  onClick="return qs(event,this,87)"  class=SW href="mmu.v.html#179">w_isread</a>) ? <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#331">CAUSE_LOAD_PAGE_FAULT</a> : <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#332">CAUSE_STORE_PAGE_FAULT</a>;

<a name="218"></a>    <span class=K>reg</span>  [31:0] <a  onClick="return qs(event,this,109)"  class=SR href="mmu.v.html#240">r_tlb_addr</a> = 0;
<a name="219"></a>    <span class=K>reg</span>   [2:0] <a  onClick="return qs(event,this,110)"  class=SR href="mmu.v.html#245">r_tlb_use</a>  = 0;
<a name="220"></a>    <span class=K>wire</span> [21:0] <a  onClick="return qs(event,this,111)"  class=SW href="mmu.v.html#303">w_tlb_inst_r_addr</a>, <a  onClick="return qs(event,this,112)"  class=SW href="mmu.v.html#307">w_tlb_data_r_addr</a>, <a  onClick="return qs(event,this,113)"  class=SW href="mmu.v.html#311">w_tlb_data_w_addr</a>;
<a name="221"></a>    <span class=K>wire</span>        <a  onClick="return qs(event,this,114)"  class=SW href="mmu.v.html#303">w_tlb_inst_r_oe</a>, <a  onClick="return qs(event,this,115)"  class=SW href="mmu.v.html#307">w_tlb_data_r_oe</a>, <a  onClick="return qs(event,this,116)"  class=SW href="mmu.v.html#311">w_tlb_data_w_oe</a>;
<a name="222"></a>    <span class=K>wire</span>        <a  onClick="return qs(event,this,117)"  class=SW href="mmu.v.html#222">w_use_tlb</a> = (<a  onClick="return qs(event,this,67)"  class=SR href="mmu.v.html#445">r_mc_mode</a>==0 &amp;&amp; (<a  onClick="return qs(event,this,86)"  class=SW href="mmu.v.html#178">w_iscode</a> || <a  onClick="return qs(event,this,87)"  class=SW href="mmu.v.html#179">w_isread</a> || <a  onClick="return qs(event,this,88)"  class=SW href="mmu.v.html#180">w_iswrite</a>)
                                          &amp;&amp; (!(<a  onClick="return qs(event,this,11)"  class=SI href="mmu.v.html#24">w_priv</a> == <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#402">PRIV_M</a> || <a  onClick="return qs(event,this,12)"  class=SI href="mmu.v.html#24">w_satp</a>[31] == 0)));
<a name="224"></a>    <span class=K>wire</span>        <a  onClick="return qs(event,this,118)"  class=SW href="mmu.v.html#224">w_tlb_hit</a> = ((<a  onClick="return qs(event,this,86)"  class=SW href="mmu.v.html#178">w_iscode</a> &amp;&amp; <a  onClick="return qs(event,this,114)"  class=SW href="mmu.v.html#303">w_tlb_inst_r_oe</a>) ||
                            (<a  onClick="return qs(event,this,87)"  class=SW href="mmu.v.html#179">w_isread</a> &amp;&amp; <a  onClick="return qs(event,this,115)"  class=SW href="mmu.v.html#307">w_tlb_data_r_oe</a>)  ||
                            (<a  onClick="return qs(event,this,88)"  class=SW href="mmu.v.html#180">w_iswrite</a> &amp;&amp; <a  onClick="return qs(event,this,116)"  class=SW href="mmu.v.html#311">w_tlb_data_w_oe</a>));

    <span class=C>// PAGE WALK state
</span>    <span class=K>always</span>@(<span class=K>posedge</span> <a  onClick="return qs(event,this,1)"  class=SI href="mmu.v.html#17">CLK</a>) <span class=K>begin</span>
        <span class=K>if</span>(<a  onClick="return qs(event,this,57)"  class=SR href="mmu.v.html#93">r_pw_state</a> == 0) <span class=K>begin</span>
            <span class=C>// PAGE WALK START
</span>            <span class=K>if</span>(!<a  onClick="return qs(event,this,78)"  class=SW href="mmu.v.html#165">w_dram_busy</a> &amp;&amp; <a  onClick="return qs(event,this,117)"  class=SW href="mmu.v.html#222">w_use_tlb</a>) <span class=K>begin</span>
                <span class=C>// tlb miss
</span>                <span class=K>if</span>(!<a  onClick="return qs(event,this,118)"  class=SW href="mmu.v.html#224">w_tlb_hit</a>) <span class=K>begin</span>
<a name="235"></a>                    <a  onClick="return qs(event,this,57)"  class=SR href="mmu.v.html#93">r_pw_state</a> &lt;= 1;
                <span class=K>end</span>
                <span class=K>else</span> <span class=K>begin</span>
                    <a  onClick="return qs(event,this,57)"  class=SR href="mmu.v.html#93">r_pw_state</a> &lt;= 7;
                    <span class=K>case</span> ({<a  onClick="return qs(event,this,86)"  class=SW href="mmu.v.html#178">w_iscode</a>, <a  onClick="return qs(event,this,87)"  class=SW href="mmu.v.html#179">w_isread</a>, <a  onClick="return qs(event,this,88)"  class=SW href="mmu.v.html#180">w_iswrite</a>})
<a name="240"></a>                        3'b100 : <a  onClick="return qs(event,this,109)"  class=SR href="mmu.v.html#218">r_tlb_addr</a> &lt;= {<a  onClick="return qs(event,this,111)"  class=SW href="mmu.v.html#303">w_tlb_inst_r_addr</a>[21:2], <a  onClick="return qs(event,this,3)"  class=SI href="mmu.v.html#18">w_insn_addr</a>[11:0]};
                        3'b010 : <a  onClick="return qs(event,this,109)"  class=SR href="mmu.v.html#218">r_tlb_addr</a> &lt;= {<a  onClick="return qs(event,this,112)"  class=SW href="mmu.v.html#307">w_tlb_data_r_addr</a>[21:2], <a  onClick="return qs(event,this,4)"  class=SI href="mmu.v.html#18">w_data_addr</a>[11:0]};
                        3'b001 : <a  onClick="return qs(event,this,109)"  class=SR href="mmu.v.html#218">r_tlb_addr</a> &lt;= {<a  onClick="return qs(event,this,113)"  class=SW href="mmu.v.html#311">w_tlb_data_w_addr</a>[21:2], <a  onClick="return qs(event,this,4)"  class=SI href="mmu.v.html#18">w_data_addr</a>[11:0]};
                        <span class=K>default</span>: <a  onClick="return qs(event,this,109)"  class=SR href="mmu.v.html#218">r_tlb_addr</a> &lt;= 0;
                    <span class=K>endcase</span>
<a name="245"></a>                    <a  onClick="return qs(event,this,110)"  class=SR href="mmu.v.html#219">r_tlb_use</a> &lt;= {<a  onClick="return qs(event,this,86)"  class=SW href="mmu.v.html#178">w_iscode</a>, <a  onClick="return qs(event,this,87)"  class=SW href="mmu.v.html#179">w_isread</a>, <a  onClick="return qs(event,this,88)"  class=SW href="mmu.v.html#180">w_iswrite</a>};
                <span class=K>end</span>
            <span class=K>end</span>
        <span class=K>end</span>
        <span class=C>// Level 1
</span>        <span class=K>else</span> <span class=K>if</span>(<a  onClick="return qs(event,this,57)"  class=SR href="mmu.v.html#93">r_pw_state</a> == 1 &amp;&amp; !<a  onClick="return qs(event,this,78)"  class=SW href="mmu.v.html#165">w_dram_busy</a>) <span class=K>begin</span>
<a name="251"></a>            <a  onClick="return qs(event,this,58)"  class=SR href="mmu.v.html#96">L1_pte</a>      &lt;= <a  onClick="return qs(event,this,76)"  class=SW href="mmu.v.html#963">w_dram_odata</a>;
            <a  onClick="return qs(event,this,57)"  class=SR href="mmu.v.html#93">r_pw_state</a>  &lt;= 2;
        <span class=K>end</span>
        <span class=K>else</span> <span class=K>if</span>(<a  onClick="return qs(event,this,57)"  class=SR href="mmu.v.html#93">r_pw_state</a> == 2) <span class=K>begin</span>
            <a  onClick="return qs(event,this,57)"  class=SR href="mmu.v.html#93">r_pw_state</a>  &lt;= 3;
        <span class=K>end</span>
        <span class=C>// Level 0
</span>        <span class=K>else</span> <span class=K>if</span>(<a  onClick="return qs(event,this,57)"  class=SR href="mmu.v.html#93">r_pw_state</a> == 3 &amp;&amp; !<a  onClick="return qs(event,this,78)"  class=SW href="mmu.v.html#165">w_dram_busy</a>) <span class=K>begin</span>
<a name="259"></a>            <a  onClick="return qs(event,this,59)"  class=SR href="mmu.v.html#97">L0_pte</a>      &lt;= <a  onClick="return qs(event,this,76)"  class=SW href="mmu.v.html#963">w_dram_odata</a>;
            <a  onClick="return qs(event,this,57)"  class=SR href="mmu.v.html#93">r_pw_state</a>  &lt;= 4;
        <span class=K>end</span>
        <span class=C>// Success?
</span>        <span class=K>else</span> <span class=K>if</span>(<a  onClick="return qs(event,this,57)"  class=SR href="mmu.v.html#93">r_pw_state</a> == 4) <span class=K>begin</span>
            <span class=K>if</span>(!<a  onClick="return qs(event,this,58)"  class=SR href="mmu.v.html#96">L1_pte</a>[0]) <span class=K>begin</span>
<a name="265"></a>                <a  onClick="return qs(event,this,55)"  class=SR href="mmu.v.html#89">physical_addr</a>   &lt;= 0;
<a name="266"></a>                <a  onClick="return qs(event,this,56)"  class=SR href="mmu.v.html#90">page_walk_fail</a>  &lt;= 1;
            <span class=K>end</span>
            <span class=K>else</span> <span class=K>if</span>(<a  onClick="return qs(event,this,92)"  class=SW href="mmu.v.html#186">L1_xwr</a>) <span class=K>begin</span>
                <a  onClick="return qs(event,this,55)"  class=SR href="mmu.v.html#89">physical_addr</a>   &lt;= (<a  onClick="return qs(event,this,96)"  class=SW href="mmu.v.html#190">L1_success</a>) ? <a  onClick="return qs(event,this,94)"  class=SW href="mmu.v.html#188">L1_p_addr</a> : 0;
                <a  onClick="return qs(event,this,56)"  class=SR href="mmu.v.html#90">page_walk_fail</a>  &lt;= (<a  onClick="return qs(event,this,96)"  class=SW href="mmu.v.html#190">L1_success</a>) ? 0 : 1;
            <span class=K>end</span>
            <span class=K>else</span> <span class=K>if</span>(!<a  onClick="return qs(event,this,59)"  class=SR href="mmu.v.html#97">L0_pte</a>[0]) <span class=K>begin</span>
                <a  onClick="return qs(event,this,55)"  class=SR href="mmu.v.html#89">physical_addr</a>   &lt;= 0;
                <a  onClick="return qs(event,this,56)"  class=SR href="mmu.v.html#90">page_walk_fail</a>  &lt;= 1;
            <span class=K>end</span>
            <span class=K>else</span> <span class=K>if</span>(<a  onClick="return qs(event,this,99)"  class=SW href="mmu.v.html#198">L0_xwr</a>) <span class=K>begin</span>
                <a  onClick="return qs(event,this,55)"  class=SR href="mmu.v.html#89">physical_addr</a>   &lt;= (<a  onClick="return qs(event,this,103)"  class=SW href="mmu.v.html#202">L0_success</a>) ? <a  onClick="return qs(event,this,101)"  class=SW href="mmu.v.html#200">L0_p_addr</a> : 0;
                <a  onClick="return qs(event,this,56)"  class=SR href="mmu.v.html#90">page_walk_fail</a>  &lt;= (<a  onClick="return qs(event,this,103)"  class=SW href="mmu.v.html#202">L0_success</a>) ? 0 : 1;
            <span class=K>end</span>
            <a  onClick="return qs(event,this,57)"  class=SR href="mmu.v.html#93">r_pw_state</a>  &lt;= 5;
        <span class=K>end</span>
        <span class=C>// Update pte
</span>        <span class=K>else</span> <span class=K>if</span>(<a  onClick="return qs(event,this,57)"  class=SR href="mmu.v.html#93">r_pw_state</a> == 5) <span class=K>begin</span>
            <a  onClick="return qs(event,this,57)"  class=SR href="mmu.v.html#93">r_pw_state</a>      &lt;= 0;
            <a  onClick="return qs(event,this,55)"  class=SR href="mmu.v.html#89">physical_addr</a>   &lt;= 0;
            <a  onClick="return qs(event,this,56)"  class=SR href="mmu.v.html#90">page_walk_fail</a>  &lt;= 0;
        <span class=K>end</span>
        <span class=K>else</span> <span class=K>if</span>(<a  onClick="return qs(event,this,57)"  class=SR href="mmu.v.html#93">r_pw_state</a> == 7) <span class=K>begin</span>
            <a  onClick="return qs(event,this,57)"  class=SR href="mmu.v.html#93">r_pw_state</a> &lt;= 0;
            <a  onClick="return qs(event,this,110)"  class=SR href="mmu.v.html#219">r_tlb_use</a> &lt;= 0;
            <span class=C>//$write(&quot;hoge!, %x, %x\n&quot;, page_walk_fail, r_tlb_use);
</span>        <span class=K>end</span>
    <span class=K>end</span>
    
    <span class=C>/***********************************           TLB          ***********************************/</span>
<a name="296"></a>    <span class=K>wire</span>        <a  onClick="return qs(event,this,119)"  class=SW href="mmu.v.html#296">w_tlb_inst_r_we</a>   = (<a  onClick="return qs(event,this,57)"  class=SR href="mmu.v.html#235">r_pw_state</a> == 5 &amp;&amp; !<a  onClick="return qs(event,this,56)"  class=SR href="mmu.v.html#266">page_walk_fail</a> &amp;&amp; <a  onClick="return qs(event,this,86)"  class=SW href="mmu.v.html#178">w_iscode</a>);
<a name="297"></a>    <span class=K>wire</span>        <a  onClick="return qs(event,this,120)"  class=SW href="mmu.v.html#297">w_tlb_data_r_we</a>   = (<a  onClick="return qs(event,this,57)"  class=SR href="mmu.v.html#235">r_pw_state</a> == 5 &amp;&amp; !<a  onClick="return qs(event,this,56)"  class=SR href="mmu.v.html#266">page_walk_fail</a> &amp;&amp; <a  onClick="return qs(event,this,87)"  class=SW href="mmu.v.html#179">w_isread</a>);
<a name="298"></a>    <span class=K>wire</span>        <a  onClick="return qs(event,this,121)"  class=SW href="mmu.v.html#298">w_tlb_data_w_we</a>   = (<a  onClick="return qs(event,this,57)"  class=SR href="mmu.v.html#235">r_pw_state</a> == 5 &amp;&amp; !<a  onClick="return qs(event,this,56)"  class=SR href="mmu.v.html#266">page_walk_fail</a> &amp;&amp; <a  onClick="return qs(event,this,88)"  class=SW href="mmu.v.html#180">w_iswrite</a>);
<a name="299"></a>    <span class=K>wire</span> [21:0] <a  onClick="return qs(event,this,122)"  class=SW href="mmu.v.html#299">w_tlb_wdata</a>       = {<a  onClick="return qs(event,this,55)"  class=SR href="mmu.v.html#265">physical_addr</a>[31:12], 2'b0};

<a name="m_mmu_TLB_inst_r"></a><a name="301"></a>    <a  onClick="return qs(event,this,0)"  class=MM href="mmu.v.p2.html#m_tlb">m_tlb</a>#(20, 22, <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#254">TLB_SIZE</a>) TLB_inst_r (<a  onClick="return qs(event,this,1)"  class=SI href="mmu.v.html#17">CLK</a>, 1'b1, <a  onClick="return qs(event,this,24)"  class=SI href="mmu.v.html#34">w_tlb_flush</a>, <a  onClick="return qs(event,this,119)"  class=SW href="mmu.v.html#296">w_tlb_inst_r_we</a>,
<a name="302"></a>                                            <a  onClick="return qs(event,this,3)"  class=SI href="mmu.v.html#18">w_insn_addr</a>[31:12], <a  onClick="return qs(event,this,3)"  class=SI href="mmu.v.html#18">w_insn_addr</a>[31:12], <a  onClick="return qs(event,this,122)"  class=SW href="mmu.v.html#299">w_tlb_wdata</a>,
<a name="303"></a>                                            <a  onClick="return qs(event,this,111)"  class=SW href="mmu.v.html#220">w_tlb_inst_r_addr</a>, <a  onClick="return qs(event,this,114)"  class=SW href="mmu.v.html#221">w_tlb_inst_r_oe</a>);

<a name="m_mmu_TLB_data_r"></a><a name="305"></a>    <a  onClick="return qs(event,this,0)"  class=MM href="mmu.v.p2.html#m_tlb">m_tlb</a>#(20, 22, <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#254">TLB_SIZE</a>) TLB_data_r (<a  onClick="return qs(event,this,1)"  class=SI href="mmu.v.html#17">CLK</a>, 1'b1, <a  onClick="return qs(event,this,24)"  class=SI href="mmu.v.html#34">w_tlb_flush</a>, <a  onClick="return qs(event,this,120)"  class=SW href="mmu.v.html#297">w_tlb_data_r_we</a>,
<a name="306"></a>                                            <a  onClick="return qs(event,this,4)"  class=SI href="mmu.v.html#18">w_data_addr</a>[31:12], <a  onClick="return qs(event,this,4)"  class=SI href="mmu.v.html#18">w_data_addr</a>[31:12], <a  onClick="return qs(event,this,122)"  class=SW href="mmu.v.html#299">w_tlb_wdata</a>,
<a name="307"></a>                                            <a  onClick="return qs(event,this,112)"  class=SW href="mmu.v.html#220">w_tlb_data_r_addr</a>, <a  onClick="return qs(event,this,115)"  class=SW href="mmu.v.html#221">w_tlb_data_r_oe</a>);

<a name="m_mmu_TLB_data_w"></a>    <a  onClick="return qs(event,this,0)"  class=MM href="mmu.v.p2.html#m_tlb">m_tlb</a>#(20, 22, <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#254">TLB_SIZE</a>) TLB_data_w (<a  onClick="return qs(event,this,1)"  class=SI href="mmu.v.html#17">CLK</a>, 1'b1, <a  onClick="return qs(event,this,24)"  class=SI href="mmu.v.html#34">w_tlb_flush</a>, <a  onClick="return qs(event,this,121)"  class=SW href="mmu.v.html#298">w_tlb_data_w_we</a>,
                                            <a  onClick="return qs(event,this,4)"  class=SI href="mmu.v.html#18">w_data_addr</a>[31:12], <a  onClick="return qs(event,this,4)"  class=SI href="mmu.v.html#18">w_data_addr</a>[31:12], <a  onClick="return qs(event,this,122)"  class=SW href="mmu.v.html#299">w_tlb_wdata</a>,
<a name="311"></a>                                            <a  onClick="return qs(event,this,113)"  class=SW href="mmu.v.html#220">w_tlb_data_w_addr</a>, <a  onClick="return qs(event,this,116)"  class=SW href="mmu.v.html#221">w_tlb_data_w_oe</a>);

    <span class=C>/***********************************          Memory        ***********************************/</span>
<a name="314"></a>    <span class=K>reg</span>  [31:0] <a  onClick="return qs(event,this,123)"  class=SR href="mmu.v.html#318">r_tlb_pte_addr</a> = 0;
<a name="315"></a>    <span class=K>reg</span>         <a  onClick="return qs(event,this,124)"  class=SR href="mmu.v.html#318">r_tlb_acs</a> = 0;
    <span class=K>always</span>@(*)<span class=K>begin</span>
        <span class=K>case</span> (<a  onClick="return qs(event,this,57)"  class=SR href="mmu.v.html#93">r_pw_state</a>)
<a name="318"></a>            0:      <span class=K>begin</span> <a  onClick="return qs(event,this,123)"  class=SR href="mmu.v.html#314">r_tlb_pte_addr</a> &lt;= <a  onClick="return qs(event,this,91)"  class=SW href="mmu.v.html#185">L1_pte_addr</a>;    <a  onClick="return qs(event,this,124)"  class=SR href="mmu.v.html#315">r_tlb_acs</a> = 1; <span class=K>end</span>
            2:      <span class=K>begin</span> <a  onClick="return qs(event,this,123)"  class=SR href="mmu.v.html#314">r_tlb_pte_addr</a> &lt;= <a  onClick="return qs(event,this,98)"  class=SW href="mmu.v.html#197">L0_pte_addr</a>;    <a  onClick="return qs(event,this,124)"  class=SR href="mmu.v.html#315">r_tlb_acs</a> = 1; <span class=K>end</span>
            5:      <span class=K>begin</span> <a  onClick="return qs(event,this,123)"  class=SR href="mmu.v.html#314">r_tlb_pte_addr</a> &lt;= <a  onClick="return qs(event,this,107)"  class=SW href="mmu.v.html#212">w_pte_waddr</a>;    <a  onClick="return qs(event,this,124)"  class=SR href="mmu.v.html#315">r_tlb_acs</a> = 1; <span class=K>end</span>
            <span class=K>default</span>:<span class=K>begin</span> <a  onClick="return qs(event,this,123)"  class=SR href="mmu.v.html#314">r_tlb_pte_addr</a> &lt;= 0;              <a  onClick="return qs(event,this,124)"  class=SR href="mmu.v.html#315">r_tlb_acs</a> = 0; <span class=K>end</span>
        <span class=K>endcase</span>
    <span class=K>end</span>

    //<span class=K>wire</span> w_tlb_i_use = <a  onClick="return qs(event,this,114)"  class=SW href="mmu.v.html#303">w_tlb_inst_r_oe</a> &amp;&amp; <a  onClick="return qs(event,this,86)"  class=SW href="mmu.v.html#178">w_iscode</a>;
    //<span class=K>wire</span> w_tlb_r_use = <a  onClick="return qs(event,this,115)"  class=SW href="mmu.v.html#307">w_tlb_data_r_oe</a> &amp;&amp; <a  onClick="return qs(event,this,87)"  class=SW href="mmu.v.html#179">w_isread</a>;
    //<span class=K>wire</span> w_tlb_w_use = <a  onClick="return qs(event,this,116)"  class=SW href="mmu.v.html#311">w_tlb_data_w_oe</a> &amp;&amp; <a  onClick="return qs(event,this,88)"  class=SW href="mmu.v.html#180">w_iswrite</a>;
    /*<span class=K>wire</span> [31:0] w_tlb_data_addr = (w_tlb_w_use) ?   {<a  onClick="return qs(event,this,113)"  class=SW href="mmu.v.html#311">w_tlb_data_w_addr</a>[21:2], <a  onClick="return qs(event,this,4)"  class=SI href="mmu.v.html#18">w_data_addr</a>[11:0]} :
                                                    {<a  onClick="return qs(event,this,112)"  class=SW href="mmu.v.html#307">w_tlb_data_r_addr</a>[21:2], <a  onClick="return qs(event,this,4)"  class=SI href="mmu.v.html#18">w_data_addr</a>[11:0]};*/


<a name="332"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,125)"  class=SW href="mmu.v.html#332">w_insn_paddr</a> =  (<a  onClick="return qs(event,this,11)"  class=SI href="mmu.v.html#24">w_priv</a> == <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#402">PRIV_M</a> || <a  onClick="return qs(event,this,12)"  class=SI href="mmu.v.html#24">w_satp</a>[31] == 0) ? <a  onClick="return qs(event,this,3)"  class=SI href="mmu.v.html#18">w_insn_addr</a> :
                                <a  onClick="return qs(event,this,109)"  class=SR href="mmu.v.html#240">r_tlb_addr</a>;

<a name="335"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,126)"  class=SW href="mmu.v.html#335">w_mem_paddr</a>  =  (<a  onClick="return qs(event,this,67)"  class=SR href="mmu.v.html#445">r_mc_mode</a> != 0)                        ? <a  onClick="return qs(event,this,79)"  class=SW href="mmu.v.html#585">w_mc_addr</a>     :
                                (<a  onClick="return qs(event,this,11)"  class=SI href="mmu.v.html#24">w_priv</a> == <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#402">PRIV_M</a> || <a  onClick="return qs(event,this,12)"  class=SI href="mmu.v.html#24">w_satp</a>[31] == 0)  ? <a  onClick="return qs(event,this,4)"  class=SI href="mmu.v.html#18">w_data_addr</a>   : <a  onClick="return qs(event,this,109)"  class=SR href="mmu.v.html#240">r_tlb_addr</a>;
//                                (<a  onClick="return qs(event,this,57)"  class=SR href="mmu.v.html#93">r_pw_state</a> == 5)                       ? <a  onClick="return qs(event,this,109)"  class=SR href="mmu.v.html#218">r_tlb_addr</a>    :
//                                (<a  onClick="return qs(event,this,124)"  class=SR href="mmu.v.html#315">r_tlb_acs</a>)                             ? <a  onClick="return qs(event,this,123)"  class=SR href="mmu.v.html#314">r_tlb_pte_addr</a>:
//                                                                          <a  onClick="return qs(event,this,4)"  class=SI href="mmu.v.html#18">w_data_addr</a>;

<a name="341"></a>    <span class=K>wire</span> [2:0]  <a  onClick="return qs(event,this,127)"  class=SW href="mmu.v.html#341">w_mem_ctrl</a>   =  (<a  onClick="return qs(event,this,67)"  class=SR href="mmu.v.html#445">r_mc_mode</a> != 0)                        ? <a  onClick="return qs(event,this,82)"  class=SW href="mmu.v.html#586">w_mc_ctrl</a>         :
                                (<a  onClick="return qs(event,this,11)"  class=SI href="mmu.v.html#24">w_priv</a> == <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#402">PRIV_M</a> || <a  onClick="return qs(event,this,12)"  class=SI href="mmu.v.html#24">w_satp</a>[31] == 0)  ? <a  onClick="return qs(event,this,7)"  class=SI href="mmu.v.html#21">w_data_ctrl</a>       :
                                (<a  onClick="return qs(event,this,110)"  class=SR href="mmu.v.html#245">r_tlb_use</a>[1:0]!=0)                     ? <a  onClick="return qs(event,this,7)"  class=SI href="mmu.v.html#21">w_data_ctrl</a>       :
                                (<a  onClick="return qs(event,this,57)"  class=SR href="mmu.v.html#235">r_pw_state</a> == 0)                       ? <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#556">FUNCT3_LW____</a>    :
                                (<a  onClick="return qs(event,this,57)"  class=SR href="mmu.v.html#235">r_pw_state</a> == 2)                       ? <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#556">FUNCT3_LW____</a>    :
                                (<a  onClick="return qs(event,this,57)"  class=SR href="mmu.v.html#235">r_pw_state</a> == 5)                       ? <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#548">FUNCT3_SW____</a>    :
                                <a  onClick="return qs(event,this,7)"  class=SI href="mmu.v.html#21">w_data_ctrl</a>;

<a name="349"></a>    <span class=K>wire</span>  [3:0] <a  onClick="return qs(event,this,128)"  class=SW href="mmu.v.html#349">w_dev</a>       = <a  onClick="return qs(event,this,126)"  class=SW href="mmu.v.html#335">w_mem_paddr</a>[31:28];// &amp; 32'hf0000000;
<a name="350"></a>    <span class=K>wire</span>  [3:0] <a  onClick="return qs(event,this,129)"  class=SW href="mmu.v.html#350">w_virt</a>      = <a  onClick="return qs(event,this,126)"  class=SW href="mmu.v.html#335">w_mem_paddr</a>[27:24];// &amp; 32'h0f000000;
<a name="351"></a>    <span class=K>wire</span> [27:0] <a  onClick="return qs(event,this,130)"  class=SW href="mmu.v.html#351">w_offset</a>    = <a  onClick="return qs(event,this,126)"  class=SW href="mmu.v.html#335">w_mem_paddr</a> &amp; 28'h7ffffff;

    //<span class=K>always</span>@(<span class=K>posedge</span> <a  onClick="return qs(event,this,1)"  class=SI href="mmu.v.html#17">CLK</a>) <a  onClick="return qs(event,this,129)"  class=SW href="mmu.v.html#350">w_virt</a> &lt;= <a  onClick="return qs(event,this,126)"  class=SW href="mmu.v.html#335">w_mem_paddr</a> &amp; 32'h0f000000;

<a name="355"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,131)"  class=SW href="mmu.v.html#355">w_dram_wdata</a>    = (<a  onClick="return qs(event,this,57)"  class=SR href="mmu.v.html#235">r_pw_state</a> == 5) ? <a  onClick="return qs(event,this,108)"  class=SW href="mmu.v.html#213">w_pte_wdata</a> : <a  onClick="return qs(event,this,84)"  class=SW href="mmu.v.html#173">w_mem_wdata</a>;
<a name="356"></a>    <span class=K>wire</span>        <a  onClick="return qs(event,this,132)"  class=SW href="mmu.v.html#356">w_dram_we</a>       = (<a  onClick="return qs(event,this,85)"  class=SW href="mmu.v.html#174">w_mem_we</a> &amp;&amp; !<a  onClick="return qs(event,this,77)"  class=SW href="mmu.v.html#643">w_tlb_busy</a>
                                    &amp;&amp; (<a  onClick="return qs(event,this,128)"  class=SW href="mmu.v.html#349">w_dev</a> == <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#238">MEM_BASE_TADDR</a> || <a  onClick="return qs(event,this,128)"  class=SW href="mmu.v.html#349">w_dev</a> == 0));

<a name="359"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,133)"  class=SW href="mmu.v.html#359">w_dram_addr</a> =   (<a  onClick="return qs(event,this,67)"  class=SR href="mmu.v.html#445">r_mc_mode</a>!=0)              ? <a  onClick="return qs(event,this,79)"  class=SW href="mmu.v.html#585">w_mc_addr</a>         :
                                (<a  onClick="return qs(event,this,86)"  class=SW href="mmu.v.html#178">w_iscode</a> &amp;&amp; !<a  onClick="return qs(event,this,77)"  class=SW href="mmu.v.html#643">w_tlb_busy</a>)   ? <a  onClick="return qs(event,this,125)"  class=SW href="mmu.v.html#332">w_insn_paddr</a>      :
                                (<a  onClick="return qs(event,this,11)"  class=SI href="mmu.v.html#24">w_priv</a> == <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#402">PRIV_M</a> || <a  onClick="return qs(event,this,12)"  class=SI href="mmu.v.html#24">w_satp</a>[31] == 0) ? <a  onClick="return qs(event,this,4)"  class=SI href="mmu.v.html#18">w_data_addr</a> :
                                (<a  onClick="return qs(event,this,124)"  class=SR href="mmu.v.html#318">r_tlb_acs</a> &amp;&amp; !<a  onClick="return qs(event,this,118)"  class=SW href="mmu.v.html#224">w_tlb_hit</a>)   ? <a  onClick="return qs(event,this,123)"  class=SR href="mmu.v.html#318">r_tlb_pte_addr</a>    : <a  onClick="return qs(event,this,126)"  class=SW href="mmu.v.html#335">w_mem_paddr</a>;

<a name="364"></a>    <span class=K>wire</span> [2:0]  <a  onClick="return qs(event,this,134)"  class=SW href="mmu.v.html#364">w_dram_ctrl</a> =   (<a  onClick="return qs(event,this,67)"  class=SR href="mmu.v.html#445">r_mc_mode</a>!=0)              ? (<a  onClick="return qs(event,this,127)"  class=SW href="mmu.v.html#341">w_mem_ctrl</a>)      :
                                (<a  onClick="return qs(event,this,86)"  class=SW href="mmu.v.html#178">w_iscode</a> &amp;&amp; !<a  onClick="return qs(event,this,77)"  class=SW href="mmu.v.html#643">w_tlb_busy</a>)   ? <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#556">FUNCT3_LW____</a>    : <a  onClick="return qs(event,this,127)"  class=SW href="mmu.v.html#341">w_mem_ctrl</a>;
<a name="366"></a>    <span class=K>assign</span>      <a  onClick="return qs(event,this,8)"  class=SO href="mmu.v.html#22">w_insn_data</a> =   <a  onClick="return qs(event,this,76)"  class=SW href="mmu.v.html#963">w_dram_odata</a>;

<a name="368"></a>    <span class=K>wire</span>        <a  onClick="return qs(event,this,135)"  class=SW href="mmu.v.html#368">w_dram_aces</a> = (<a  onClick="return qs(event,this,133)"  class=SW href="mmu.v.html#359">w_dram_addr</a>[31:28] == 8 || <a  onClick="return qs(event,this,133)"  class=SW href="mmu.v.html#359">w_dram_addr</a>[31:28] == 0 || <a  onClick="return qs(event,this,133)"  class=SW href="mmu.v.html#359">w_dram_addr</a>[31:28] == 9);

<span class=M>`ifdef</span> <a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#202">LAUR_MEM_RB</a>
    // xsim requires declaration before <span class=K>use</span>
<a name="372"></a>    <span class=K>reg</span> <a  onClick="return qs(event,this,136)"  class=SR href="mmu.v.html#824">r_set_dram_le</a>=0;
<span class=M>`endif</span>

<a name="375"></a>    <span class=K>wire</span>        <a  onClick="return qs(event,this,137)"  class=SW href="mmu.v.html#375">w_dram_le</a>   =
                    (<a  onClick="return qs(event,this,78)"  class=SW href="mmu.v.html#964">w_dram_busy</a>)  ? 0 :
<span class=M>`ifdef</span> <a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#202">LAUR_MEM_RB</a>
                    (<a  onClick="return qs(event,this,136)"  class=SR href="mmu.v.html#824">r_set_dram_le</a>) ? 1 :
<span class=M>`endif</span>
                    (!<a  onClick="return qs(event,this,135)"  class=SW href="mmu.v.html#368">w_dram_aces</a>) ? 0 :
                    (<a  onClick="return qs(event,this,67)"  class=SR href="mmu.v.html#445">r_mc_mode</a>!=0) ? (<a  onClick="return qs(event,this,83)"  class=SW href="mmu.v.html#586">w_mc_aces</a>==<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#304">ACCESS_READ</a> &amp;&amp; <a  onClick="return qs(event,this,79)"  class=SW href="mmu.v.html#585">w_mc_addr</a>[31:28] != 0) :
                    (<a  onClick="return qs(event,this,11)"  class=SI href="mmu.v.html#24">w_priv</a> == <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#402">PRIV_M</a> || <a  onClick="return qs(event,this,12)"  class=SI href="mmu.v.html#24">w_satp</a>[31] == 0) ? (<a  onClick="return qs(event,this,86)"  class=SW href="mmu.v.html#178">w_iscode</a> || <a  onClick="return qs(event,this,87)"  class=SW href="mmu.v.html#179">w_isread</a>) :
                    (<a  onClick="return qs(event,this,110)"  class=SR href="mmu.v.html#245">r_tlb_use</a>[2:1]!=0) ? 1 :
                    (<a  onClick="return qs(event,this,77)"  class=SW href="mmu.v.html#643">w_tlb_busy</a> &amp;&amp; !<a  onClick="return qs(event,this,118)"  class=SW href="mmu.v.html#224">w_tlb_hit</a> &amp;&amp; (<a  onClick="return qs(event,this,57)"  class=SR href="mmu.v.html#235">r_pw_state</a> == 0 || <a  onClick="return qs(event,this,57)"  class=SR href="mmu.v.html#235">r_pw_state</a>==2)) ? 1 : 0;


    /***********************************         Console        ***********************************/
<a name="388"></a>    <span class=K>wire</span>        <a  onClick="return qs(event,this,138)"  class=SW href="mmu.v.html#388">w_cons_we</a>   = (<a  onClick="return qs(event,this,67)"  class=SR href="mmu.v.html#445">r_mc_mode</a> != 0) ? (<a  onClick="return qs(event,this,85)"  class=SW href="mmu.v.html#174">w_mem_we</a> &amp;&amp; <a  onClick="return qs(event,this,126)"  class=SW href="mmu.v.html#335">w_mem_paddr</a>[31:12] == 20'h4000a) :
                            (<a  onClick="return qs(event,this,85)"  class=SW href="mmu.v.html#174">w_mem_we</a> &amp;&amp; !<a  onClick="return qs(event,this,77)"  class=SW href="mmu.v.html#643">w_tlb_busy</a> &amp;&amp; <a  onClick="return qs(event,this,128)"  class=SW href="mmu.v.html#349">w_dev</a> == <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#154">VIRTIO_BASE_TADDR</a> &amp;&amp; <a  onClick="return qs(event,this,129)"  class=SW href="mmu.v.html#350">w_virt</a> == 0);
<a name="390"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,139)"  class=SW href="mmu.v.html#589">w_cons_data</a>;
<a name="391"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,140)"  class=SW href="mmu.v.html#391">w_cons_addr</a> = (<a  onClick="return qs(event,this,67)"  class=SR href="mmu.v.html#445">r_mc_mode</a> != 0) ? <a  onClick="return qs(event,this,126)"  class=SW href="mmu.v.html#335">w_mem_paddr</a> : {4'b0, <a  onClick="return qs(event,this,130)"  class=SW href="mmu.v.html#351">w_offset</a>};
<a name="392"></a>    <span class=K>wire</span>        <a  onClick="return qs(event,this,141)"  class=SW href="mmu.v.html#590">w_cons_req</a>;
<a name="393"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,142)"  class=SW href="mmu.v.html#590">w_cons_qnum</a>;
<a name="394"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,143)"  class=SW href="mmu.v.html#590">w_cons_qsel</a>;

    /***********************************           Disk         ***********************************/
<a name="397"></a>    <span class=K>wire</span>        <a  onClick="return qs(event,this,144)"  class=SW href="mmu.v.html#397">w_disk_we</a>   = (<a  onClick="return qs(event,this,67)"  class=SR href="mmu.v.html#445">r_mc_mode</a> != 0) ? (<a  onClick="return qs(event,this,85)"  class=SW href="mmu.v.html#174">w_mem_we</a> &amp;&amp; <a  onClick="return qs(event,this,126)"  class=SW href="mmu.v.html#335">w_mem_paddr</a>[31:12] == 20'h4000b) :
                            (<a  onClick="return qs(event,this,85)"  class=SW href="mmu.v.html#174">w_mem_we</a> &amp;&amp; !<a  onClick="return qs(event,this,77)"  class=SW href="mmu.v.html#643">w_tlb_busy</a> &amp;&amp; <a  onClick="return qs(event,this,128)"  class=SW href="mmu.v.html#349">w_dev</a> == <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#154">VIRTIO_BASE_TADDR</a> &amp;&amp; <a  onClick="return qs(event,this,129)"  class=SW href="mmu.v.html#350">w_virt</a> != 0);
<a name="399"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,145)"  class=SW href="mmu.v.html#592">w_disk_data</a>;
<a name="400"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,146)"  class=SW href="mmu.v.html#400">w_disk_addr</a> = (<a  onClick="return qs(event,this,67)"  class=SR href="mmu.v.html#445">r_mc_mode</a> != 0) ? <a  onClick="return qs(event,this,126)"  class=SW href="mmu.v.html#335">w_mem_paddr</a> : {4'b0, <a  onClick="return qs(event,this,130)"  class=SW href="mmu.v.html#351">w_offset</a>};
<a name="401"></a>    <span class=K>wire</span>        <a  onClick="return qs(event,this,147)"  class=SW href="mmu.v.html#593">w_disk_req</a>;
<a name="402"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,148)"  class=SW href="mmu.v.html#593">w_disk_qnum</a>;
<a name="403"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,149)"  class=SW href="mmu.v.html#593">w_disk_qsel</a>;


    /***********************************           image        ***********************************/
//    <span class=K>wire</span>        <a  onClick="return qs(event,this,150)"  class=SW href="mmu.v.html#408">w_imag_we</a>       = <a  onClick="return qs(event,this,85)"  class=SW href="mmu.v.html#174">w_mem_we</a> &amp;&amp; <a  onClick="return qs(event,this,67)"  class=SR href="mmu.v.html#445">r_mc_mode</a> != 0 &amp;&amp; <a  onClick="return qs(event,this,133)"  class=SW href="mmu.v.html#359">w_dram_addr</a>[31:28] == 4'h9;
<a name="408"></a>    <span class=K>wire</span>        <a  onClick="return qs(event,this,150)"  class=SW href="mmu.v.html#408">w_imag_we</a>       = <a  onClick="return qs(event,this,85)"  class=SW href="mmu.v.html#174">w_mem_we</a> &amp;&amp; <a  onClick="return qs(event,this,67)"  class=SR href="mmu.v.html#445">r_mc_mode</a> != 0 &amp;&amp; <a  onClick="return qs(event,this,126)"  class=SW href="mmu.v.html#335">w_mem_paddr</a>[31:28] == 4'h9;
    
    /***********************************          OUTPUT        ***********************************/
<a name="411"></a>    <span class=K>reg</span>  [31:0] <a  onClick="return qs(event,this,151)"  class=SR href="mmu.v.html#414">r_data_data</a> = 0;
    <span class=K>always</span>@(*) <span class=K>begin</span>
        <span class=K>case</span> (<a  onClick="return qs(event,this,60)"  class=SR href="mmu.v.html#101">r_dev</a>)
<a name="414"></a>            <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#192">CLINT_BASE_TADDR</a> : <a  onClick="return qs(event,this,151)"  class=SR href="mmu.v.html#411">r_data_data</a> &lt;= <a  onClick="return qs(event,this,66)"  class=SR href="mmu.v.html#708">r_clint_odata</a>;
            <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#184">PLIC_BASE_TADDR</a>  : <a  onClick="return qs(event,this,151)"  class=SR href="mmu.v.html#411">r_data_data</a> &lt;= <a  onClick="return qs(event,this,65)"  class=SR href="mmu.v.html#699">r_plic_odata</a>;
            <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#154">VIRTIO_BASE_TADDR</a>: <a  onClick="return qs(event,this,151)"  class=SR href="mmu.v.html#411">r_data_data</a> &lt;= (<a  onClick="return qs(event,this,61)"  class=SR href="mmu.v.html#669">r_virt</a> == 0) ? <a  onClick="return qs(event,this,139)"  class=SW href="mmu.v.html#589">w_cons_data</a> : <a  onClick="return qs(event,this,145)"  class=SW href="mmu.v.html#592">w_disk_data</a>;
            <span class=K>default</span>           : <a  onClick="return qs(event,this,151)"  class=SR href="mmu.v.html#411">r_data_data</a> &lt;= <a  onClick="return qs(event,this,76)"  class=SW href="mmu.v.html#963">w_dram_odata</a>;
        <span class=K>endcase</span>
    <span class=K>end</span>
<a name="420"></a>    <span class=K>assign</span> <a  onClick="return qs(event,this,9)"  class=SO href="mmu.v.html#22">w_data_data</a> = <a  onClick="return qs(event,this,151)"  class=SR href="mmu.v.html#414">r_data_data</a>;
    <span class=C>/*assign      w_data_data =   (r_dev == `CLINT_BASE_TADDR)    ? r_clint_odata     :
                                (r_dev == `PLIC_BASE_TADDR)     ? r_plic_odata      :
                                (r_dev == `VIRTIO_BASE_TADDR)   ?
                                    ((r_virt == 0) ? w_cons_data : w_disk_data) : w_dram_odata;*/</span>

    <span class=C>/***********************************          VirtIO        ***********************************/</span>
<a name="427"></a>    <span class=K>wire</span>        <a  onClick="return qs(event,this,152)"  class=SW href="mmu.v.html#726">w_key_we</a>;
<a name="428"></a>    <span class=K>wire</span>  [7:0] <a  onClick="return qs(event,this,153)"  class=SW href="mmu.v.html#726">w_key_data</a>;
<a name="429"></a>    <span class=K>wire</span>        <a  onClick="return qs(event,this,154)"  class=SW href="mmu.v.html#429">w_key_req</a> = <a  onClick="return qs(event,this,74)"  class=SR href="mmu.v.html#452">r_consf_en</a> &amp;&amp; (<a  onClick="return qs(event,this,14)"  class=SI href="mmu.v.html#25">w_mtime</a> &gt; <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#72">ENABLE_TIMER</a> + 64'd1000000) &amp;&amp; ((<a  onClick="return qs(event,this,14)"  class=SI href="mmu.v.html#25">w_mtime</a> &amp; 64'h3ffff) == 0)
                            &amp;&amp; <a  onClick="return qs(event,this,67)"  class=SR href="mmu.v.html#445">r_mc_mode</a> == 0 &amp;&amp; <a  onClick="return qs(event,this,49)"  class=SI href="mmu.v.html#78">w_init_stage</a>;
<a name="431"></a>    <span class=K>reg</span>         <a  onClick="return qs(event,this,155)"  class=SR href="mmu.v.html#434">r_key_we</a>    = 0;
<a name="432"></a>    <span class=K>reg</span>   [7:0] <a  onClick="return qs(event,this,156)"  class=SR href="mmu.v.html#435">r_key_data</a>  = 0;
    <span class=K>always</span>@(<span class=K>posedge</span> <a  onClick="return qs(event,this,1)"  class=SI href="mmu.v.html#17">CLK</a>) <span class=K>begin</span>
<a name="434"></a>        <a  onClick="return qs(event,this,155)"  class=SR href="mmu.v.html#431">r_key_we</a>    &lt;= <a  onClick="return qs(event,this,152)"  class=SW href="mmu.v.html#726">w_key_we</a>;
<a name="435"></a>        <a  onClick="return qs(event,this,156)"  class=SR href="mmu.v.html#432">r_key_data</a>  &lt;= <a  onClick="return qs(event,this,153)"  class=SW href="mmu.v.html#726">w_key_data</a>;
    <span class=K>end</span>

<span class=P>`ifdef SIM_MODE
</span><span class=P>integer i;
</span><span class=M>`endif</span>

    <span class=K>always</span>@(<span class=K>posedge</span> <a  onClick="return qs(event,this,1)"  class=SI href="mmu.v.html#17">CLK</a>) <span class=K>begin</span>
        <span class=K>if</span>(<a  onClick="return qs(event,this,70)"  class=SR href="mmu.v.html#120">r_mc_done</a>) <span class=K>begin</span>
	    <span class=C>//$write(&quot;r_mc_done=%d\n&quot;, r_mc_done);
</span><a name="445"></a>            <a  onClick="return qs(event,this,67)"  class=SR href="mmu.v.html#116">r_mc_mode</a> &lt;= 0;
<a name="446"></a>            <a  onClick="return qs(event,this,70)"  class=SR href="mmu.v.html#120">r_mc_done</a> &lt;= 0;
            <span class=K>if</span>(<a  onClick="return qs(event,this,67)"  class=SR href="mmu.v.html#116">r_mc_mode</a>==3) <span class=K>begin</span>
<span class=C>//`ifdef SIM_MODE
</span><span class=C>//                r_consf_en &lt;= 1;
</span><span class=C>//                r_consf_head &lt;= (r_consf_head &lt; 8) ? r_consf_head + 1 : r_consf_head;
</span><span class=C>//`else
</span><a name="452"></a>                <a  onClick="return qs(event,this,74)"  class=SR href="mmu.v.html#126">r_consf_en</a> &lt;= (<a  onClick="return qs(event,this,73)"  class=SR href="mmu.v.html#454">r_consf_cnts</a>&lt;=1) ? 0 : 1;
<a name="453"></a>                <a  onClick="return qs(event,this,71)"  class=SR href="mmu.v.html#123">r_consf_head</a> &lt;= <a  onClick="return qs(event,this,71)"  class=SR href="mmu.v.html#453">r_consf_head</a> + 1;
<a name="454"></a>                <a  onClick="return qs(event,this,73)"  class=SR href="mmu.v.html#125">r_consf_cnts</a> &lt;= <a  onClick="return qs(event,this,73)"  class=SR href="mmu.v.html#454">r_consf_cnts</a> - 1;
<span class=C>//`endif
</span>            <span class=K>end</span>
        <span class=K>end</span>
<span class=P>`ifdef SIM_MODE
</span><span class=P>	else if(w_file_we) begin
</span><span class=P>		$display(</span><span class=P>&quot;\nw_file_we\n&quot;</span><span class=P>);
</span><span class=P>		if(r_consf_cnts != 0)
</span><span class=P>			$display(</span><span class=P>&quot;warning: w_file_we and r_consf_cnts = %d with r_consf_en=%d&quot;</span><span class=P>, r_consf_cnts, r_consf_en);
</span><span class=P>		for(i = 0; i &lt; rf.n; i++)
</span><span class=P>			cons_fifo[r_consf_tail+i] = rf.fifo[i];
</span><span class=P>		r_consf_tail &lt;= r_consf_tail + rf.n;
</span><span class=P>		r_consf_cnts &lt;= rf.n;
</span><span class=P>		r_consf_en &lt;= 1;
</span><span class=P>	end
</span><span class=M>`else</span>
        <span class=K>else</span> <span class=K>if</span>(<a  onClick="return qs(event,this,155)"  class=SR href="mmu.v.html#431">r_key_we</a>) <span class=K>begin</span>
            <span class=K>if</span>(<a  onClick="return qs(event,this,73)"  class=SR href="mmu.v.html#125">r_consf_cnts</a> &lt; 16) <span class=K>begin</span>
<a name="472"></a>                <a  onClick="return qs(event,this,75)"  class=SR href="mmu.v.html#127">cons_fifo</a>[<a  onClick="return qs(event,this,72)"  class=SR href="mmu.v.html#124">r_consf_tail</a>] &lt;= <a  onClick="return qs(event,this,156)"  class=SR href="mmu.v.html#435">r_key_data</a>;
<a name="473"></a>                <a  onClick="return qs(event,this,72)"  class=SR href="mmu.v.html#124">r_consf_tail</a>            &lt;= <a  onClick="return qs(event,this,72)"  class=SR href="mmu.v.html#473">r_consf_tail</a> + 1;
                <a  onClick="return qs(event,this,73)"  class=SR href="mmu.v.html#125">r_consf_cnts</a>            &lt;= <a  onClick="return qs(event,this,73)"  class=SR href="mmu.v.html#454">r_consf_cnts</a> + 1;
                <a  onClick="return qs(event,this,74)"  class=SR href="mmu.v.html#126">r_consf_en</a>              &lt;= 1;
            <span class=K>end</span>
        <span class=K>end</span>
<span class=M>`endif</span>
        <span class=K>else</span> <span class=K>begin</span>
            <span class=K>case</span> ({<a  onClick="return qs(event,this,141)"  class=SW href="mmu.v.html#392">w_cons_req</a>, <a  onClick="return qs(event,this,147)"  class=SW href="mmu.v.html#401">w_disk_req</a>, <a  onClick="return qs(event,this,154)"  class=SW href="mmu.v.html#429">w_key_req</a>})
                3'b100: <span class=K>begin</span>
                    <a  onClick="return qs(event,this,67)"  class=SR href="mmu.v.html#116">r_mc_mode</a> &lt;= 1;
<a name="483"></a>                    <a  onClick="return qs(event,this,68)"  class=SR href="mmu.v.html#117">r_mc_qnum</a> &lt;= <a  onClick="return qs(event,this,142)"  class=SW href="mmu.v.html#590">w_cons_qnum</a>;
<a name="484"></a>                    <a  onClick="return qs(event,this,69)"  class=SR href="mmu.v.html#118">r_mc_qsel</a> &lt;= <a  onClick="return qs(event,this,143)"  class=SW href="mmu.v.html#590">w_cons_qsel</a>;
                <span class=K>end</span>
                3'b010: <span class=K>begin</span>
                    <a  onClick="return qs(event,this,67)"  class=SR href="mmu.v.html#116">r_mc_mode</a> &lt;= 2;
                    <a  onClick="return qs(event,this,68)"  class=SR href="mmu.v.html#117">r_mc_qnum</a> &lt;= <a  onClick="return qs(event,this,148)"  class=SW href="mmu.v.html#593">w_disk_qnum</a>;
                    <a  onClick="return qs(event,this,69)"  class=SR href="mmu.v.html#118">r_mc_qsel</a> &lt;= <a  onClick="return qs(event,this,149)"  class=SW href="mmu.v.html#593">w_disk_qsel</a>;
                <span class=K>end</span>
                3'b001: <span class=K>begin</span>
                    <a  onClick="return qs(event,this,67)"  class=SR href="mmu.v.html#116">r_mc_mode</a> &lt;= 3;
                    <a  onClick="return qs(event,this,68)"  class=SR href="mmu.v.html#117">r_mc_qnum</a> &lt;= <a  onClick="return qs(event,this,142)"  class=SW href="mmu.v.html#590">w_cons_qnum</a>;
                    <a  onClick="return qs(event,this,69)"  class=SR href="mmu.v.html#118">r_mc_qsel</a> &lt;= 0;
                <span class=K>end</span>
            <span class=K>endcase</span>
        <span class=K>end</span>
        <span class=C>/*else if(w_cons_req) begin
            r_mc_mode &lt;= 1;
            r_mc_qnum &lt;= w_cons_qnum;
            r_mc_qsel &lt;= w_cons_qsel;
        end
        else if(w_disk_req) begin
            r_mc_mode &lt;= 2;
            r_mc_qnum &lt;= w_disk_qnum;
            r_mc_qsel &lt;= w_disk_qsel;
        end
        else if(w_key_req) begin
            r_mc_mode &lt;= 3;
            r_mc_qnum &lt;= w_cons_qnum;
            r_mc_qsel &lt;= 0;
        end*/</span>
        <span class=K>if</span>(<a  onClick="return qs(event,this,62)"  class=SR href="mmu.v.html#105">r_tohost</a>[31:16]==<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#262">CMD_POWER_OFF</a>) <span class=K>begin</span>
            <a  onClick="return qs(event,this,70)"  class=SR href="mmu.v.html#120">r_mc_done</a> &lt;= 1;
        <span class=K>end</span>

    <span class=K>end</span>

<span class=C>//`define LAUR_SHOW_MC_MODE 1
</span><span class=P>`ifdef LAUR_SHOW_MC_MODE
</span><span class=P>    reg [1:0] old_r_mc_mode=1;
</span><span class=P>    reg [31:0] old_r_tohost=31'hffff;
</span><span class=P>    reg [2:0] three=7;
</span><span class=P>    reg old_r_mc_done=0;
</span><span class=P>    always @(posedge CLK) begin
</span><span class=P>         if((old_r_mc_mode != r_mc_mode) || (three != {w_cons_req, w_disk_req, w_key_req})
</span><span class=P>		 || (r_mc_done != old_r_mc_done))
</span><span class=P>	 begin
</span><span class=P>	     $write(</span><span class=P>&quot;r_mc_mode=%x r_tohost[31:16]=%x {w_cons_req, w_disk_req, w_key_req}=%x r_mc_done=%x\n&quot;</span><span class=P>, 
</span><span class=P>		     r_mc_mode, r_tohost[31:16], {w_cons_req, w_disk_req, w_key_req}, r_mc_done);
</span><span class=P>	     old_r_mc_mode &lt;= r_mc_mode;
</span><span class=P>	     three &lt;= {w_cons_req, w_disk_req, w_key_req};
</span><span class=P>	     old_r_mc_done &lt;= r_mc_done;
</span><span class=P>	 end
</span><span class=P>    end
</span><span class=M>`endif</span>

<a name="538"></a><span class=M>`define</span> <a  onClick="return qs(event,this,0)"  class=D href="mmu.v.html#538">LAUR_WRITE_TIME</a>
<span class=M>`ifdef</span> <a  onClick="return qs(event,this,0)"  class=D href="mmu.v.html#538">LAUR_WRITE_TIME</a>
<a name="540"></a>    <span class=K>reg</span> [31:0] <a  onClick="return qs(event,this,157)"  class=SR href="mmu.v.html#543">old_w_mtime</a>=0;
    <span class=K>always</span> @(<span class=K>posedge</span> <a  onClick="return qs(event,this,1)"  class=SI href="mmu.v.html#17">CLK</a>) <span class=K>begin</span>
	    <span class=K>if</span>(<a  onClick="return qs(event,this,157)"  class=SR href="mmu.v.html#540">old_w_mtime</a> != <a  onClick="return qs(event,this,14)"  class=SI href="mmu.v.html#25">w_mtime</a>) <span class=K>begin</span>
<a name="543"></a>		<a  onClick="return qs(event,this,157)"  class=SR href="mmu.v.html#540">old_w_mtime</a> = <a  onClick="return qs(event,this,14)"  class=SI href="mmu.v.html#25">w_mtime</a>;
		<span class=K>if</span>(<a  onClick="return qs(event,this,14)"  class=SI href="mmu.v.html#25">w_mtime</a> % 32'd300000 == 32'd0) <span class=K>begin</span>
			<span class=ST>$write</span>(<span class=S>&quot;w_mtime=%d ENABLE_TIMER=%d\n&quot;</span>, <a  onClick="return qs(event,this,14)"  class=SI href="mmu.v.html#25">w_mtime</a>, <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#72">ENABLE_TIMER</a>);
			<span class=K>if</span>(<a  onClick="return qs(event,this,14)"  class=SI href="mmu.v.html#25">w_mtime</a> &gt;= 32'd150000000)
				<span class=ST>$finish</span>();
		<span class=K>end</span>
	    <span class=K>end</span>
    <span class=K>end</span>
<span class=M>`endif</span>

<a name="553"></a>    <span class=K>reg</span>  [31:0] <a  onClick="return qs(event,this,158)"  class=SR href="mmu.v.html#558">r_mc_arg</a> = 0;
    <span class=K>always</span>@(*) <span class=K>begin</span>
        <span class=K>case</span> (<a  onClick="return qs(event,this,126)"  class=SW href="mmu.v.html#335">w_mem_paddr</a>[31:12])
            20'h40009: <span class=K>begin</span>
                <span class=K>case</span> (<a  onClick="return qs(event,this,126)"  class=SW href="mmu.v.html#335">w_mem_paddr</a>[3:0])
<a name="558"></a>                    4: <a  onClick="return qs(event,this,158)"  class=SR href="mmu.v.html#553">r_mc_arg</a> &lt;= <a  onClick="return qs(event,this,68)"  class=SR href="mmu.v.html#483">r_mc_qnum</a>;
                    8: <a  onClick="return qs(event,this,158)"  class=SR href="mmu.v.html#553">r_mc_arg</a> &lt;= <a  onClick="return qs(event,this,69)"  class=SR href="mmu.v.html#484">r_mc_qsel</a>;
                    <span class=K>default</span>: <a  onClick="return qs(event,this,158)"  class=SR href="mmu.v.html#553">r_mc_arg</a> &lt;= <a  onClick="return qs(event,this,67)"  class=SR href="mmu.v.html#445">r_mc_mode</a>;
                <span class=K>endcase</span>
            <span class=K>end</span>
            20'h4000a: <a  onClick="return qs(event,this,158)"  class=SR href="mmu.v.html#553">r_mc_arg</a> &lt;= <a  onClick="return qs(event,this,139)"  class=SW href="mmu.v.html#589">w_cons_data</a>;
            20'h4000b: <a  onClick="return qs(event,this,158)"  class=SR href="mmu.v.html#553">r_mc_arg</a> &lt;= <a  onClick="return qs(event,this,145)"  class=SW href="mmu.v.html#592">w_disk_data</a>;
            20'h4000c: <a  onClick="return qs(event,this,158)"  class=SR href="mmu.v.html#553">r_mc_arg</a> &lt;= <a  onClick="return qs(event,this,75)"  class=SR href="mmu.v.html#472">cons_fifo</a>[<a  onClick="return qs(event,this,71)"  class=SR href="mmu.v.html#453">r_consf_head</a>];
            <span class=K>default</span>:   <a  onClick="return qs(event,this,158)"  class=SR href="mmu.v.html#553">r_mc_arg</a> &lt;= <a  onClick="return qs(event,this,76)"  class=SW href="mmu.v.html#963">w_dram_odata</a>;
        <span class=K>endcase</span>
    <span class=K>end</span>

<a name="570"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,159)"  class=SW href="mmu.v.html#570">w_mc_arg</a> = <a  onClick="return qs(event,this,158)"  class=SR href="mmu.v.html#558">r_mc_arg</a>;
    <span class=C>/*wire [31:0] w_mc_arg =  (w_mem_paddr == `MODE_ADDR)        ? r_mc_mode                  :
                            (w_mem_paddr == `QNUM_ADDR)        ? r_mc_qnum                  :
                            (w_mem_paddr == `QSEL_ADDR)        ? r_mc_qsel                  :
                            (w_mem_paddr[31:12] == `CONQ_ADDR) ? w_cons_data                :
                            (w_mem_paddr[31:12] == `DISQ_ADDR) ? w_disk_data                : 
                            (w_mem_paddr == `KEYQ_ADDR)        ? cons_fifo[r_consf_head]    :
                            w_dram_odata;*/</span>

<a name="579"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,160)"  class=SW href="mmu.v.html#590">w_cons_irq</a>, <a  onClick="return qs(event,this,161)"  class=SW href="mmu.v.html#593">w_disk_irq</a>;
<a name="580"></a>    <span class=K>wire</span>        <a  onClick="return qs(event,this,162)"  class=SW href="mmu.v.html#590">w_cons_irq_oe</a>, <a  onClick="return qs(event,this,163)"  class=SW href="mmu.v.html#593">w_disk_irq_oe</a>;
<a name="581"></a>    <span class=K>wire</span>        <a  onClick="return qs(event,this,164)"  class=SW href="mmu.v.html#581">w_isdisk</a>        = <a  onClick="return qs(event,this,129)"  class=SW href="mmu.v.html#350">w_virt</a> != 0;
<a name="582"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,165)"  class=SW href="mmu.v.html#582">w_virt_irq</a>      = (<a  onClick="return qs(event,this,154)"  class=SW href="mmu.v.html#429">w_key_req</a>) ? <a  onClick="return qs(event,this,160)"  class=SW href="mmu.v.html#590">w_cons_irq</a> : (<a  onClick="return qs(event,this,164)"  class=SW href="mmu.v.html#581">w_isdisk</a>) ? <a  onClick="return qs(event,this,161)"  class=SW href="mmu.v.html#593">w_disk_irq</a> : <a  onClick="return qs(event,this,160)"  class=SW href="mmu.v.html#590">w_cons_irq</a>;
<a name="583"></a>    <span class=K>wire</span>        <a  onClick="return qs(event,this,166)"  class=SW href="mmu.v.html#583">w_virt_irq_oe</a>   = <a  onClick="return qs(event,this,162)"  class=SW href="mmu.v.html#590">w_cons_irq_oe</a> | <a  onClick="return qs(event,this,163)"  class=SW href="mmu.v.html#593">w_disk_irq_oe</a> | <a  onClick="return qs(event,this,154)"  class=SW href="mmu.v.html#429">w_key_req</a>;

<a name="m_mmu_mc"></a><a name="585"></a>    <a  onClick="return qs(event,this,0)"  class=MM href="microc.v.html#m_RVuc">m_RVuc</a> mc(<a  onClick="return qs(event,this,1)"  class=SI href="mmu.v.html#17">CLK</a>, (<a  onClick="return qs(event,this,67)"  class=SR href="mmu.v.html#116">r_mc_mode</a>!=0), <a  onClick="return qs(event,this,78)"  class=SW href="mmu.v.html#165">w_dram_busy</a>, <a  onClick="return qs(event,this,79)"  class=SW href="mmu.v.html#167">w_mc_addr</a>, <a  onClick="return qs(event,this,159)"  class=SW href="mmu.v.html#570">w_mc_arg</a>, <a  onClick="return qs(event,this,80)"  class=SW href="mmu.v.html#168">w_mc_wdata</a>,
<a name="586"></a>                <a  onClick="return qs(event,this,81)"  class=SW href="mmu.v.html#169">w_mc_we</a>, <a  onClick="return qs(event,this,82)"  class=SW href="mmu.v.html#170">w_mc_ctrl</a>, <a  onClick="return qs(event,this,83)"  class=SW href="mmu.v.html#171">w_mc_aces</a>);


<a name="m_mmu_console"></a><a name="589"></a>    <a  onClick="return qs(event,this,0)"  class=MM href="console.v.html#m_console">m_console</a>   console(<a  onClick="return qs(event,this,1)"  class=SI href="mmu.v.html#17">CLK</a>, 1'b1, <a  onClick="return qs(event,this,138)"  class=SW href="mmu.v.html#388">w_cons_we</a>, <a  onClick="return qs(event,this,140)"  class=SW href="mmu.v.html#391">w_cons_addr</a>, <a  onClick="return qs(event,this,84)"  class=SW href="mmu.v.html#173">w_mem_wdata</a>, <a  onClick="return qs(event,this,64)"  class=SR href="mmu.v.html#109">plic_pending_irq</a>, <a  onClick="return qs(event,this,139)"  class=SW href="mmu.v.html#390">w_cons_data</a>,
<a name="590"></a>                        <a  onClick="return qs(event,this,160)"  class=SW href="mmu.v.html#579">w_cons_irq</a>, <a  onClick="return qs(event,this,162)"  class=SW href="mmu.v.html#580">w_cons_irq_oe</a>, <a  onClick="return qs(event,this,67)"  class=SR href="mmu.v.html#116">r_mc_mode</a>, <a  onClick="return qs(event,this,141)"  class=SW href="mmu.v.html#392">w_cons_req</a>, <a  onClick="return qs(event,this,142)"  class=SW href="mmu.v.html#393">w_cons_qnum</a>, <a  onClick="return qs(event,this,143)"  class=SW href="mmu.v.html#394">w_cons_qsel</a>, <a  onClick="return qs(event,this,154)"  class=SW href="mmu.v.html#429">w_key_req</a>);
    
<a name="m_mmu_disk"></a><a name="592"></a>    <a  onClick="return qs(event,this,0)"  class=MM href="disk.v.html#m_disk">m_disk</a>      disk(<a  onClick="return qs(event,this,1)"  class=SI href="mmu.v.html#17">CLK</a>, 1'b1, <a  onClick="return qs(event,this,144)"  class=SW href="mmu.v.html#397">w_disk_we</a>, <a  onClick="return qs(event,this,146)"  class=SW href="mmu.v.html#400">w_disk_addr</a>, <a  onClick="return qs(event,this,84)"  class=SW href="mmu.v.html#173">w_mem_wdata</a>, <a  onClick="return qs(event,this,64)"  class=SR href="mmu.v.html#109">plic_pending_irq</a>, <a  onClick="return qs(event,this,145)"  class=SW href="mmu.v.html#399">w_disk_data</a>,
<a name="593"></a>                        <a  onClick="return qs(event,this,161)"  class=SW href="mmu.v.html#579">w_disk_irq</a>, <a  onClick="return qs(event,this,163)"  class=SW href="mmu.v.html#580">w_disk_irq_oe</a>, <a  onClick="return qs(event,this,67)"  class=SR href="mmu.v.html#116">r_mc_mode</a>, <a  onClick="return qs(event,this,147)"  class=SW href="mmu.v.html#401">w_disk_req</a>, <a  onClick="return qs(event,this,148)"  class=SW href="mmu.v.html#402">w_disk_qnum</a>, <a  onClick="return qs(event,this,149)"  class=SW href="mmu.v.html#403">w_disk_qsel</a>);


    <span class=C>/***********************************           PLIC         ***********************************/</span>
<a name="597"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,167)"  class=SW href="mmu.v.html#597">w_plic_pending_irq_nxt</a>  =   <a  onClick="return qs(event,this,166)"  class=SW href="mmu.v.html#583">w_virt_irq_oe</a> ? <a  onClick="return qs(event,this,165)"  class=SW href="mmu.v.html#582">w_virt_irq</a> : <a  onClick="return qs(event,this,64)"  class=SR href="mmu.v.html#704">plic_pending_irq</a>;
<a name="598"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,168)"  class=SW href="mmu.v.html#598">w_plic_mask</a>             =   <a  onClick="return qs(event,this,167)"  class=SW href="mmu.v.html#597">w_plic_pending_irq_nxt</a> &amp; ~<a  onClick="return qs(event,this,63)"  class=SR href="mmu.v.html#700">plic_served_irq</a>;
<a name="599"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,169)"  class=SW href="mmu.v.html#599">w_plic_served_irq_nxt</a>   =   (<a  onClick="return qs(event,this,166)"  class=SW href="mmu.v.html#583">w_virt_irq_oe</a>) ? <a  onClick="return qs(event,this,63)"  class=SR href="mmu.v.html#700">plic_served_irq</a> :
                                            (<a  onClick="return qs(event,this,87)"  class=SW href="mmu.v.html#179">w_isread</a>) ? <a  onClick="return qs(event,this,63)"  class=SR href="mmu.v.html#700">plic_served_irq</a> | <a  onClick="return qs(event,this,168)"  class=SW href="mmu.v.html#598">w_plic_mask</a> :
                                            <a  onClick="return qs(event,this,63)"  class=SR href="mmu.v.html#700">plic_served_irq</a> &amp; ~(1 &lt;&lt; (<a  onClick="return qs(event,this,5)"  class=SI href="mmu.v.html#19">w_data_wdata</a>-1));

<a name="603"></a>    <span class=K>wire</span> <a  onClick="return qs(event,this,170)"  class=SW href="mmu.v.html#603">w_plic_aces</a> = (<a  onClick="return qs(event,this,128)"  class=SW href="mmu.v.html#349">w_dev</a> == <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#184">PLIC_BASE_TADDR</a> &amp;&amp; !<a  onClick="return qs(event,this,77)"  class=SW href="mmu.v.html#643">w_tlb_busy</a> &amp;&amp;
            ((<a  onClick="return qs(event,this,87)"  class=SW href="mmu.v.html#179">w_isread</a> &amp;&amp; <a  onClick="return qs(event,this,168)"  class=SW href="mmu.v.html#598">w_plic_mask</a> != 0) || (<a  onClick="return qs(event,this,88)"  class=SW href="mmu.v.html#180">w_iswrite</a> &amp;&amp; <a  onClick="return qs(event,this,130)"  class=SW href="mmu.v.html#351">w_offset</a> == <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#186">PLIC_HART_BASE</a>+4)));

<a name="606"></a>    <span class=K>reg</span>  [31:0] <a  onClick="return qs(event,this,171)"  class=SR href="mmu.v.html#606">r_wmip</a> = 0;
<a name="607"></a>    <span class=K>reg</span>         <a  onClick="return qs(event,this,172)"  class=SR href="mmu.v.html#607">r_plic_we</a> = 0;

<a name="609"></a>    <span class=K>reg</span>  [31:0] <a  onClick="return qs(event,this,173)"  class=SR href="mmu.v.html#622">r_plic_pending_irq_t</a>    = 0;
<a name="610"></a>    <span class=K>reg</span>  [31:0] <a  onClick="return qs(event,this,174)"  class=SR href="mmu.v.html#623">r_plic_served_irq_t</a>     = 0;

<a name="612"></a>    <span class=K>reg</span>         <a  onClick="return qs(event,this,175)"  class=SR href="mmu.v.html#620">r_virt_irq_oe_t</a> = 0;
<a name="613"></a>    <span class=K>reg</span>         <a  onClick="return qs(event,this,176)"  class=SR href="mmu.v.html#621">r_plic_aces_t</a>   = 0;

<a name="615"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,177)"  class=SW href="mmu.v.html#615">w_plic_mask_nxt</a> = <a  onClick="return qs(event,this,173)"  class=SR href="mmu.v.html#622">r_plic_pending_irq_t</a> &amp; ~<a  onClick="return qs(event,this,174)"  class=SR href="mmu.v.html#623">r_plic_served_irq_t</a>;

    <span class=K>always</span>@(<span class=K>posedge</span> <a  onClick="return qs(event,this,1)"  class=SI href="mmu.v.html#17">CLK</a>) <span class=K>begin</span>
        <span class=K>if</span>(!<a  onClick="return qs(event,this,77)"  class=SW href="mmu.v.html#164">w_tlb_busy</a>) <span class=K>begin</span>
            <span class=C>//r_plic_we   &lt;= (w_virt_irq_oe || w_plic_aces);
</span><a name="620"></a>            <a  onClick="return qs(event,this,175)"  class=SR href="mmu.v.html#612">r_virt_irq_oe_t</a>         &lt;= <a  onClick="return qs(event,this,166)"  class=SW href="mmu.v.html#583">w_virt_irq_oe</a>;
<a name="621"></a>            <a  onClick="return qs(event,this,176)"  class=SR href="mmu.v.html#613">r_plic_aces_t</a>           &lt;= <a  onClick="return qs(event,this,170)"  class=SW href="mmu.v.html#603">w_plic_aces</a>;
<a name="622"></a>            <a  onClick="return qs(event,this,173)"  class=SR href="mmu.v.html#609">r_plic_pending_irq_t</a>    &lt;= <a  onClick="return qs(event,this,167)"  class=SW href="mmu.v.html#597">w_plic_pending_irq_nxt</a>;
<a name="623"></a>            <a  onClick="return qs(event,this,174)"  class=SR href="mmu.v.html#610">r_plic_served_irq_t</a>     &lt;= <a  onClick="return qs(event,this,169)"  class=SW href="mmu.v.html#599">w_plic_served_irq_nxt</a>;
        <span class=K>end</span>
    <span class=K>end</span>

<a name="627"></a>    <span class=K>assign</span> <a  onClick="return qs(event,this,20)"  class=SO href="mmu.v.html#30">w_plic_we</a>    = (<a  onClick="return qs(event,this,175)"  class=SR href="mmu.v.html#620">r_virt_irq_oe_t</a> || <a  onClick="return qs(event,this,176)"  class=SR href="mmu.v.html#621">r_plic_aces_t</a>);<span class=C>//r_plic_we;
</span><a name="628"></a>    <span class=K>assign</span> <a  onClick="return qs(event,this,19)"  class=SO href="mmu.v.html#29">w_wmip</a>       = (<a  onClick="return qs(event,this,177)"  class=SW href="mmu.v.html#615">w_plic_mask_nxt</a>) ? <a  onClick="return qs(event,this,18)"  class=SI href="mmu.v.html#28">w_mip</a> | (<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#445">MIP_MEIP</a> | <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#443">MIP_SEIP</a>) :
                            <a  onClick="return qs(event,this,18)"  class=SI href="mmu.v.html#28">w_mip</a> &amp; ~(<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#445">MIP_MEIP</a> | <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#443">MIP_SEIP</a>);

<span class=C>//    assign w_plic_we = (w_virt_irq_oe || w_plic_aces);
</span><span class=C>//    assign w_wmip    = (w_plic_mask_nxt) ? w_mip | (`MIP_MEIP | `MIP_SEIP) :
</span>                        <span class=C>//w_mip &amp; ~(`MIP_MEIP | `MIP_SEIP);
</span>
    <span class=C>/***********************************          CLINT         ***********************************/</span>
<a name="636"></a>    <span class=K>assign</span> <a  onClick="return qs(event,this,16)"  class=SO href="mmu.v.html#26">w_wmtimecmp</a>  = (<a  onClick="return qs(event,this,60)"  class=SR href="mmu.v.html#668">r_dev</a> == <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#192">CLINT_BASE_TADDR</a> &amp;&amp; <a  onClick="return qs(event,this,130)"  class=SW href="mmu.v.html#351">w_offset</a>==28'h4000 &amp;&amp; <a  onClick="return qs(event,this,6)"  class=SI href="mmu.v.html#20">w_data_we</a> != 0) ?
                                {<a  onClick="return qs(event,this,15)"  class=SI href="mmu.v.html#25">w_mtimecmp</a>[63:32], <a  onClick="return qs(event,this,5)"  class=SI href="mmu.v.html#19">w_data_wdata</a>} :
                          (<a  onClick="return qs(event,this,60)"  class=SR href="mmu.v.html#668">r_dev</a> == <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#192">CLINT_BASE_TADDR</a> &amp;&amp; <a  onClick="return qs(event,this,130)"  class=SW href="mmu.v.html#351">w_offset</a>==28'h4004 &amp;&amp; <a  onClick="return qs(event,this,6)"  class=SI href="mmu.v.html#20">w_data_we</a> != 0) ?
                                {<a  onClick="return qs(event,this,5)"  class=SI href="mmu.v.html#19">w_data_wdata</a>, <a  onClick="return qs(event,this,15)"  class=SI href="mmu.v.html#25">w_mtimecmp</a>[31:0]} : 0;
<a name="640"></a>    <span class=K>assign</span> <a  onClick="return qs(event,this,17)"  class=SO href="mmu.v.html#27">w_clint_we</a>   = (<a  onClick="return qs(event,this,60)"  class=SR href="mmu.v.html#668">r_dev</a> == <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#192">CLINT_BASE_TADDR</a> &amp;&amp; <a  onClick="return qs(event,this,6)"  class=SI href="mmu.v.html#20">w_data_we</a> != 0);

    <span class=C>/***********************************           BUSY         ***********************************/</span>
<a name="643"></a>    <span class=K>assign</span> <a  onClick="return qs(event,this,77)"  class=SW href="mmu.v.html#164">w_tlb_busy</a> = 
                    !(<a  onClick="return qs(event,this,117)"  class=SW href="mmu.v.html#222">w_use_tlb</a>)                            ? 0 :
                    (<a  onClick="return qs(event,this,57)"  class=SR href="mmu.v.html#235">r_pw_state</a> == 7)                       ? 0 : 1;
<span class=C>/*                    (r_pw_state != 0)                       ? 1 :
                    ((w_iscode &amp;&amp; w_tlb_inst_r_oe) ||
                    (w_isread &amp;&amp; w_tlb_data_r_oe)  ||
                    (w_iswrite &amp;&amp; w_tlb_data_w_oe))         ? 0 : 1;*/</span>
    
    <span class=C>/*wire w_mc_busy =    (r_mc_done)                                                 ? 0 :
                        (r_mc_mode != 0 || w_cons_req || w_key_req || w_disk_req)   ? 1 : 0;*/</span>
<a name="653"></a>    <span class=K>wire</span> <a  onClick="return qs(event,this,178)"  class=SW href="mmu.v.html#653">w_mc_busy</a> =    (<a  onClick="return qs(event,this,67)"  class=SR href="mmu.v.html#445">r_mc_mode</a> != 0) ? 1 : 0;


<a name="656"></a>    <span class=K>wire</span> <a  onClick="return qs(event,this,179)"  class=SW href="mmu.v.html#716">w_tx_ready</a>;
<a name="657"></a>    <span class=K>assign</span> <a  onClick="return qs(event,this,21)"  class=SO href="mmu.v.html#31">w_proc_busy</a> = <a  onClick="return qs(event,this,77)"  class=SW href="mmu.v.html#643">w_tlb_busy</a> || <a  onClick="return qs(event,this,178)"  class=SW href="mmu.v.html#653">w_mc_busy</a> || <a  onClick="return qs(event,this,78)"  class=SW href="mmu.v.html#964">w_dram_busy</a> || !<a  onClick="return qs(event,this,179)"  class=SW href="mmu.v.html#716">w_tx_ready</a>;
    <span class=C>/**********************************************************************************************/</span>
    <span class=C>// PLIC, CLINT ACCESS
</span><a name="660"></a>    <span class=K>reg</span>         <a  onClick="return qs(event,this,180)"  class=SR href="mmu.v.html#674">r_uart_we</a> = 0;
<a name="661"></a>    <span class=K>reg</span>   [7:0] <a  onClick="return qs(event,this,181)"  class=SR href="mmu.v.html#675">r_uart_data</a> = 0;
<span class=M>`ifdef</span> <a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#202">LAUR_MEM_RB</a>
    <span class=C>// xsim requires declaration before use
</span><a name="664"></a>    <span class=K>reg</span> <a  onClick="return qs(event,this,182)"  class=SR href="mmu.v.html#880">r_rb_uart_we</a>=0;
<a name="665"></a>    <span class=K>reg</span> [7:0] <a  onClick="return qs(event,this,183)"  class=SR href="mmu.v.html#876">r_rb_uart_data</a>;
<span class=M>`endif</span>
    <span class=K>always</span>@(<span class=K>posedge</span> <a  onClick="return qs(event,this,1)"  class=SI href="mmu.v.html#17">CLK</a>) <span class=K>begin</span>
<a name="668"></a>        <a  onClick="return qs(event,this,60)"  class=SR href="mmu.v.html#101">r_dev</a>   &lt;= <a  onClick="return qs(event,this,128)"  class=SW href="mmu.v.html#349">w_dev</a>;
<a name="669"></a>        <a  onClick="return qs(event,this,61)"  class=SR href="mmu.v.html#102">r_virt</a>  &lt;= <a  onClick="return qs(event,this,129)"  class=SW href="mmu.v.html#350">w_virt</a>;

        <span class=C>/*********************************         TOHOST         *********************************/</span>
        <span class=C>// OUTPUT CHAR
</span>        <span class=K>if</span>(<a  onClick="return qs(event,this,62)"  class=SR href="mmu.v.html#105">r_tohost</a>[31:16]==<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#261">CMD_PRINT_CHAR</a>) <span class=K>begin</span>
<a name="674"></a>            <a  onClick="return qs(event,this,180)"  class=SR href="mmu.v.html#660">r_uart_we</a>   &lt;= 1;
<a name="675"></a>            <a  onClick="return qs(event,this,181)"  class=SR href="mmu.v.html#661">r_uart_data</a> &lt;= <a  onClick="return qs(event,this,62)"  class=SR href="mmu.v.html#689">r_tohost</a>[7:0];
<span class=M>`ifdef</span> <a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#202">LAUR_MEM_RB</a>
	<span class=K>end</span> <span class=K>else</span> <span class=K>if</span>(<a  onClick="return qs(event,this,182)"  class=SR href="mmu.v.html#664">r_rb_uart_we</a>) <span class=K>begin</span>
		<a  onClick="return qs(event,this,180)"  class=SR href="mmu.v.html#660">r_uart_we</a> &lt;= 1;
		<a  onClick="return qs(event,this,181)"  class=SR href="mmu.v.html#661">r_uart_data</a> &lt;= <a  onClick="return qs(event,this,183)"  class=SR href="mmu.v.html#876">r_rb_uart_data</a>;
<span class=M>`endif</span>
    	<span class=K>end</span> <span class=K>else</span> <span class=K>begin</span> 
            <a  onClick="return qs(event,this,180)"  class=SR href="mmu.v.html#660">r_uart_we</a>   &lt;= 0;
            <a  onClick="return qs(event,this,181)"  class=SR href="mmu.v.html#661">r_uart_data</a> &lt;= 0;
        <span class=K>end</span>
        <span class=C>// Finish Simulation
</span>        <span class=K>if</span>(<a  onClick="return qs(event,this,62)"  class=SR href="mmu.v.html#105">r_tohost</a>[31:16]==<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#262">CMD_POWER_OFF</a>) <span class=K>begin</span>
            <span class=K>if</span>(<a  onClick="return qs(event,this,67)"  class=SR href="mmu.v.html#116">r_mc_mode</a>==0) <a  onClick="return qs(event,this,10)"  class=SOR href="mmu.v.html#23">r_finish</a> = 1;
            <span class=K>else</span> <span class=K>begin</span>
<a name="689"></a>                <a  onClick="return qs(event,this,62)"  class=SR href="mmu.v.html#105">r_tohost</a> &lt;= 0;
            <span class=K>end</span>
        <span class=K>end</span>
        <span class=K>else</span> <span class=K>begin</span>
            <a  onClick="return qs(event,this,62)"  class=SR href="mmu.v.html#105">r_tohost</a> &lt;= (<a  onClick="return qs(event,this,126)"  class=SW href="mmu.v.html#335">w_mem_paddr</a>==<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#258">TOHOST_ADDR</a> &amp;&amp; <a  onClick="return qs(event,this,85)"  class=SW href="mmu.v.html#174">w_mem_we</a>) ? <a  onClick="return qs(event,this,84)"  class=SW href="mmu.v.html#173">w_mem_wdata</a>   :
                        (<a  onClick="return qs(event,this,62)"  class=SR href="mmu.v.html#689">r_tohost</a>[31:16]==<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#261">CMD_PRINT_CHAR</a>)      ? 0             : <a  onClick="return qs(event,this,62)"  class=SR href="mmu.v.html#689">r_tohost</a>;
        <span class=K>end</span>

        <span class=C>/**********************************         PLIC         **********************************/</span>
        <span class=K>if</span>(<a  onClick="return qs(event,this,170)"  class=SW href="mmu.v.html#603">w_plic_aces</a>) <span class=K>begin</span>
<a name="699"></a>            <a  onClick="return qs(event,this,65)"  class=SR href="mmu.v.html#110">r_plic_odata</a>    &lt;= (<a  onClick="return qs(event,this,168)"  class=SW href="mmu.v.html#598">w_plic_mask</a>!=0) ? <a  onClick="return qs(event,this,168)"  class=SW href="mmu.v.html#598">w_plic_mask</a> : 0;
<a name="700"></a>            <a  onClick="return qs(event,this,63)"  class=SR href="mmu.v.html#108">plic_served_irq</a> &lt;= <a  onClick="return qs(event,this,169)"  class=SW href="mmu.v.html#599">w_plic_served_irq_nxt</a>;
        <span class=K>end</span>

        <span class=K>if</span>(<a  onClick="return qs(event,this,166)"  class=SW href="mmu.v.html#583">w_virt_irq_oe</a>) <span class=K>begin</span>
<a name="704"></a>            <a  onClick="return qs(event,this,64)"  class=SR href="mmu.v.html#109">plic_pending_irq</a>    &lt;= <a  onClick="return qs(event,this,165)"  class=SW href="mmu.v.html#582">w_virt_irq</a>;
        <span class=K>end</span>

        <span class=C>/*********************************          CLINT         *********************************/</span>
<a name="708"></a>        <a  onClick="return qs(event,this,66)"  class=SR href="mmu.v.html#113">r_clint_odata</a> &lt;=    (<a  onClick="return qs(event,this,130)"  class=SW href="mmu.v.html#351">w_offset</a>==28'hbff8) ? <a  onClick="return qs(event,this,14)"  class=SI href="mmu.v.html#25">w_mtime</a>[31:0] :
                            (<a  onClick="return qs(event,this,130)"  class=SW href="mmu.v.html#351">w_offset</a>==28'hbffc) ? <a  onClick="return qs(event,this,14)"  class=SI href="mmu.v.html#25">w_mtime</a>[63:32] :
                            (<a  onClick="return qs(event,this,130)"  class=SW href="mmu.v.html#351">w_offset</a>==28'h4000) ? <a  onClick="return qs(event,this,15)"  class=SI href="mmu.v.html#25">w_mtimecmp</a>[31:0] :
                            (<a  onClick="return qs(event,this,130)"  class=SW href="mmu.v.html#351">w_offset</a>==28'h4004) ? <a  onClick="return qs(event,this,15)"  class=SI href="mmu.v.html#25">w_mtimecmp</a>[63:32] : 0;
    <span class=K>end</span>
    <span class=C>/**********************************************************************************************/</span>

<a name="715"></a>    <span class=K>wire</span> <a  onClick="return qs(event,this,184)"  class=SW href="mmu.v.html#716">w_cons_txd</a>;
<a name="m_mmu_UartTx0"></a><a name="716"></a>    <a  onClick="return qs(event,this,0)"  class=MM href="loader.v.html#UartTx">UartTx</a> UartTx0(<a  onClick="return qs(event,this,1)"  class=SI href="mmu.v.html#17">CLK</a>, <a  onClick="return qs(event,this,2)"  class=SI href="mmu.v.html#17">RST_X</a>, <a  onClick="return qs(event,this,181)"  class=SR href="mmu.v.html#661">r_uart_data</a>, <a  onClick="return qs(event,this,180)"  class=SR href="mmu.v.html#660">r_uart_we</a>, <a  onClick="return qs(event,this,184)"  class=SW href="mmu.v.html#715">w_cons_txd</a>, <a  onClick="return qs(event,this,179)"  class=SW href="mmu.v.html#656">w_tx_ready</a>);

<a name="718"></a>    <span class=K>assign</span> <a  onClick="return qs(event,this,46)"  class=SO href="mmu.v.html#75">w_uart_data</a> = <a  onClick="return qs(event,this,181)"  class=SR href="mmu.v.html#675">r_uart_data</a>;
<a name="719"></a>    <span class=K>assign</span> <a  onClick="return qs(event,this,47)"  class=SO href="mmu.v.html#76">w_uart_we</a>   = <a  onClick="return qs(event,this,180)"  class=SR href="mmu.v.html#674">r_uart_we</a>;

<a name="721"></a>    <span class=K>wire</span> [31:0]  <a  onClick="return qs(event,this,185)"  class=SW href="mmu.v.html#725">w_pl_init_addr</a>;
<a name="722"></a>    <span class=K>wire</span> [31:0]  <a  onClick="return qs(event,this,186)"  class=SW href="mmu.v.html#725">w_pl_init_data</a>;
    <span class=C>//wire         w_pl_init_we;
</span><a name="724"></a>    <span class=K>wire</span>         <a  onClick="return qs(event,this,187)"  class=SW href="mmu.v.html#726">w_pl_init_done</a>;
<a name="m_mmu_ploader"></a><a name="725"></a>    <a  onClick="return qs(event,this,0)"  class=MM href="loader.v.html#PLOADER">PLOADER</a> ploader(<a  onClick="return qs(event,this,1)"  class=SI href="mmu.v.html#17">CLK</a>, <a  onClick="return qs(event,this,2)"  class=SI href="mmu.v.html#17">RST_X</a>, <a  onClick="return qs(event,this,26)"  class=SI href="mmu.v.html#36">w_rxd</a>, <a  onClick="return qs(event,this,185)"  class=SW href="mmu.v.html#721">w_pl_init_addr</a>, <a  onClick="return qs(event,this,186)"  class=SW href="mmu.v.html#722">w_pl_init_data</a>, <a  onClick="return qs(event,this,54)"  class=SO href="mmu.v.html#85">w_pl_init_we</a>,
<a name="726"></a>                    <a  onClick="return qs(event,this,187)"  class=SW href="mmu.v.html#724">w_pl_init_done</a>, <a  onClick="return qs(event,this,152)"  class=SW href="mmu.v.html#427">w_key_we</a>, <a  onClick="return qs(event,this,153)"  class=SW href="mmu.v.html#428">w_key_data</a>);

    <span class=C>/**********************************************************************************************/</span>
<span class=P>`ifdef SIM_MODE
</span><span class=P>    reg  [2:0] r_init_state = 5;
</span><span class=M>`else</span>
<a name="732"></a>    <span class=K>reg</span>  [2:0] <a  onClick="return qs(event,this,188)"  class=SR href="mmu.v.html#782">r_init_state</a> = 0;
<span class=M>`endif</span>
<a name="734"></a>    <span class=K>reg</span>  [31:0]  <a  onClick="return qs(event,this,189)"  class=SR href="mmu.v.html#805">r_initaddr</a>  = 0;
<a name="735"></a>    <span class=K>reg</span>  [31:0]  <a  onClick="return qs(event,this,190)"  class=SR href="mmu.v.html#744">r_checksum</a> = 0;
    <span class=K>always</span>@(<span class=K>posedge</span> <a  onClick="return qs(event,this,1)"  class=SI href="mmu.v.html#17">CLK</a>) <span class=K>begin</span>
<span class=C>//`ifdef LAUR_MEM_RB
</span><span class=C>//	r_checksum &lt;= (!RST_X)                      ? 0                             :
</span><span class=C>//		      (!w_init_done &amp; w_pl_init_we &amp; 
</span><span class=C>//		      ((r_init_state == 2) &amp;&amp; (r_initaddr  &lt; `BIN_BBL_SIZE)))
</span><span class=C>//		      				    ? r_checksum + w_pl_init_data   :
</span><span class=C>//		      r_checksum;
</span><span class=C>//`else
</span><a name="744"></a>	<a  onClick="return qs(event,this,190)"  class=SR href="mmu.v.html#735">r_checksum</a> &lt;= (!<a  onClick="return qs(event,this,2)"  class=SI href="mmu.v.html#17">RST_X</a>)                      ? 0                             :
                      (!<a  onClick="return qs(event,this,27)"  class=SO href="mmu.v.html#800">w_init_done</a> &amp; <a  onClick="return qs(event,this,54)"  class=SO href="mmu.v.html#725">w_pl_init_we</a>) ? <a  onClick="return qs(event,this,190)"  class=SR href="mmu.v.html#744">r_checksum</a> + <a  onClick="return qs(event,this,186)"  class=SW href="mmu.v.html#725">w_pl_init_data</a>   :
		      <a  onClick="return qs(event,this,190)"  class=SR href="mmu.v.html#744">r_checksum</a>;
<span class=C>//`endif
</span>    <span class=K>end</span>

<a name="750"></a>    <span class=K>assign</span> <a  onClick="return qs(event,this,50)"  class=SO href="mmu.v.html#79">w_checksum</a> = <a  onClick="return qs(event,this,190)"  class=SR href="mmu.v.html#744">r_checksum</a>;

    <span class=C>/**********************************************************************************************/</span>

<a name="754"></a>    <span class=K>wire</span> <a  onClick="return qs(event,this,191)"  class=SW href="mmu.v.html#756">w_debug_txd</a>;
<a name="755"></a>    <span class=K>wire</span> <a  onClick="return qs(event,this,192)"  class=SW href="mmu.v.html#756">w_rec_done</a>;
<a name="m_mmu_debug_KEY"></a><a name="756"></a>    <a  onClick="return qs(event,this,0)"  class=MM href="debug.v.html#m_debug_key">m_debug_key</a> debug_KEY(<a  onClick="return qs(event,this,1)"  class=SI href="mmu.v.html#17">CLK</a>, <a  onClick="return qs(event,this,2)"  class=SI href="mmu.v.html#17">RST_X</a>, <a  onClick="return qs(event,this,52)"  class=SI href="mmu.v.html#83">w_debug_btnd</a>, <a  onClick="return qs(event,this,191)"  class=SW href="mmu.v.html#754">w_debug_txd</a>, <a  onClick="return qs(event,this,152)"  class=SW href="mmu.v.html#427">w_key_we</a>, <a  onClick="return qs(event,this,153)"  class=SW href="mmu.v.html#428">w_key_data</a>, <a  onClick="return qs(event,this,14)"  class=SI href="mmu.v.html#25">w_mtime</a>[31:0], <a  onClick="return qs(event,this,192)"  class=SW href="mmu.v.html#755">w_rec_done</a>);

<a name="758"></a>    <span class=K>assign</span> <a  onClick="return qs(event,this,25)"  class=SO href="mmu.v.html#35">w_txd</a> = (<a  onClick="return qs(event,this,192)"  class=SW href="mmu.v.html#756">w_rec_done</a>) ? <a  onClick="return qs(event,this,191)"  class=SW href="mmu.v.html#756">w_debug_txd</a> : <a  onClick="return qs(event,this,184)"  class=SW href="mmu.v.html#716">w_cons_txd</a>;

<span class=C>/**************************************************************************************************/</span>
<a name="761"></a>    <span class=K>reg</span>          <a  onClick="return qs(event,this,193)"  class=SR href="mmu.v.html#806">r_bbl_done</a>   = 0;
<a name="762"></a>    <span class=K>reg</span>          <a  onClick="return qs(event,this,194)"  class=SR href="mmu.v.html#810">r_disk_done</a>  = 0;
<a name="763"></a>    <span class=K>reg</span>          <a  onClick="return qs(event,this,195)"  class=SR href="mmu.v.html#808">r_dtree_done</a> = 0;
<span class=M>`ifdef</span> <a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#202">LAUR_MEM_RB</a>
<a name="765"></a>    <span class=K>reg</span>  [31:0]  <a  onClick="return qs(event,this,196)"  class=SR href="mmu.v.html#868">r_initaddr6</a>  = 0;
<span class=M>`endif</span>
<a name="767"></a>    <span class=K>reg</span>  [31:0]  <a  onClick="return qs(event,this,197)"  class=SR href="mmu.v.html#809">r_initaddr2</a> = <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#206">BBL_SIZE</a> ; <span class=C>/* initial addres for Disk Drive */</span>
<a name="768"></a>    <span class=K>reg</span>  [31:0]  <a  onClick="return qs(event,this,198)"  class=SR href="mmu.v.html#807">r_initaddr3</a> = <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#199">D_INITD_ADDR</a> ; <span class=C>/* initial address of Device Tree */</span>

    <span class=C>// Zero init
</span><a name="771"></a>    <span class=K>wire</span> <a  onClick="return qs(event,this,199)"  class=SW href="mmu.v.html#922">w_zero_we</a>;
<a name="772"></a>    <span class=K>reg</span>  <a  onClick="return qs(event,this,200)"  class=SR href="mmu.v.html#904">r_zero_we</a>=0;
<a name="773"></a>    <span class=K>reg</span>  <a  onClick="return qs(event,this,201)"  class=SR href="mmu.v.html#912">r_zero_done</a>        = 0;
<a name="774"></a>    <span class=K>reg</span>  [31:0]  <a  onClick="return qs(event,this,202)"  class=SR href="mmu.v.html#910">r_zeroaddr</a> = 0;

<span class=M>`ifdef</span> <a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#202">LAUR_MEM_RB</a>
    <span class=C>// xsim requires declaration before use
</span><a name="778"></a>    <span class=K>reg</span> <a  onClick="return qs(event,this,203)"  class=SR href="mmu.v.html#837">r_mem_rb_done</a>=0;
<span class=M>`endif</span>
<span class=M>`ifndef</span> <span class=D>SIM_MODE</span>
    <span class=K>always</span>@(<span class=K>posedge</span> <a  onClick="return qs(event,this,1)"  class=SI href="mmu.v.html#17">CLK</a>) <span class=K>begin</span>
<a name="782"></a>        <a  onClick="return qs(event,this,188)"  class=SR href="mmu.v.html#732">r_init_state</a> &lt;= (!<a  onClick="return qs(event,this,2)"  class=SI href="mmu.v.html#17">RST_X</a>) ? 0 :
                      (<a  onClick="return qs(event,this,188)"  class=SR href="mmu.v.html#782">r_init_state</a> == 0)                ? 1 :
                      (<a  onClick="return qs(event,this,188)"  class=SR href="mmu.v.html#782">r_init_state</a> == 1 &amp; <a  onClick="return qs(event,this,201)"  class=SR href="mmu.v.html#912">r_zero_done</a>)  ? 2 :
		      (<a  onClick="return qs(event,this,188)"  class=SR href="mmu.v.html#782">r_init_state</a> == 2 &amp; <a  onClick="return qs(event,this,193)"  class=SR href="mmu.v.html#806">r_bbl_done</a>)   ? 3 :
                      (<a  onClick="return qs(event,this,188)"  class=SR href="mmu.v.html#782">r_init_state</a> == 3 &amp; <a  onClick="return qs(event,this,195)"  class=SR href="mmu.v.html#808">r_dtree_done</a>) ? 4 :  
<span class=M>`ifdef</span> <a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#202">LAUR_MEM_RB</a>
		      (<a  onClick="return qs(event,this,188)"  class=SR href="mmu.v.html#782">r_init_state</a> == 4 &amp; <a  onClick="return qs(event,this,194)"  class=SR href="mmu.v.html#810">r_disk_done</a>)  ? 6 :
		      (<a  onClick="return qs(event,this,188)"  class=SR href="mmu.v.html#782">r_init_state</a> == 6 &amp; <a  onClick="return qs(event,this,203)"  class=SR href="mmu.v.html#837">r_mem_rb_done</a>)  ? 5 :
<span class=P>`else 
</span><span class=P>                      (r_init_state == 4 &amp; r_disk_done)  ? 5 :
</span><span class=M>`endif</span>
                      <a  onClick="return qs(event,this,188)"  class=SR href="mmu.v.html#782">r_init_state</a>;
    <span class=K>end</span>
<span class=M>`endif</span>

    <span class=C>//assign w_init_start = (r_initaddr != 0);
</span><a name="798"></a>    <span class=K>assign</span> <a  onClick="return qs(event,this,53)"  class=SO href="mmu.v.html#84">w_init_state</a> = <a  onClick="return qs(event,this,188)"  class=SR href="mmu.v.html#782">r_init_state</a>;

<a name="800"></a>    <span class=K>assign</span> <a  onClick="return qs(event,this,27)"  class=SO href="mmu.v.html#37">w_init_done</a> = (<a  onClick="return qs(event,this,188)"  class=SR href="mmu.v.html#782">r_init_state</a> == 5);
        
    <span class=K>always</span>@(<span class=K>posedge</span> <a  onClick="return qs(event,this,1)"  class=SI href="mmu.v.html#17">CLK</a>) <span class=K>begin</span>	
	<span class=K>if</span>(<a  onClick="return qs(event,this,188)"  class=SR href="mmu.v.html#732">r_init_state</a> &lt; 1)
		<span class=ST>$display</span>(<span class=S>&quot;r_init_state=%d&quot;</span>, <a  onClick="return qs(event,this,188)"  class=SR href="mmu.v.html#732">r_init_state</a>);
<a name="805"></a>        <span class=K>if</span>(<a  onClick="return qs(event,this,54)"  class=SO href="mmu.v.html#85">w_pl_init_we</a> &amp; (<a  onClick="return qs(event,this,188)"  class=SR href="mmu.v.html#732">r_init_state</a> == 2)) <span class=K>begin</span>     <a  onClick="return qs(event,this,189)"  class=SR href="mmu.v.html#734">r_initaddr</a>      &lt;= <a  onClick="return qs(event,this,189)"  class=SR href="mmu.v.html#805">r_initaddr</a> + 4; <span class=K>end</span>
<a name="806"></a>        <span class=K>if</span>(<a  onClick="return qs(event,this,189)"  class=SR href="mmu.v.html#734">r_initaddr</a>  &gt;= <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#213">BIN_BBL_SIZE</a>)            <a  onClick="return qs(event,this,193)"  class=SR href="mmu.v.html#806">r_bbl_done</a>      &lt;= 1;
<a name="807"></a>        <span class=K>if</span>(<a  onClick="return qs(event,this,54)"  class=SO href="mmu.v.html#85">w_pl_init_we</a> &amp; (<a  onClick="return qs(event,this,188)"  class=SR href="mmu.v.html#732">r_init_state</a> == 3))      <a  onClick="return qs(event,this,198)"  class=SR href="mmu.v.html#768">r_initaddr3</a>     &lt;= <a  onClick="return qs(event,this,198)"  class=SR href="mmu.v.html#807">r_initaddr3</a> + 4;
<a name="808"></a>        <span class=K>if</span>(<a  onClick="return qs(event,this,198)"  class=SR href="mmu.v.html#768">r_initaddr3</a> &gt;= (<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#199">D_INITD_ADDR</a> + <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#214">D_SIZE_DEVT</a>))  <a  onClick="return qs(event,this,195)"  class=SR href="mmu.v.html#808">r_dtree_done</a>    &lt;= 1;
<a name="809"></a>        <span class=K>if</span>(<a  onClick="return qs(event,this,54)"  class=SO href="mmu.v.html#85">w_pl_init_we</a> &amp; (<a  onClick="return qs(event,this,188)"  class=SR href="mmu.v.html#732">r_init_state</a> == 4))      <a  onClick="return qs(event,this,197)"  class=SR href="mmu.v.html#767">r_initaddr2</a>     &lt;= <a  onClick="return qs(event,this,197)"  class=SR href="mmu.v.html#809">r_initaddr2</a> + 4;
<a name="810"></a>        <span class=K>if</span>(<a  onClick="return qs(event,this,197)"  class=SR href="mmu.v.html#767">r_initaddr2</a> &gt;= <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#206">BBL_SIZE</a> + <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#215">BIN_DISK_SIZE</a>)      <a  onClick="return qs(event,this,194)"  class=SR href="mmu.v.html#810">r_disk_done</a>     &lt;= 1;
    <span class=K>end</span>

<span class=M>`ifdef</span> <a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#202">LAUR_MEM_RB</a>
<span class=M>`ifdef</span> <a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#203">LAUR_MEM_RB_ONLY_CHECK</a>
<a name="815"></a>        <span class=K>reg</span> [31:0] <a  onClick="return qs(event,this,204)"  class=SR href="mmu.v.html#856">r_rb_delay</a>=0;
<span class=M>`endif</span>
<a name="817"></a>	<span class=K>reg</span> [7:0] <a  onClick="return qs(event,this,205)"  class=SR href="mmu.v.html#823">r_rb_state</a>=0, <a  onClick="return qs(event,this,206)"  class=SR href="mmu.v.html#860">r_rb_cnt</a>=0;
<a name="818"></a>	<span class=K>reg</span> [31:0] <a  onClick="return qs(event,this,207)"  class=SR href="mmu.v.html#850">r_rb_data</a>=0, <a  onClick="return qs(event,this,208)"  class=SR href="mmu.v.html#849">r_verify_checksum</a>=0;
<a name="819"></a>	<span class=K>assign</span> <a  onClick="return qs(event,this,51)"  class=SO href="mmu.v.html#81">w_verify_checksum</a> = <a  onClick="return qs(event,this,208)"  class=SR href="mmu.v.html#849">r_verify_checksum</a>;
<a name="820"></a>	<span class=K>wire</span> <a  onClick="return qs(event,this,209)"  class=SW href="mmu.v.html#820">w_checksum_match</a> = (<a  onClick="return qs(event,this,208)"  class=SR href="mmu.v.html#849">r_verify_checksum</a> == <a  onClick="return qs(event,this,190)"  class=SR href="mmu.v.html#744">r_checksum</a>);
    	<span class=K>always</span>@(<span class=K>posedge</span> <a  onClick="return qs(event,this,1)"  class=SI href="mmu.v.html#17">CLK</a>) <span class=K>begin</span>
		<span class=K>if</span>(<a  onClick="return qs(event,this,188)"  class=SR href="mmu.v.html#732">r_init_state</a> != 6) <span class=K>begin</span>
<a name="823"></a>			<a  onClick="return qs(event,this,205)"  class=SR href="mmu.v.html#817">r_rb_state</a> &lt;= 0;
<a name="824"></a>			<a  onClick="return qs(event,this,136)"  class=SR href="mmu.v.html#372">r_set_dram_le</a> &lt;= 0;
		<span class=K>end</span> <span class=K>else</span> <span class=K>begin</span>
			<span class=K>if</span>(<a  onClick="return qs(event,this,205)"  class=SR href="mmu.v.html#817">r_rb_state</a> == 0) <span class=K>begin</span> <span class=C>// idle
</span>				<span class=K>if</span>(!<a  onClick="return qs(event,this,203)"  class=SR href="mmu.v.html#778">r_mem_rb_done</a>)
					<a  onClick="return qs(event,this,205)"  class=SR href="mmu.v.html#817">r_rb_state</a> &lt;= 1;
			<span class=K>end</span> <span class=K>else</span> <span class=K>if</span>(<a  onClick="return qs(event,this,205)"  class=SR href="mmu.v.html#817">r_rb_state</a> == 1) <span class=K>begin</span>
				<span class=C>// memory is 0 between (`D_INITD_ADDR + `D_SIZE_DEVT) and `BBL_SIZE
</span>				<span class=K>if</span>(<a  onClick="return qs(event,this,196)"  class=SR href="mmu.v.html#765">r_initaddr6</a> &lt; (<span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#206">BBL_SIZE</a> + <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#215">BIN_DISK_SIZE</a>)) <span class=K>begin</span>
					<span class=K>if</span>(!<a  onClick="return qs(event,this,78)"  class=SW href="mmu.v.html#165">w_dram_busy</a>) <span class=K>begin</span>
						<a  onClick="return qs(event,this,136)"  class=SR href="mmu.v.html#372">r_set_dram_le</a> &lt;= 1;
						<a  onClick="return qs(event,this,205)"  class=SR href="mmu.v.html#817">r_rb_state</a> &lt;= 7;
					<span class=K>end</span>
				<span class=K>end</span> <span class=K>else</span> <span class=K>begin</span>
<a name="837"></a>					<a  onClick="return qs(event,this,203)"  class=SR href="mmu.v.html#778">r_mem_rb_done</a> &lt;= 1;
					<a  onClick="return qs(event,this,205)"  class=SR href="mmu.v.html#817">r_rb_state</a> &lt;= 0;
				<span class=K>end</span>
			<span class=K>end</span> <span class=K>else</span> <span class=K>if</span>(<a  onClick="return qs(event,this,205)"  class=SR href="mmu.v.html#817">r_rb_state</a> == 7) <span class=K>begin</span> <span class=C>// we have sent command
</span>				<span class=K>if</span>(<a  onClick="return qs(event,this,78)"  class=SW href="mmu.v.html#165">w_dram_busy</a>) <span class=K>begin</span>
					<a  onClick="return qs(event,this,136)"  class=SR href="mmu.v.html#372">r_set_dram_le</a> &lt;= 0;
					<a  onClick="return qs(event,this,205)"  class=SR href="mmu.v.html#817">r_rb_state</a> &lt;= 2;
				<span class=K>end</span>
			<span class=K>end</span> <span class=K>else</span> <span class=K>if</span>(<a  onClick="return qs(event,this,205)"  class=SR href="mmu.v.html#817">r_rb_state</a> == 2) <span class=K>begin</span> <span class=C>// wait ram data
</span>				<a  onClick="return qs(event,this,136)"  class=SR href="mmu.v.html#372">r_set_dram_le</a> &lt;= 0;
				<span class=K>if</span>(!<a  onClick="return qs(event,this,78)"  class=SW href="mmu.v.html#165">w_dram_busy</a>) <span class=K>begin</span>
					<span class=C>// we have w_dram_odata
</span><a name="849"></a>					<a  onClick="return qs(event,this,208)"  class=SR href="mmu.v.html#818">r_verify_checksum</a> &lt;= <a  onClick="return qs(event,this,208)"  class=SR href="mmu.v.html#849">r_verify_checksum</a> + <a  onClick="return qs(event,this,76)"  class=SW href="mmu.v.html#963">w_dram_odata</a>;
<a name="850"></a>					<a  onClick="return qs(event,this,207)"  class=SR href="mmu.v.html#818">r_rb_data</a> &lt;= <a  onClick="return qs(event,this,76)"  class=SW href="mmu.v.html#963">w_dram_odata</a>;
<span class=M>`ifdef</span> <a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#203">LAUR_MEM_RB_ONLY_CHECK</a>
					<span class=ST>$display</span>(<span class=S>&quot;mem[%x]: %x='%c%c%c%c'&quot;</span>, <a  onClick="return qs(event,this,196)"  class=SR href="mmu.v.html#765">r_initaddr6</a>, <a  onClick="return qs(event,this,76)"  class=SW href="mmu.v.html#162">w_dram_odata</a>, 
						 <a  onClick="return qs(event,this,76)"  class=SW href="mmu.v.html#162">w_dram_odata</a> &gt;&gt; 24, (<a  onClick="return qs(event,this,76)"  class=SW href="mmu.v.html#162">w_dram_odata</a> &gt;&gt; 16) &amp; 8'hff, 
						(<a  onClick="return qs(event,this,76)"  class=SW href="mmu.v.html#162">w_dram_odata</a> &gt;&gt; 8) &amp; 8'hff, <a  onClick="return qs(event,this,76)"  class=SW href="mmu.v.html#162">w_dram_odata</a> &amp; 8'hff);
					<a  onClick="return qs(event,this,205)"  class=SR href="mmu.v.html#817">r_rb_state</a> &lt;= 20;
<a name="856"></a>					<a  onClick="return qs(event,this,204)"  class=SR href="mmu.v.html#815">r_rb_delay</a> &lt;= 0;
<span class=P>`else
</span><span class=P>					r_rb_state &lt;= 3;
</span><span class=M>`endif</span>
<a name="860"></a>					<a  onClick="return qs(event,this,206)"  class=SR href="mmu.v.html#817">r_rb_cnt</a> &lt;= 0;
				<span class=K>end</span>
<span class=M>`ifdef</span> <a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#203">LAUR_MEM_RB_ONLY_CHECK</a>
			<span class=K>end</span> <span class=K>else</span> <span class=K>if</span>(<a  onClick="return qs(event,this,205)"  class=SR href="mmu.v.html#817">r_rb_state</a> == 20) <span class=K>begin</span>
                                <span class=K>if</span>(<a  onClick="return qs(event,this,204)"  class=SR href="mmu.v.html#815">r_rb_delay</a> &lt; 1) 
                                        <a  onClick="return qs(event,this,204)"  class=SR href="mmu.v.html#815">r_rb_delay</a> &lt;= <a  onClick="return qs(event,this,204)"  class=SR href="mmu.v.html#856">r_rb_delay</a> + 1;
                                <span class=K>else</span> <span class=K>begin</span>
                                        <a  onClick="return qs(event,this,205)"  class=SR href="mmu.v.html#817">r_rb_state</a> &lt;= 0;
<a name="868"></a>                                        <a  onClick="return qs(event,this,196)"  class=SR href="mmu.v.html#765">r_initaddr6</a> &lt;= <a  onClick="return qs(event,this,196)"  class=SR href="mmu.v.html#868">r_initaddr6</a> + 4;
                                        <a  onClick="return qs(event,this,204)"  class=SR href="mmu.v.html#815">r_rb_delay</a> &lt;= 0;
                                <span class=K>end</span>	
<span class=M>`endif</span>
			<span class=K>end</span> <span class=K>else</span> <span class=K>if</span>(<a  onClick="return qs(event,this,205)"  class=SR href="mmu.v.html#817">r_rb_state</a> == 3) <span class=K>begin</span> <span class=C>// send 32 bit data
</span>				<span class=K>if</span>(<a  onClick="return qs(event,this,179)"  class=SW href="mmu.v.html#656">w_tx_ready</a>)
				       <span class=K>if</span>(<a  onClick="return qs(event,this,206)"  class=SR href="mmu.v.html#817">r_rb_cnt</a> &lt; 4) <span class=K>begin</span>
						<a  onClick="return qs(event,this,206)"  class=SR href="mmu.v.html#817">r_rb_cnt</a> &lt;= <a  onClick="return qs(event,this,206)"  class=SR href="mmu.v.html#860">r_rb_cnt</a> + 1;
<a name="876"></a>						<a  onClick="return qs(event,this,183)"  class=SR href="mmu.v.html#665">r_rb_uart_data</a> &lt;= <a  onClick="return qs(event,this,207)"  class=SR href="mmu.v.html#850">r_rb_data</a>[7:0];
						<a  onClick="return qs(event,this,207)"  class=SR href="mmu.v.html#818">r_rb_data</a> &lt;= {8'h0, <a  onClick="return qs(event,this,207)"  class=SR href="mmu.v.html#850">r_rb_data</a>[31:8]};
						<a  onClick="return qs(event,this,205)"  class=SR href="mmu.v.html#817">r_rb_state</a> &lt;= 4;
					<span class=K>end</span> <span class=K>else</span> <span class=K>begin</span>
<a name="880"></a>						<a  onClick="return qs(event,this,182)"  class=SR href="mmu.v.html#664">r_rb_uart_we</a> &lt;= 0;
						<a  onClick="return qs(event,this,196)"  class=SR href="mmu.v.html#765">r_initaddr6</a> &lt;= <a  onClick="return qs(event,this,196)"  class=SR href="mmu.v.html#868">r_initaddr6</a> + 4;
						<a  onClick="return qs(event,this,205)"  class=SR href="mmu.v.html#817">r_rb_state</a> &lt;= 0;
					<span class=K>end</span>
			<span class=K>end</span> <span class=K>else</span> <span class=K>if</span>(<a  onClick="return qs(event,this,205)"  class=SR href="mmu.v.html#817">r_rb_state</a> == 4) <span class=K>begin</span> <span class=C>// send 1 byte
</span>				<a  onClick="return qs(event,this,182)"  class=SR href="mmu.v.html#664">r_rb_uart_we</a> &lt;= 1;
				<span class=K>if</span>(!<a  onClick="return qs(event,this,179)"  class=SW href="mmu.v.html#656">w_tx_ready</a>)
					<a  onClick="return qs(event,this,205)"  class=SR href="mmu.v.html#817">r_rb_state</a> &lt;= 5;
			<span class=K>end</span> <span class=K>else</span> <span class=K>if</span>(<a  onClick="return qs(event,this,205)"  class=SR href="mmu.v.html#817">r_rb_state</a> == 5) <span class=K>begin</span> <span class=C>// done sending 1 byte
</span>				<a  onClick="return qs(event,this,205)"  class=SR href="mmu.v.html#817">r_rb_state</a> &lt;= 3;
				<a  onClick="return qs(event,this,182)"  class=SR href="mmu.v.html#664">r_rb_uart_we</a> &lt;= 0;
			<span class=K>end</span>
		<span class=K>end</span>
    	<span class=K>end</span>
<span class=M>`endif</span>

    <span class=C>// Zero init
</span><a name="897"></a>    <span class=K>wire</span> <a  onClick="return qs(event,this,210)"  class=SW href="mmu.v.p2.html#1009">calib_done</a>;
    <span class=K>always</span>@(<span class=K>posedge</span> <a  onClick="return qs(event,this,1)"  class=SI href="mmu.v.html#17">CLK</a>) <span class=K>begin</span>
<span class=P>`ifdef SIM_MAIN
</span><span class=P>	r_zero_we &lt;= 0;
</span><span class=P>	r_zero_done &lt;= 1;
</span><span class=M>`else</span>
<span class=M>`ifndef</span> <span class=D>ARTYA7</span>
<a name="904"></a>        <span class=K>if</span>(!<a  onClick="return qs(event,this,78)"  class=SW href="mmu.v.html#165">w_dram_busy</a> &amp; !<a  onClick="return qs(event,this,201)"  class=SR href="mmu.v.html#773">r_zero_done</a>) <a  onClick="return qs(event,this,200)"  class=SR href="mmu.v.html#772">r_zero_we</a> &lt;= 1;
<span class=P>`else
</span><span class=P>        if(!w_dram_busy &amp; !r_zero_done &amp; calib_done) r_zero_we &lt;= 1;
</span><span class=M>`endif</span>
        <span class=K>if</span>(<a  onClick="return qs(event,this,200)"  class=SR href="mmu.v.html#772">r_zero_we</a>) <span class=K>begin</span>
            <a  onClick="return qs(event,this,200)"  class=SR href="mmu.v.html#772">r_zero_we</a>    &lt;= 0;
<a name="910"></a>            <a  onClick="return qs(event,this,202)"  class=SR href="mmu.v.html#774">r_zeroaddr</a> &lt;= <a  onClick="return qs(event,this,202)"  class=SR href="mmu.v.html#910">r_zeroaddr</a> + 4;
        <span class=K>end</span>
<a name="912"></a>        <span class=K>if</span>(<a  onClick="return qs(event,this,202)"  class=SR href="mmu.v.html#774">r_zeroaddr</a> &gt;= <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="ddr3_model.sv.html#135">MEM_SIZE</a>) <a  onClick="return qs(event,this,201)"  class=SR href="mmu.v.html#912">r_zero_done</a> &lt;= 1;
<span class=M>`endif</span>
    <span class=K>end</span>

<span class=P>`ifdef SIM_MODE
</span><span class=P>    assign w_zero_we = 0;
</span><span class=M>`else</span>
<span class=P>`ifdef SIM_MAIN
</span><span class=P>    assign w_zero_we = 0;
</span><span class=M>`else</span>
<a name="922"></a>    <span class=K>assign</span> <a  onClick="return qs(event,this,199)"  class=SW href="mmu.v.html#771">w_zero_we</a> = <a  onClick="return qs(event,this,200)"  class=SR href="mmu.v.html#904">r_zero_we</a>;
<span class=M>`endif</span>
<span class=M>`endif</span>
    <span class=C>/**********************************************************************************************/</span>
<a name="926"></a>    <span class=K>wire</span> [31:0] <a  onClick="return qs(event,this,211)"  class=SW href="mmu.v.html#926">w_dram_addr_t</a>   = ((<a  onClick="return qs(event,this,133)"  class=SW href="mmu.v.html#359">w_dram_addr</a>[31:28]==9) ?
                                    (<a  onClick="return qs(event,this,133)"  class=SW href="mmu.v.html#359">w_dram_addr</a> &amp; 32'h3ffffff) + <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#206">BBL_SIZE</a> :
                                    <a  onClick="return qs(event,this,133)"  class=SW href="mmu.v.html#359">w_dram_addr</a> &amp; 32'h3ffffff);
<a name="929"></a>    <span class=K>wire</span> [31:0]  <a  onClick="return qs(event,this,212)"  class=SW href="mmu.v.html#929">w_dram_addr_t2</a> =
                    (<a  onClick="return qs(event,this,188)"  class=SR href="mmu.v.html#782">r_init_state</a> == 1) ? <a  onClick="return qs(event,this,202)"  class=SR href="mmu.v.html#910">r_zeroaddr</a>     : 
                    (<a  onClick="return qs(event,this,188)"  class=SR href="mmu.v.html#782">r_init_state</a> == 2) ? <a  onClick="return qs(event,this,189)"  class=SR href="mmu.v.html#805">r_initaddr</a>     :
<span class=M>`ifdef</span> <a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#202">LAUR_MEM_RB</a>
		    (<a  onClick="return qs(event,this,188)"  class=SR href="mmu.v.html#782">r_init_state</a> == 6) ? <a  onClick="return qs(event,this,196)"  class=SR href="mmu.v.html#868">r_initaddr6</a>    :
<span class=M>`endif</span>
                    (<a  onClick="return qs(event,this,188)"  class=SR href="mmu.v.html#782">r_init_state</a> == 3) ? <a  onClick="return qs(event,this,198)"  class=SR href="mmu.v.html#807">r_initaddr3</a>    : 
                    (<a  onClick="return qs(event,this,188)"  class=SR href="mmu.v.html#782">r_init_state</a> == 4) ? <a  onClick="return qs(event,this,197)"  class=SR href="mmu.v.html#809">r_initaddr2</a>    : <a  onClick="return qs(event,this,211)"  class=SW href="mmu.v.html#926">w_dram_addr_t</a>;
    
<a name="938"></a>    <span class=K>wire</span> [31:0]  <a  onClick="return qs(event,this,213)"  class=SW href="mmu.v.html#938">w_dram_wdata_t</a>   =   (<a  onClick="return qs(event,this,188)"  class=SR href="mmu.v.html#782">r_init_state</a> == 1) ? 32'b0 :
                                    (<a  onClick="return qs(event,this,188)"  class=SR href="mmu.v.html#782">r_init_state</a> == 5) ? <a  onClick="return qs(event,this,131)"  class=SW href="mmu.v.html#355">w_dram_wdata</a> : <a  onClick="return qs(event,this,186)"  class=SW href="mmu.v.html#725">w_pl_init_data</a>;
<a name="940"></a>    <span class=K>wire</span>         <a  onClick="return qs(event,this,214)"  class=SW href="mmu.v.html#940">w_dram_we_t</a>      =   (<a  onClick="return qs(event,this,106)"  class=SW href="mmu.v.html#210">w_pte_we</a> || <a  onClick="return qs(event,this,132)"  class=SW href="mmu.v.html#356">w_dram_we</a> || <a  onClick="return qs(event,this,150)"  class=SW href="mmu.v.html#408">w_imag_we</a>) &amp;&amp; !<a  onClick="return qs(event,this,78)"  class=SW href="mmu.v.html#964">w_dram_busy</a>;
<a name="941"></a>    <span class=K>wire</span> [2:0]   <a  onClick="return qs(event,this,215)"  class=SW href="mmu.v.html#941">w_dram_ctrl_t</a>  = (!<a  onClick="return qs(event,this,27)"  class=SO href="mmu.v.html#800">w_init_done</a>) ? <span class=D>`</span><a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#548">FUNCT3_SW____</a> : <a  onClick="return qs(event,this,134)"  class=SW href="mmu.v.html#364">w_dram_ctrl</a>;
<span class=C>/**************************************************************************************************/</span>

<span class=M>`ifdef</span> <a  onClick="return qs(event,this,0)"  class=D href="define.vh.html#202">LAUR_MEM_RB</a>
<a name="945"></a><span class=K>wire</span> <a  onClick="return qs(event,this,216)"  class=SW href="mmu.v.html#945">w_wr_en</a> = 
                               (<a  onClick="return qs(event,this,188)"  class=SR href="mmu.v.html#782">r_init_state</a> == 6) ? 0 :
				<a  onClick="return qs(event,this,199)"  class=SW href="mmu.v.html#922">w_zero_we</a> || <a  onClick="return qs(event,this,54)"  class=SO href="mmu.v.html#725">w_pl_init_we</a> || <a  onClick="return qs(event,this,214)"  class=SW href="mmu.v.html#940">w_dram_we_t</a>;
<span class=P>`else
</span><span class=P>wire w_wr_en =                  w_zero_we || w_pl_init_we || w_dram_we_t;
</span><span class=M>`endif</span>


<span class=P>`ifdef SIM_MODE
</span><span class=P>    m_dram_sim#(`MEM_SIZE) idbmem(CLK, w_dram_addr_t2, w_dram_odata, w_dram_we_t, w_dram_le,
</span><span class=P>                                    w_dram_wdata_t, w_dram_ctrl_t, w_dram_busy, w_mtime[31:0]);
</span><span class=M>`else</span>
<a name="m_mmu_dram_con"></a>    <a  onClick="return qs(event,this,0)"  class=MM href="memory.v.html#DRAM_conRV">DRAM_conRV</a> dram_con (
                                <span class=C>// user interface ports
</span><a name="959"></a>                               <span class=SI>.i_rd_en</span>(<a  onClick="return qs(event,this,137)"  class=SW href="mmu.v.html#375">w_dram_le</a>),
<a name="960"></a>                               <span class=SI>.i_wr_en</span>(<a  onClick="return qs(event,this,216)"  class=SW href="mmu.v.html#945">w_wr_en</a>),
<a name="961"></a>                               <span class=SI>.i_addr</span>(<a  onClick="return qs(event,this,212)"  class=SW href="mmu.v.html#929">w_dram_addr_t2</a>),
<a name="962"></a>                               <span class=SI>.i_data</span>(<a  onClick="return qs(event,this,213)"  class=SW href="mmu.v.html#938">w_dram_wdata_t</a>),
<a name="963"></a>                               <a  onClick="return qs(event,this,0)"  class=SO href="memory.v.html#103">.o_data</a>(<a  onClick="return qs(event,this,76)"  class=SW href="mmu.v.html#162">w_dram_odata</a>),
<a name="964"></a>                               <a  onClick="return qs(event,this,0)"  class=SO href="memory.v.html#111">.o_busy</a>(<a  onClick="return qs(event,this,78)"  class=SW href="mmu.v.html#165">w_dram_busy</a>),
<a name="965"></a>                               <span class=SI>.i_ctrl</span>(<a  onClick="return qs(event,this,215)"  class=SW href="mmu.v.html#941">w_dram_ctrl_t</a>),
                               <span class=C>// input clk, rst (active-low)
</span><a name="967"></a>                               <span class=SI>.mig_clk</span>(<a  onClick="return qs(event,this,28)"  class=SI href="mmu.v.html#38">mig_clk</a>),
<a name="968"></a>                               <span class=SI>.mig_rst_x</span>(<a  onClick="return qs(event,this,29)"  class=SI href="mmu.v.html#39">mig_rst_x</a>),
<span class=P>`ifdef ARTYA7
</span><span class=P>                               .ref_clk(ref_clk),
</span><span class=M>`endif</span>
                               <span class=C>// memory interface ports
</span><span class=M>`ifndef</span> <span class=D>ARTYA7</span>
                               <span class=SIO>.ddr2_dq</span>(<a  onClick="return qs(event,this,30)"  class=SIO href="mmu.v.html#41">ddr2_dq</a>),
                               <span class=SIO>.ddr2_dqs_n</span>(<a  onClick="return qs(event,this,31)"  class=SIO href="mmu.v.html#42">ddr2_dqs_n</a>),
                               <span class=SIO>.ddr2_dqs_p</span>(<a  onClick="return qs(event,this,32)"  class=SIO href="mmu.v.html#43">ddr2_dqs_p</a>),
<a name="977"></a>                               <a  onClick="return qs(event,this,0)"  class=SO href="memory.v.html#366">.ddr2_addr</a>(<a  onClick="return qs(event,this,33)"  class=SO href="mmu.v.html#44">ddr2_addr</a>),
<a name="978"></a>                               <a  onClick="return qs(event,this,0)"  class=SO href="memory.v.html#367">.ddr2_ba</a>(<a  onClick="return qs(event,this,34)"  class=SO href="mmu.v.html#45">ddr2_ba</a>),
<a name="979"></a>                               <a  onClick="return qs(event,this,0)"  class=SO href="memory.v.html#368">.ddr2_ras_n</a>(<a  onClick="return qs(event,this,35)"  class=SO href="mmu.v.html#46">ddr2_ras_n</a>),
<a name="980"></a>                               <a  onClick="return qs(event,this,0)"  class=SO href="memory.v.html#369">.ddr2_cas_n</a>(<a  onClick="return qs(event,this,36)"  class=SO href="mmu.v.html#47">ddr2_cas_n</a>),
<a name="981"></a>                               <a  onClick="return qs(event,this,0)"  class=SO href="memory.v.html#370">.ddr2_we_n</a>(<a  onClick="return qs(event,this,37)"  class=SO href="mmu.v.html#48">ddr2_we_n</a>),
<a name="982"></a>                               <a  onClick="return qs(event,this,0)"  class=SO href="memory.v.html#371">.ddr2_ck_p</a>(<a  onClick="return qs(event,this,38)"  class=SO href="mmu.v.html#49">ddr2_ck_p</a>),
<a name="983"></a>                               <a  onClick="return qs(event,this,0)"  class=SO href="memory.v.html#372">.ddr2_ck_n</a>(<a  onClick="return qs(event,this,39)"  class=SO href="mmu.v.html#50">ddr2_ck_n</a>),
<a name="984"></a>                               <a  onClick="return qs(event,this,0)"  class=SO href="memory.v.html#373">.ddr2_cke</a>(<a  onClick="return qs(event,this,40)"  class=SO href="mmu.v.html#51">ddr2_cke</a>),
<a name="985"></a>                               <a  onClick="return qs(event,this,0)"  class=SO href="memory.v.html#374">.ddr2_cs_n</a>(<a  onClick="return qs(event,this,41)"  class=SO href="mmu.v.html#52">ddr2_cs_n</a>),
<a name="986"></a>                               <a  onClick="return qs(event,this,0)"  class=SO href="memory.v.html#375">.ddr2_dm</a>(<a  onClick="return qs(event,this,42)"  class=SO href="mmu.v.html#53">ddr2_dm</a>),
<a name="987"></a>                               <a  onClick="return qs(event,this,0)"  class=SO href="memory.v.html#376">.ddr2_odt</a>(<a  onClick="return qs(event,this,43)"  class=SO href="mmu.v.html#54">ddr2_odt</a>),
<span class=P>`else
</span><span class=P>                               .ddr3_dq(ddr3_dq),
</span><span class=P>                               .ddr3_dqs_n(ddr3_dqs_n),
</span><span class=P>                               .ddr3_dqs_p(ddr3_dqs_p),
</span><span class=P>                               .ddr3_addr(ddr3_addr),
</span><span class=P>                               .ddr3_ba(ddr3_ba),
</span><span class=P>                               .ddr3_ras_n(ddr3_ras_n),
</span><span class=P>                               .ddr3_cas_n(ddr3_cas_n),
</span><span class=P>                               .ddr3_we_n(ddr3_we_n),
</span><span class=P>                               .ddr3_ck_p(ddr3_ck_p),
</span><span class=P>                               .ddr3_ck_n(ddr3_ck_n),
</span><span class=P>                               .ddr3_reset_n(ddr3_reset_n),
</span><span class=P>                               .ddr3_cke(ddr3_cke),
</span></pre>
<center><table class=NB cols=3 ><tr><td align="center" width="33%" onmousedown="this.style.border='inset';" onmouseup="this.style.border='outset';"  onclick="location='mmu.v.p2.html';"><a target="_top" href="mmu.v.p2.html">Next</a></td><td align="center" width="33%" onmousedown="this.style.border='inset';" onmouseup="this.style.border='outset';" ><font color="#808080">1</font></td><td align="center" width="33%" onmousedown="this.style.border='inset';" onmouseup="this.style.border='outset';"  onclick="location='mmu.v.p2.html';"><a target="_top" href="mmu.v.p2.html">2</a></td></tr></table></center>
<center><table class=NB cols=7 ><tr><td align="center" width="14%" onmousedown="this.style.border='inset';" onmouseup="this.style.border='outset';"  onclick="location='hierarchy.html';"><a target="_top" href="hierarchy.html">Hierarchy</a></td><td align="center" width="14%" onmousedown="this.style.border='inset';" onmouseup="this.style.border='outset';"  onclick="location='hierarchy-f.html';"><a target="_top" href="hierarchy-f.html">Files</a></td><td align="center" width="14%" onmousedown="this.style.border='inset';" onmouseup="this.style.border='outset';"  onclick="location='hierarchy-m.html';"><a target="_top" href="hierarchy-m.html">Modules</a></td><td align="center" width="14%" onmousedown="this.style.border='inset';" onmouseup="this.style.border='outset';"  onclick="location='hierarchy-s.html';"><a target="_top" href="hierarchy-s.html">Signals</a></td><td align="center" width="14%" onmousedown="this.style.border='inset';" onmouseup="this.style.border='outset';"  onclick="location='hierarchy-t.html';"><a target="_top" href="hierarchy-t.html">Tasks</a></td><td align="center" width="14%" onmousedown="this.style.border='inset';" onmouseup="this.style.border='outset';"  onclick="location='hierarchy-fn.html';"><a target="_top" href="hierarchy-fn.html">Functions</a></td><td align="center" width="14%" onmousedown="this.style.border='inset';" onmouseup="this.style.border='outset';"  onclick="location='http://www.burbleland.com/v2html/help_7_30.html?';"><a target="_top" href="http://www.burbleland.com/v2html/help_7_30.html?">Help</a></td></tr></table></center>
<script language="JavaScript"type="text/javascript"><!--
function next_page() { return "mmu.v.p2.html"; }
function first_page() { return ""; }
var extra_info = [
["S","mmu.v.html#17","","main.v.html#315","top.v.html#34","hierarchy-s.p2.html#CLK___m_mmu"],
["S","mmu.v.html#17","","main.v.html#316","top.v.html#34","hierarchy-s.p7.html#RST_X___m_mmu"],
["S","mmu.v.html#18","","main.v.html#317","rvcorem.v.html#202","hierarchy-s.p9.html#w_insn_addr___m_mmu"],
["S","mmu.v.html#18","","main.v.html#318","rvcorem.v.html#389","hierarchy-s.p9.html#w_data_addr___m_mmu"],
["S","mmu.v.html#19","","main.v.html#319","rvcorem.v.html#419","hierarchy-s.p9.html#w_data_wdata___m_mmu"],
["S","mmu.v.html#20","","main.v.html#320","rvcorem.v.html#838","hierarchy-s.p9.html#w_data_we___m_mmu"],
["S","mmu.v.html#21","","main.v.html#321","rvcorem.v.html#388","hierarchy-s.p9.html#w_data_ctrl___m_mmu"],
["S","mmu.v.html#22","mmu.v.html#366","","mmu.v.html#366","hierarchy-s.p9.html#w_insn_data___m_mmu"],
["S","mmu.v.html#22","mmu.v.html#420","","mmu.v.html#420","hierarchy-s.p9.html#w_data_data___m_mmu"],
["S","mmu.v.html#23","mmu.v.html#86","","mmu.v.html#86","hierarchy-s.p7.html#r_finish___m_mmu"],
["S","mmu.v.html#24","","main.v.html#325","rvcorem.v.html#839","hierarchy-s.p9.html#w_priv___m_mmu"],
["S","mmu.v.html#24","","main.v.html#326","rvcorem.v.html#840","hierarchy-s.p9.html#w_satp___m_mmu"],
["S","mmu.v.html#24","","main.v.html#327","rvcorem.v.html#841","hierarchy-s.p9.html#w_mstatus___m_mmu"],
["S","mmu.v.html#25","","main.v.html#328","rvcorem.v.html#842","hierarchy-s.p9.html#w_mtime___m_mmu"],
["S","mmu.v.html#25","","main.v.html#329","rvcorem.v.html#843","hierarchy-s.p9.html#w_mtimecmp___m_mmu"],
["S","mmu.v.html#26","mmu.v.html#636","","mmu.v.html#636","hierarchy-s.p9.html#w_wmtimecmp___m_mmu"],
["S","mmu.v.html#27","mmu.v.html#640","","mmu.v.html#640","hierarchy-s.p9.html#w_clint_we___m_mmu"],
["S","mmu.v.html#28","","main.v.html#332","rvcorem.v.html#844","hierarchy-s.p9.html#w_mip___m_mmu"],
["S","mmu.v.html#29","mmu.v.html#628","","mmu.v.html#628","hierarchy-s.p9.html#w_wmip___m_mmu"],
["S","mmu.v.html#30","mmu.v.html#627","","mmu.v.html#627","hierarchy-s.p9.html#w_plic_we___m_mmu"],
["S","mmu.v.html#31","mmu.v.html#657","","mmu.v.html#657","hierarchy-s.p9.html#w_proc_busy___m_mmu"],
["S","mmu.v.html#32","mmu.v.html#215","","mmu.v.html#215","hierarchy-s.p9.html#w_pagefault___m_mmu"],
["S","mmu.v.html#33","","main.v.html#337","rvcorem.v.html#837","hierarchy-s.p9.html#w_tlb_req___m_mmu"],
["S","mmu.v.html#34","","main.v.html#338","rvcorem.v.html#778","hierarchy-s.p9.html#w_tlb_flush___m_mmu"],
["S","mmu.v.html#35","mmu.v.html#758","","mmu.v.html#758","hierarchy-s.p9.html#w_txd___m_mmu"],
["S","mmu.v.html#36","","main.v.html#340","","hierarchy-s.p9.html#w_rxd___m_mmu"],
["S","mmu.v.html#37","mmu.v.html#800","","mmu.v.html#800","hierarchy-s.p9.html#w_init_done___m_mmu"],
["S","mmu.v.html#38","","main.v.html#343","","hierarchy-s.p5.html#mig_clk___m_mmu"],
["S","mmu.v.html#39","","main.v.html#344","","hierarchy-s.p5.html#mig_rst_x___m_mmu"],
["S","mmu.v.html#41","","","","hierarchy-s.p3.html#ddr2_dq___m_mmu"],
["S","mmu.v.html#42","","","","hierarchy-s.p3.html#ddr2_dqs_n___m_mmu"],
["S","mmu.v.html#43","","","","hierarchy-s.p3.html#ddr2_dqs_p___m_mmu"],
["S","mmu.v.html#44","mmu.v.html#977","","","hierarchy-s.p3.html#ddr2_addr___m_mmu"],
["S","mmu.v.html#45","mmu.v.html#978","","","hierarchy-s.p3.html#ddr2_ba___m_mmu"],
["S","mmu.v.html#46","mmu.v.html#979","","","hierarchy-s.p3.html#ddr2_ras_n___m_mmu"],
["S","mmu.v.html#47","mmu.v.html#980","","","hierarchy-s.p3.html#ddr2_cas_n___m_mmu"],
["S","mmu.v.html#48","mmu.v.html#981","","","hierarchy-s.p3.html#ddr2_we_n___m_mmu"],
["S","mmu.v.html#49","mmu.v.html#982","","","hierarchy-s.p3.html#ddr2_ck_p___m_mmu"],
["S","mmu.v.html#50","mmu.v.html#983","","","hierarchy-s.p3.html#ddr2_ck_n___m_mmu"],
["S","mmu.v.html#51","mmu.v.html#984","","","hierarchy-s.p3.html#ddr2_cke___m_mmu"],
["S","mmu.v.html#52","mmu.v.html#985","","","hierarchy-s.p3.html#ddr2_cs_n___m_mmu"],
["S","mmu.v.html#53","mmu.v.html#986","","","hierarchy-s.p3.html#ddr2_dm___m_mmu"],
["S","mmu.v.html#54","mmu.v.html#987","","","hierarchy-s.p3.html#ddr2_odt___m_mmu"],
["S","mmu.v.html#73","mmu.v.p2.html#1006","","dram.v.html#154","hierarchy-s.p6.html#o_clk___m_mmu"],
["S","mmu.v.html#74","mmu.v.p2.html#1007","","dram.v.html#155","hierarchy-s.p6.html#o_rst_x___m_mmu"],
["S","mmu.v.html#75","mmu.v.html#718","","mmu.v.html#718","hierarchy-s.p9.html#w_uart_data___m_mmu"],
["S","mmu.v.html#76","mmu.v.html#719","","mmu.v.html#719","hierarchy-s.p9.html#w_uart_we___m_mmu"],
["S","mmu.v.html#77","mmu.v.p2.html#1015","","mmu.v.p2.html#1015","hierarchy-s.p9.html#w_led___m_mmu"],
["S","mmu.v.html#78","","main.v.html#387","rvcorem.v.html#176","hierarchy-s.p9.html#w_init_stage___m_mmu"],
["S","mmu.v.html#79","mmu.v.html#750","","mmu.v.html#750","hierarchy-s.p9.html#w_checksum___m_mmu"],
["S","mmu.v.html#81","mmu.v.html#819","","mmu.v.html#819","hierarchy-s.p9.html#w_verify_checksum___m_mmu"],
["S","mmu.v.html#83","","main.v.html#392","main.v.html#29","hierarchy-s.p9.html#w_debug_btnd___m_mmu"],
["S","mmu.v.html#84","mmu.v.html#798","","mmu.v.html#798","hierarchy-s.p9.html#w_init_state___m_mmu"],
["S","mmu.v.html#85","mmu.v.html#725","","loader.v.html#42","hierarchy-s.p9.html#w_pl_init_we___m_mmu"],
["S","mmu.v.html#89","mmu.v.html#265","","mmu.v.html#265","hierarchy-s.p7.html#physical_addr___m_mmu"],
["S","mmu.v.html#90","mmu.v.html#266","","mmu.v.html#266","hierarchy-s.p7.html#page_walk_fail___m_mmu"],
["S","mmu.v.html#93","mmu.v.html#235","","mmu.v.html#235","hierarchy-s.p7.html#r_pw_state___m_mmu"],
["S","mmu.v.html#96","mmu.v.html#251","","mmu.v.html#251","hierarchy-s.p5.html#L1_pte___m_mmu"],
["S","mmu.v.html#97","mmu.v.html#259","","mmu.v.html#259","hierarchy-s.p5.html#L0_pte___m_mmu"],
["S","mmu.v.html#101","mmu.v.html#668","","mmu.v.html#668","hierarchy-s.p7.html#r_dev___m_mmu"],
["S","mmu.v.html#102","mmu.v.html#669","","mmu.v.html#669","hierarchy-s.p7.html#r_virt___m_mmu"],
["S","mmu.v.html#105","mmu.v.html#689","","mmu.v.html#689","hierarchy-s.p7.html#r_tohost___m_mmu"],
["S","mmu.v.html#108","mmu.v.html#700","","mmu.v.html#700","hierarchy-s.p7.html#plic_served_irq___m_mmu"],
["S","mmu.v.html#109","mmu.v.html#704","","mmu.v.html#704","hierarchy-s.p7.html#plic_pending_irq___m_mmu"],
["S","mmu.v.html#110","mmu.v.html#699","","mmu.v.html#699","hierarchy-s.p7.html#r_plic_odata___m_mmu"],
["S","mmu.v.html#113","mmu.v.html#708","","mmu.v.html#708","hierarchy-s.p7.html#r_clint_odata___m_mmu"],
["S","mmu.v.html#116","mmu.v.html#445","","mmu.v.html#445","hierarchy-s.p7.html#r_mc_mode___m_mmu"],
["S","mmu.v.html#117","mmu.v.html#483","","mmu.v.html#483","hierarchy-s.p7.html#r_mc_qnum___m_mmu"],
["S","mmu.v.html#118","mmu.v.html#484","","mmu.v.html#484","hierarchy-s.p7.html#r_mc_qsel___m_mmu"],
["S","mmu.v.html#120","mmu.v.html#446","","mmu.v.html#446","hierarchy-s.p7.html#r_mc_done___m_mmu"],
["S","mmu.v.html#123","mmu.v.html#453","","mmu.v.html#453","hierarchy-s.p7.html#r_consf_head___m_mmu"],
["S","mmu.v.html#124","mmu.v.html#473","","mmu.v.html#473","hierarchy-s.p7.html#r_consf_tail___m_mmu"],
["S","mmu.v.html#125","mmu.v.html#454","","mmu.v.html#454","hierarchy-s.p7.html#r_consf_cnts___m_mmu"],
["S","mmu.v.html#126","mmu.v.html#452","","mmu.v.html#452","hierarchy-s.p7.html#r_consf_en___m_mmu"],
["S","mmu.v.html#127","mmu.v.html#472","","mmu.v.html#472","hierarchy-s.p2.html#cons_fifo___m_mmu"],
["S","mmu.v.html#162","mmu.v.html#963","","memory.v.html#103","hierarchy-s.p9.html#w_dram_odata___m_mmu"],
["S","mmu.v.html#164","mmu.v.html#643","","mmu.v.html#643","hierarchy-s.p9.html#w_tlb_busy___m_mmu"],
["S","mmu.v.html#165","mmu.v.html#964","","memory.v.html#111","hierarchy-s.p9.html#w_dram_busy___m_mmu"],
["S","mmu.v.html#167","mmu.v.html#585","","microc.v.html#150","hierarchy-s.p9.html#w_mc_addr___m_mmu"],
["S","mmu.v.html#168","mmu.v.html#585","","microc.v.html#151","hierarchy-s.p9.html#w_mc_wdata___m_mmu"],
["S","mmu.v.html#169","mmu.v.html#586","","microc.v.html#203","hierarchy-s.p9.html#w_mc_we___m_mmu"],
["S","mmu.v.html#170","mmu.v.html#586","","microc.v.html#152","hierarchy-s.p9.html#w_mc_ctrl___m_mmu"],
["S","mmu.v.html#171","mmu.v.html#586","","microc.v.html#61","hierarchy-s.p9.html#w_mc_aces___m_mmu"],
["S","mmu.v.html#173","mmu.v.html#173","","mmu.v.html#173","hierarchy-s.p9.html#w_mem_wdata___m_mmu"],
["S","mmu.v.html#174","mmu.v.html#174","","mmu.v.html#174","hierarchy-s.p9.html#w_mem_we___m_mmu"],
["S","mmu.v.html#178","mmu.v.html#178","","mmu.v.html#178","hierarchy-s.p9.html#w_iscode___m_mmu"],
["S","mmu.v.html#179","mmu.v.html#179","","mmu.v.html#179","hierarchy-s.p9.html#w_isread___m_mmu"],
["S","mmu.v.html#180","mmu.v.html#180","","mmu.v.html#180","hierarchy-s.p9.html#w_iswrite___m_mmu"],
["S","mmu.v.html#181","mmu.v.html#181","","mmu.v.html#181","hierarchy-s.p9.html#v_addr___m_mmu"],
["S","mmu.v.html#184","mmu.v.html#184","","mmu.v.html#184","hierarchy-s.p9.html#vpn1___m_mmu"],
["S","mmu.v.html#185","mmu.v.html#185","","mmu.v.html#185","hierarchy-s.p5.html#L1_pte_addr___m_mmu"],
["S","mmu.v.html#186","mmu.v.html#186","","mmu.v.html#186","hierarchy-s.p5.html#L1_xwr___m_mmu"],
["S","mmu.v.html#187","mmu.v.html#187","","mmu.v.html#187","hierarchy-s.p5.html#L1_paddr___m_mmu"],
["S","mmu.v.html#188","mmu.v.html#188","","mmu.v.html#188","hierarchy-s.p5.html#L1_p_addr___m_mmu"],
["S","mmu.v.html#189","mmu.v.html#189","","mmu.v.html#189","hierarchy-s.p5.html#L1_write___m_mmu"],
["S","mmu.v.html#190","mmu.v.html#190","","mmu.v.html#190","hierarchy-s.p5.html#L1_success___m_mmu"],
["S","mmu.v.html#196","mmu.v.html#196","","mmu.v.html#196","hierarchy-s.p9.html#vpn0___m_mmu"],
["S","mmu.v.html#197","mmu.v.html#197","","mmu.v.html#197","hierarchy-s.p5.html#L0_pte_addr___m_mmu"],
["S","mmu.v.html#198","mmu.v.html#198","","mmu.v.html#198","hierarchy-s.p5.html#L0_xwr___m_mmu"],
["S","mmu.v.html#199","mmu.v.html#199","","mmu.v.html#199","hierarchy-s.p5.html#L0_paddr___m_mmu"],
["S","mmu.v.html#200","mmu.v.html#200","","mmu.v.html#200","hierarchy-s.p5.html#L0_p_addr___m_mmu"],
["S","mmu.v.html#201","mmu.v.html#201","","mmu.v.html#201","hierarchy-s.p5.html#L0_write___m_mmu"],
["S","mmu.v.html#202","mmu.v.html#202","","mmu.v.html#202","hierarchy-s.p5.html#L0_success___m_mmu"],
["S","mmu.v.html#208","mmu.v.html#208","","mmu.v.html#208","hierarchy-s.p5.html#L1_pte_write___m_mmu"],
["S","mmu.v.html#209","mmu.v.html#209","","mmu.v.html#209","hierarchy-s.p5.html#L0_pte_write___m_mmu"],
["S","mmu.v.html#210","mmu.v.html#210","","mmu.v.html#210","hierarchy-s.p9.html#w_pte_we___m_mmu"],
["S","mmu.v.html#212","mmu.v.html#212","","mmu.v.html#212","hierarchy-s.p9.html#w_pte_waddr___m_mmu"],
["S","mmu.v.html#213","mmu.v.html#213","","mmu.v.html#213","hierarchy-s.p9.html#w_pte_wdata___m_mmu"],
["S","mmu.v.html#218","mmu.v.html#240","","mmu.v.html#240","hierarchy-s.p7.html#r_tlb_addr___m_mmu"],
["S","mmu.v.html#219","mmu.v.html#245","","mmu.v.html#245","hierarchy-s.p7.html#r_tlb_use___m_mmu"],
["S","mmu.v.html#220","mmu.v.html#303","","mmu.v.p2.html#1047","hierarchy-s.p9.html#w_tlb_inst_r_addr___m_mmu"],
["S","mmu.v.html#220","mmu.v.html#307","","mmu.v.p2.html#1047","hierarchy-s.p9.html#w_tlb_data_r_addr___m_mmu"],
["S","mmu.v.html#220","mmu.v.html#311","","mmu.v.p2.html#1047","hierarchy-s.p9.html#w_tlb_data_w_addr___m_mmu"],
["S","mmu.v.html#221","mmu.v.html#303","","mmu.v.p2.html#1048","hierarchy-s.p9.html#w_tlb_inst_r_oe___m_mmu"],
["S","mmu.v.html#221","mmu.v.html#307","","mmu.v.p2.html#1048","hierarchy-s.p9.html#w_tlb_data_r_oe___m_mmu"],
["S","mmu.v.html#221","mmu.v.html#311","","mmu.v.p2.html#1048","hierarchy-s.p9.html#w_tlb_data_w_oe___m_mmu"],
["S","mmu.v.html#222","mmu.v.html#222","","mmu.v.html#222","hierarchy-s.p9.html#w_use_tlb___m_mmu"],
["S","mmu.v.html#224","mmu.v.html#224","","mmu.v.html#224","hierarchy-s.p9.html#w_tlb_hit___m_mmu"],
["S","mmu.v.html#296","mmu.v.html#296","","mmu.v.html#296","hierarchy-s.p9.html#w_tlb_inst_r_we___m_mmu"],
["S","mmu.v.html#297","mmu.v.html#297","","mmu.v.html#297","hierarchy-s.p9.html#w_tlb_data_r_we___m_mmu"],
["S","mmu.v.html#298","mmu.v.html#298","","mmu.v.html#298","hierarchy-s.p9.html#w_tlb_data_w_we___m_mmu"],
["S","mmu.v.html#299","mmu.v.html#299","","mmu.v.html#299","hierarchy-s.p9.html#w_tlb_wdata___m_mmu"],
["S","mmu.v.html#314","mmu.v.html#318","","mmu.v.html#318","hierarchy-s.p7.html#r_tlb_pte_addr___m_mmu"],
["S","mmu.v.html#315","mmu.v.html#318","","mmu.v.html#318","hierarchy-s.p7.html#r_tlb_acs___m_mmu"],
["S","mmu.v.html#332","mmu.v.html#332","","mmu.v.html#332","hierarchy-s.p9.html#w_insn_paddr___m_mmu"],
["S","mmu.v.html#335","mmu.v.html#335","","mmu.v.html#335","hierarchy-s.p9.html#w_mem_paddr___m_mmu"],
["S","mmu.v.html#341","mmu.v.html#341","","mmu.v.html#341","hierarchy-s.p9.html#w_mem_ctrl___m_mmu"],
["S","mmu.v.html#349","mmu.v.html#349","","mmu.v.html#349","hierarchy-s.p9.html#w_dev___m_mmu"],
["S","mmu.v.html#350","mmu.v.html#350","","mmu.v.html#350","hierarchy-s.p9.html#w_virt___m_mmu"],
["S","mmu.v.html#351","mmu.v.html#351","","mmu.v.html#351","hierarchy-s.p9.html#w_offset___m_mmu"],
["S","mmu.v.html#355","mmu.v.html#355","","mmu.v.html#355","hierarchy-s.p9.html#w_dram_wdata___m_mmu"],
["S","mmu.v.html#356","mmu.v.html#356","","mmu.v.html#356","hierarchy-s.p9.html#w_dram_we___m_mmu"],
["S","mmu.v.html#359","mmu.v.html#359","","mmu.v.html#359","hierarchy-s.p9.html#w_dram_addr___m_mmu"],
["S","mmu.v.html#364","mmu.v.html#364","","mmu.v.html#364","hierarchy-s.p9.html#w_dram_ctrl___m_mmu"],
["S","mmu.v.html#368","mmu.v.html#368","","mmu.v.html#368","hierarchy-s.p9.html#w_dram_aces___m_mmu"],
["S","mmu.v.html#372","mmu.v.html#824","","mmu.v.html#824","hierarchy-s.p7.html#r_set_dram_le___m_mmu"],
["S","mmu.v.html#375","mmu.v.html#375","","mmu.v.html#375","hierarchy-s.p9.html#w_dram_le___m_mmu"],
["S","mmu.v.html#388","mmu.v.html#388","","mmu.v.html#388","hierarchy-s.p9.html#w_cons_we___m_mmu"],
["S","mmu.v.html#390","mmu.v.html#589","","console.v.html#50","hierarchy-s.p9.html#w_cons_data___m_mmu"],
["S","mmu.v.html#391","mmu.v.html#391","","mmu.v.html#391","hierarchy-s.p9.html#w_cons_addr___m_mmu"],
["S","mmu.v.html#392","mmu.v.html#590","","console.v.html#59","hierarchy-s.p9.html#w_cons_req___m_mmu"],
["S","mmu.v.html#393","mmu.v.html#590","","console.v.html#60","hierarchy-s.p9.html#w_cons_qnum___m_mmu"],
["S","mmu.v.html#394","mmu.v.html#590","","console.v.html#61","hierarchy-s.p9.html#w_cons_qsel___m_mmu"],
["S","mmu.v.html#397","mmu.v.html#397","","mmu.v.html#397","hierarchy-s.p9.html#w_disk_we___m_mmu"],
["S","mmu.v.html#399","mmu.v.html#592","","disk.v.html#49","hierarchy-s.p9.html#w_disk_data___m_mmu"],
["S","mmu.v.html#400","mmu.v.html#400","","mmu.v.html#400","hierarchy-s.p9.html#w_disk_addr___m_mmu"],
["S","mmu.v.html#401","mmu.v.html#593","","disk.v.html#58","hierarchy-s.p9.html#w_disk_req___m_mmu"],
["S","mmu.v.html#402","mmu.v.html#593","","disk.v.html#59","hierarchy-s.p9.html#w_disk_qnum___m_mmu"],
["S","mmu.v.html#403","mmu.v.html#593","","disk.v.html#60","hierarchy-s.p9.html#w_disk_qsel___m_mmu"],
["S","mmu.v.html#408","mmu.v.html#408","","mmu.v.html#408","hierarchy-s.p9.html#w_imag_we___m_mmu"],
["S","mmu.v.html#411","mmu.v.html#414","","mmu.v.html#414","hierarchy-s.p7.html#r_data_data___m_mmu"],
["S","mmu.v.html#427","mmu.v.html#726","","loader.v.html#37","hierarchy-s.p9.html#w_key_we___m_mmu"],
["S","mmu.v.html#428","mmu.v.html#726","","loader.v.html#38","hierarchy-s.p9.html#w_key_data___m_mmu"],
["S","mmu.v.html#429","mmu.v.html#429","","mmu.v.html#429","hierarchy-s.p9.html#w_key_req___m_mmu"],
["S","mmu.v.html#431","mmu.v.html#434","","mmu.v.html#434","hierarchy-s.p7.html#r_key_we___m_mmu"],
["S","mmu.v.html#432","mmu.v.html#435","","mmu.v.html#435","hierarchy-s.p7.html#r_key_data___m_mmu"],
["S","mmu.v.html#540","mmu.v.html#543","","mmu.v.html#543","hierarchy-s.p6.html#old_w_mtime___m_mmu"],
["S","mmu.v.html#553","mmu.v.html#558","","mmu.v.html#558","hierarchy-s.p7.html#r_mc_arg___m_mmu"],
["S","mmu.v.html#570","mmu.v.html#570","","mmu.v.html#570","hierarchy-s.p9.html#w_mc_arg___m_mmu"],
["S","mmu.v.html#579","mmu.v.html#590","","console.v.html#57","hierarchy-s.p9.html#w_cons_irq___m_mmu"],
["S","mmu.v.html#579","mmu.v.html#593","","disk.v.html#56","hierarchy-s.p9.html#w_disk_irq___m_mmu"],
["S","mmu.v.html#580","mmu.v.html#590","","console.v.html#51","hierarchy-s.p9.html#w_cons_irq_oe___m_mmu"],
["S","mmu.v.html#580","mmu.v.html#593","","disk.v.html#50","hierarchy-s.p9.html#w_disk_irq_oe___m_mmu"],
["S","mmu.v.html#581","mmu.v.html#581","","mmu.v.html#581","hierarchy-s.p9.html#w_isdisk___m_mmu"],
["S","mmu.v.html#582","mmu.v.html#582","","mmu.v.html#582","hierarchy-s.p9.html#w_virt_irq___m_mmu"],
["S","mmu.v.html#583","mmu.v.html#583","","mmu.v.html#583","hierarchy-s.p9.html#w_virt_irq_oe___m_mmu"],
["S","mmu.v.html#597","mmu.v.html#597","","mmu.v.html#597","hierarchy-s.p9.html#w_plic_pending_irq_nxt___m_mmu"],
["S","mmu.v.html#598","mmu.v.html#598","","mmu.v.html#598","hierarchy-s.p9.html#w_plic_mask___m_mmu"],
["S","mmu.v.html#599","mmu.v.html#599","","mmu.v.html#599","hierarchy-s.p9.html#w_plic_served_irq_nxt___m_mmu"],
["S","mmu.v.html#603","mmu.v.html#603","","mmu.v.html#603","hierarchy-s.p9.html#w_plic_aces___m_mmu"],
["S","mmu.v.html#606","","","","hierarchy-s.p7.html#r_wmip___m_mmu"],
["S","mmu.v.html#607","","","","hierarchy-s.p7.html#r_plic_we___m_mmu"],
["S","mmu.v.html#609","mmu.v.html#622","","mmu.v.html#622","hierarchy-s.p7.html#r_plic_pending_irq_t___m_mmu"],
["S","mmu.v.html#610","mmu.v.html#623","","mmu.v.html#623","hierarchy-s.p7.html#r_plic_served_irq_t___m_mmu"],
["S","mmu.v.html#612","mmu.v.html#620","","mmu.v.html#620","hierarchy-s.p7.html#r_virt_irq_oe_t___m_mmu"],
["S","mmu.v.html#613","mmu.v.html#621","","mmu.v.html#621","hierarchy-s.p7.html#r_plic_aces_t___m_mmu"],
["S","mmu.v.html#615","mmu.v.html#615","","mmu.v.html#615","hierarchy-s.p9.html#w_plic_mask_nxt___m_mmu"],
["S","mmu.v.html#653","mmu.v.html#653","","mmu.v.html#653","hierarchy-s.p9.html#w_mc_busy___m_mmu"],
["S","mmu.v.html#656","mmu.v.html#716","","loader.v.html#70","hierarchy-s.p9.html#w_tx_ready___m_mmu"],
["S","mmu.v.html#660","mmu.v.html#674","","mmu.v.html#674","hierarchy-s.p7.html#r_uart_we___m_mmu"],
["S","mmu.v.html#661","mmu.v.html#675","","mmu.v.html#675","hierarchy-s.p7.html#r_uart_data___m_mmu"],
["S","mmu.v.html#664","mmu.v.html#880","","mmu.v.html#880","hierarchy-s.p7.html#r_rb_uart_we___m_mmu"],
["S","mmu.v.html#665","mmu.v.html#876","","mmu.v.html#876","hierarchy-s.p7.html#r_rb_uart_data___m_mmu"],
["S","mmu.v.html#715","mmu.v.html#716","","loader.v.html#69","hierarchy-s.p9.html#w_cons_txd___m_mmu"],
["S","mmu.v.html#721","mmu.v.html#725","","loader.v.html#42","hierarchy-s.p9.html#w_pl_init_addr___m_mmu"],
["S","mmu.v.html#722","mmu.v.html#725","","loader.v.html#42","hierarchy-s.p9.html#w_pl_init_data___m_mmu"],
["S","mmu.v.html#724","mmu.v.html#726","","loader.v.html#42","hierarchy-s.p9.html#w_pl_init_done___m_mmu"],
["S","mmu.v.html#732","mmu.v.html#782","","mmu.v.html#782","hierarchy-s.p7.html#r_init_state___m_mmu"],
["S","mmu.v.html#734","mmu.v.html#805","","mmu.v.html#805","hierarchy-s.p7.html#r_initaddr___m_mmu"],
["S","mmu.v.html#735","mmu.v.html#744","","mmu.v.html#744","hierarchy-s.p7.html#r_checksum___m_mmu"],
["S","mmu.v.html#754","mmu.v.html#756","","debug.v.html#63","hierarchy-s.p9.html#w_debug_txd___m_mmu"],
["S","mmu.v.html#755","mmu.v.html#756","","debug.v.html#141","hierarchy-s.p9.html#w_rec_done___m_mmu"],
["S","mmu.v.html#761","mmu.v.html#806","","mmu.v.html#806","hierarchy-s.p7.html#r_bbl_done___m_mmu"],
["S","mmu.v.html#762","mmu.v.html#810","","mmu.v.html#810","hierarchy-s.p7.html#r_disk_done___m_mmu"],
["S","mmu.v.html#763","mmu.v.html#808","","mmu.v.html#808","hierarchy-s.p7.html#r_dtree_done___m_mmu"],
["S","mmu.v.html#765","mmu.v.html#868","","mmu.v.html#868","hierarchy-s.p7.html#r_initaddr6___m_mmu"],
["S","mmu.v.html#767","mmu.v.html#809","","mmu.v.html#809","hierarchy-s.p7.html#r_initaddr2___m_mmu"],
["S","mmu.v.html#768","mmu.v.html#807","","mmu.v.html#807","hierarchy-s.p7.html#r_initaddr3___m_mmu"],
["S","mmu.v.html#771","mmu.v.html#922","","mmu.v.html#922","hierarchy-s.p9.html#w_zero_we___m_mmu"],
["S","mmu.v.html#772","mmu.v.html#904","","mmu.v.html#904","hierarchy-s.p7.html#r_zero_we___m_mmu"],
["S","mmu.v.html#773","mmu.v.html#912","","mmu.v.html#912","hierarchy-s.p7.html#r_zero_done___m_mmu"],
["S","mmu.v.html#774","mmu.v.html#910","","mmu.v.html#910","hierarchy-s.p7.html#r_zeroaddr___m_mmu"],
["S","mmu.v.html#778","mmu.v.html#837","","mmu.v.html#837","hierarchy-s.p7.html#r_mem_rb_done___m_mmu"],
["S","mmu.v.html#815","mmu.v.html#856","","mmu.v.html#856","hierarchy-s.p7.html#r_rb_delay___m_mmu"],
["S","mmu.v.html#817","mmu.v.html#823","","mmu.v.html#823","hierarchy-s.p7.html#r_rb_state___m_mmu"],
["S","mmu.v.html#817","mmu.v.html#860","","mmu.v.html#860","hierarchy-s.p7.html#r_rb_cnt___m_mmu"],
["S","mmu.v.html#818","mmu.v.html#850","","mmu.v.html#850","hierarchy-s.p7.html#r_rb_data___m_mmu"],
["S","mmu.v.html#818","mmu.v.html#849","","mmu.v.html#849","hierarchy-s.p7.html#r_verify_checksum___m_mmu"],
["S","mmu.v.html#820","mmu.v.html#820","","mmu.v.html#820","hierarchy-s.p9.html#w_checksum_match___m_mmu"],
["S","mmu.v.html#897","mmu.v.p2.html#1009","","dram.v.html#167","hierarchy-s.p2.html#calib_done___m_mmu"],
["S","mmu.v.html#926","mmu.v.html#926","","mmu.v.html#926","hierarchy-s.p9.html#w_dram_addr_t___m_mmu"],
["S","mmu.v.html#929","mmu.v.html#929","","mmu.v.html#929","hierarchy-s.p9.html#w_dram_addr_t2___m_mmu"],
["S","mmu.v.html#938","mmu.v.html#938","","mmu.v.html#938","hierarchy-s.p9.html#w_dram_wdata_t___m_mmu"],
["S","mmu.v.html#940","mmu.v.html#940","","mmu.v.html#940","hierarchy-s.p9.html#w_dram_we_t___m_mmu"],
["S","mmu.v.html#941","mmu.v.html#941","","mmu.v.html#941","hierarchy-s.p9.html#w_dram_ctrl_t___m_mmu"],
["S","mmu.v.html#945","mmu.v.html#945","","mmu.v.html#945","hierarchy-s.p9.html#w_wr_en___m_mmu"]
];
disabled=0;
// -->
</script>
<hr>
<table>
 <tr><td><i>This page:</i></td>
  <td><i>Created:</i></td><td><i>Fri Feb 11 15:35:04 2022</i></td></tr>
<tr>
 <td> </td>
 <td><i>From:</i></td><td><i>
src/mmu.v</i></td></tr>
</table>
<hr>
<table width="100%"><tr><td><i>Verilog converted to html by  <a target="_top" href="http://www.burbleland.com/v2html/v2html.html">  v2html 7.30.1.3</a> 
 (written by <a href="mailto:v2html730@burbleland.com">Costas Calamvokis</a>).</i></td><td align="right"><b><a href="http://www.burbleland.com/v2html/help_7_30.html?">Help</a></b></td></tr></table><table height="90%"><tr><td></td></tr></table>
</body>
</html>
